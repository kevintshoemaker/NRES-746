<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Jeremy Adkins" />


<title>Structural Equation Modeling (SEM)</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">NRES 746</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Schedule
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="schedule.html">Course Schedule</a>
    </li>
    <li>
      <a href="Syllabus.pdf">Syllabus</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="INTRO.html">Introduction to NRES 746</a>
    </li>
    <li>
      <a href="LECTURE1.html">Why focus on algorithms?</a>
    </li>
    <li>
      <a href="LECTURE2.html">Working with probabilities</a>
    </li>
    <li>
      <a href="LECTURE3.html">The Virtual Ecologist</a>
    </li>
    <li>
      <a href="LECTURE4.html">Likelihood</a>
    </li>
    <li>
      <a href="LECTURE5.html">Optimization</a>
    </li>
    <li>
      <a href="LECTURE6.html">Bayesian #1: concepts</a>
    </li>
    <li>
      <a href="LECTURE7.html">Bayesian #2: mcmc</a>
    </li>
    <li>
      <a href="LECTURE8.html">Model Selection</a>
    </li>
    <li>
      <a href="LECTURE9.html">Performance Evaluation</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Lab exercises
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="LAB_Instructions.html">Instructions for Labs</a>
    </li>
    <li>
      <a href="FINALPROJ.html">Final project overview</a>
    </li>
    <li>
      <a href="LAB3demo.html">Lab 3: Likelihood (intro)</a>
    </li>
    <li>
      <a href="LAB5.html">Lab 5: Model selection (optional)</a>
    </li>
    <li>
      <a href="FigureDemo.html">Demo: Figures in R</a>
    </li>
    <li>
      <a href="GIT-tutorial.html">Demo: version control in Git</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Student-led topics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="LECTURE10.html">Machine Learning</a>
    </li>
    <li>
      <a href="Occupancy.html">Occupancy Models</a>
    </li>
    <li>
      <a href="TimeSeries_all.html">Time Series</a>
    </li>
    <li>
      <a href="SCR.html">Spatial Capture-Recapture</a>
    </li>
    <li>
      <a href="sppm.html">Spatial Point Process Models</a>
    </li>
    <li>
      <a href="spatial_autocorrelation.html">Spatial Autocorrelation</a>
    </li>
    <li>
      <a href="MEM2.html">Mixed Effects Models</a>
    </li>
    <li>
      <a href="MANOVA.html">MANOVA</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Data sets
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="TreeData.csv">Tree Data</a>
    </li>
    <li>
      <a href="ReedfrogPred.csv">Reed Frog Predation Data</a>
    </li>
    <li>
      <a href="ReedfrogFuncresp.csv">Reed Frog Func Resp</a>
    </li>
  </ul>
</li>
<li>
  <a href="Links.html">Links</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Structural Equation Modeling (SEM)</h1>
<h4 class="author">Jeremy Adkins</h4>

</div>


<p>If you’d like to follow along in R, you can download the code here: <a href="Adkins.SEM.R">SEM R code</a></p>
<div id="what-is-sem" class="section level2">
<h2>What is SEM</h2>
<p>Multivariate technique used to map and analyze complex networks of causal relationships between observed and latent variables. Most frequently used in social sciences.</p>
<div id="why-is-it-useful-for-ecologists" class="section level3">
<h3>Why is it useful for ecologists?</h3>
<ul>
<li>Theory oriented</li>
<li>Causal network hypothesis testing</li>
<li>Testing multiple models</li>
<li>More intuitive interpretation</li>
</ul>
</div>
<div id="example" class="section level3">
<h3>Example</h3>
<p>SEMs are ideal for describing complex systems. Liu et al. 2016 used SEMs to model the relationship between growth rates, functional traits, environmental factors, and neighborhood competition effects in a subtropical forest. They hypothesized that the abiotic and biotic environment indirectly affect tree growth via their effect on plant traits. They defined latent variables based on observed data. For example, the environmental latent variable included six soil nutrients and pH. The functional trait latent variable included tree height (Height), specific leaf area (SLA), hydraulic conductivity (Ks), and stomatal density (SD). They kept conspecific basal area (BA-c) separate from the trait latent construct. By combining many observed variables into thoughtful latent variables, they could create models that make more intuitive sense. They found that there were strong positive relationships between functional traits and growth rates. The environmental latent variable had a weaker but still significant relationship with growth rate. Below is a path analysis diagram illustrating the SEM.</p>
<div class="figure">
<img src="Liu2016SEM.png" alt="" />
<p class="caption">(Liu 2016)</p>
</div>
<hr />
</div>
<div id="definitions" class="section level3">
<h3>Definitions</h3>
<ul>
<li>Observed variable - Exists in data</li>
<li>Latent variable - Constructed in model</li>
<li>Exogenous - Independent that explains endogenous (observed or latent) (predictor)</li>
<li>Endogenous - Dependent that has a causal path leading to it (observed or latent) (response)</li>
<li>Measurement model - Links observed and latent variables
<ul>
<li>Indicator - Observed (exogenous or endogenous)</li>
<li>Factor - Latent (exogenous or endogenous)</li>
<li>Loading - Path between indicator and factor</li>
</ul></li>
<li>Structural model - specifies causal relationships between exogenous and endogenous variables</li>
<li>Regression model - Path between exogenous and endogenous variables</li>
</ul>
<hr />
</div>
</div>
<div id="types-of-structural-equation-models" class="section level2">
<h2>Types of Structural Equation Models</h2>
<p><br></p>
<p><img src="SEM%20Models.png" /></p>
<p><br> <br></p>
<div id="path-diagram-symbols" class="section level3">
<h3>Path Diagram Symbols</h3>
<p><br></p>
<p><img src="Path.Diagram.Key.png" /></p>
<p><br> <br></p>
</div>
<div id="path-diagram" class="section level3">
<h3>Path Diagram</h3>
<p>Path diagrams can be used to better visualize the matrix equations in SEMs. The figure below illustrates the many types of variables and relationships that SEM can encompass.</p>
<p><br></p>
<div class="figure">
<img src="UCLA.Path.Diagram.png" alt="" />
<p class="caption">image credit: Johnny Lin 2021</p>
</div>
<p><br> <br></p>
</div>
<div id="sems-with-one-endogenous-variable" class="section level3">
<h3>SEMs with one endogenous variable</h3>
<p>Simple regression and multiple regression both involve one endogenous variable. In simple linear regression, there is one exogenous variable that predicts one endogenous variable. In multiple regressions, multiple exogenous variables (with covariance) predict a single endogenous variable. The exogenous variables each have variance. The endogenous variable has an intercept (the triangle) and residual variance.</p>
<p><br></p>
<p><img src="SEMs1endogenous.png" /> <br></p>
<div class="figure">
<img src="Simple%20and%20Multiple%20Regression.png" alt="" />
<p class="caption">image credit: Johnny Lin 2021</p>
</div>
<p><br> <br></p>
</div>
<div id="two-or-more-endogenous-variables" class="section level3">
<h3>Two or more endogenous variables</h3>
<div id="observed" class="section level4">
<h4>Observed</h4>
<p>Multivariate regression and path analysis both have two or more observed endogenous variables. The main difference is that multivariate regression has only exogenous variables predicting endogenous variables. However, in path analysis, endogenous variables can also predict other endogenous variables. <br></p>
<p><img src="SEMs%202%20observed.png" /></p>
<p><br></p>
<div class="figure">
<img src="MultRegresAndPathAn.png" alt="" />
<p class="caption">image credit: Johnny Lin 2021</p>
</div>
<p><br> <br></p>
</div>
<div id="latent" class="section level4">
<h4>Latent</h4>
<p>Factor analysis and structural regression both have two or more endogenous variables. The main difference is that factor analysis looks at how a latent variable can predict observed variables. Structural regression can use latent variables to predict other latent variables.</p>
<p><br></p>
<p><img src="SEMs%202%20latent.png" /></p>
<p><br></p>
<div class="figure">
<img src="FacAnAndStrReg.png" alt="" />
<p class="caption">image credit: Johnny Lin 2021</p>
</div>
<hr />
</div>
</div>
<div id="steps-of-an-sem" class="section level3">
<h3>Steps of an SEM</h3>
<ol style="list-style-type: decimal">
<li>Model Specification – defines hypothetical relationships</li>
<li>Model Identification
<ul>
<li>Over identified – more knowns than free parameters</li>
<li>Just-identified – the number of unknowns equals the number of free parameters</li>
<li>Under-identified – the number of unknowns is greater than the number of parameters (model coefficients cannot be estimated)</li>
</ul></li>
<li>Parameter Estimation – comparing actual and estimated covariance (i.e., maximum likelihood estimate)</li>
<li>Model Evaluation- goodness of fit (i.e., Chi-square, Akaike Information Criterion (AIC), Comparative Fit Index (CFI))</li>
<li>Model Modification – post hoc model modification</li>
</ol>
<hr />
</div>
</div>
<div id="examples" class="section level2">
<h2>Examples</h2>
<div id="data" class="section level3">
<h3>Data</h3>
<p>These examples and data are from an introductory SEM seminar by the Institute for Digital Research and Education Statistical Consulting. The data set is from the social sciences. However, the same steps and concepts could apply to ecological research. The data has six observed variables ascribed to 3 hypothetical latent variables describing the effects of student background on academic achievement. Nine observed variables are clustered into hypothetical latent constructs based on prior knowledge or theory. In this example, the three hypothesized latent constructs are adjustment, risk, and achievement. Adjustment is defined by the observed variables motivation, harmony, and stability. Similarly, risk is defined by negative parental psychology, socioeconomic status, and verbal IQ. Finally, achievement is composed of reading, arithmetic, and spelling. Variable abbreviations are:</p>
<ul>
<li>Motivation = motiv</li>
<li>Harmony = harm</li>
<li>Stability = stabi</li>
<li>Negative parental psychology = ppsych</li>
<li>Socioeconomic status = ses</li>
<li>Verbal IQ = verbal</li>
<li>Reading = read</li>
<li>Arithmetic = arith</li>
<li>Spelling = spell</li>
</ul>
<p>We will be using the lavaan() package. There are SEM programs outside of R that some people prefer, but they are not free to use.</p>
<pre class="r"><code>library(lavaan)</code></pre>
<pre><code>## This is lavaan 0.6-9
## lavaan is FREE software! Please report any bugs.</code></pre>
<pre class="r"><code>dat &lt;- read.csv(&quot;https://stats.idre.ucla.edu/wp-content/uploads/2021/02/worland5.csv&quot;)</code></pre>
</div>
<div id="simple-linear-regression" class="section level3">
<h3>Simple Linear Regression</h3>
<p>For this example, we will perform a simple regression that determines the relationship of two observed variables (one exogenous and one endogenous). This analysis is the first building block in SEM, as an SEM is a linear model framework. This analysis could be done using the lm() function. However, we will use lavaan(). The primary difference is that lavaan() uses maximum likelihood instead of the least square estimator. While the coefficients will be the same, the residual variance will be a little different.</p>
<p><br></p>
<p>Here we will choose to look at how motivation predicts reading. The notation is similar to lm(), but we must add 1 to the predictor side to include the intercept. We may choose to include the variance. For simple regression, it would only be the variance of the predictor.</p>
<p>We can illustrate this analysis using a path diagram such as the one below. <img src="SimRegLabl.png" /></p>
<pre class="r"><code>m1 &lt;-   &#39;
  # regressions
    read ~ 1 + motiv
  # variance (optional)
    motiv ~~ motiv
&#39;</code></pre>
<p>Next, we fit the model to the data using sem() from lavaan. Followed by a summary, including model fit.</p>
<pre class="r"><code>fit1 &lt;- sem(m1, data=dat)
summary(fit1, fit.measures=TRUE)</code></pre>
<pre><code>## lavaan 0.6-9 ended normally after 14 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                         5
##                                                       
##   Number of observations                           500
##                                                       
## Model Test User Model:
##                                                       
##   Test statistic                                 0.000
##   Degrees of freedom                                 0
## 
## Model Test Baseline Model:
## 
##   Test statistic                               164.877
##   Degrees of freedom                                 1
##   P-value                                        0.000
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    1.000
##   Tucker-Lewis Index (TLI)                       1.000
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)              -3638.084
##   Loglikelihood unrestricted model (H1)      -3638.084
##                                                       
##   Akaike (AIC)                                7286.168
##   Bayesian (BIC)                              7307.241
##   Sample-size adjusted Bayesian (BIC)         7291.371
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.000
##   90 Percent confidence interval - lower         0.000
##   90 Percent confidence interval - upper         0.000
##   P-value RMSEA &lt;= 0.05                             NA
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.000
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Expected
##   Information saturated (h1) model          Structured
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   read ~                                              
##     motiv             0.530    0.038   13.975    0.000
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .read             -0.000    0.379   -0.000    1.000
##     motiv             0.000    0.447    0.000    1.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##     motiv            99.800    6.312   15.811    0.000
##    .read             71.766    4.539   15.811    0.000</code></pre>
<p><img src="SimRegLablCoef.png" /></p>
</div>
<div id="path-analysis" class="section level3">
<h3>Path Analysis</h3>
<p>For this example, we will perform a path analysis, which is broader than a multivariate regression and allows endogenous variables to explain other endogenous variables.</p>
<p>First, we will use negative parental psychology and motivation as predictors of reading and arithmetic. We will also include reading as a predictor of arithmetic (an endogenous variable explaining another endogenous variable).</p>
<p>We can illustrate this analysis using a path diagram such as the one below. <img src="PathAnLabl.png" /></p>
<pre class="r"><code>m2 &lt;- &#39;
  # regressions
    read ~ 1 + ppsych + motiv
    arith ~ 1 + motiv + read + ppsych
  # covariance and variance
    read~~read
    ppsych~~ppsych
    motiv~~motiv
    arith~~arith
    motiv ~~ ppsych
    
&#39;</code></pre>
<p>Next, we fit the model to the data using sem() from lavaan. Followed by a summary, including model fit.</p>
<pre class="r"><code>fit2 &lt;- sem(m2, data=dat)
summary(fit2, fit.measures=TRUE)</code></pre>
<pre><code>## lavaan 0.6-9 ended normally after 42 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        14
##                                                       
##   Number of observations                           500
##                                                       
## Model Test User Model:
##                                                       
##   Test statistic                                 0.000
##   Degrees of freedom                                 0
## 
## Model Test Baseline Model:
## 
##   Test statistic                               707.017
##   Degrees of freedom                                 6
##   P-value                                        0.000
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    1.000
##   Tucker-Lewis Index (TLI)                       1.000
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)              -7087.537
##   Loglikelihood unrestricted model (H1)      -7087.537
##                                                       
##   Akaike (AIC)                               14203.074
##   Bayesian (BIC)                             14262.078
##   Sample-size adjusted Bayesian (BIC)        14217.641
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.000
##   90 Percent confidence interval - lower         0.000
##   90 Percent confidence interval - upper         0.000
##   P-value RMSEA &lt;= 0.05                             NA
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.000
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Expected
##   Information saturated (h1) model          Structured
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   read ~                                              
##     ppsych           -0.275    0.037   -7.385    0.000
##     motiv             0.461    0.037   12.404    0.000
##   arith ~                                             
##     motiv             0.300    0.033    8.993    0.000
##     read              0.597    0.035   17.004    0.000
##     ppsych            0.068    0.031    2.212    0.027
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   ppsych ~~                                           
##     motiv           -24.950    4.601   -5.423    0.000
## 
## Intercepts:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .read             -0.000    0.360   -0.000    1.000
##    .arith            -0.000    0.283   -0.000    1.000
##     ppsych           -0.000    0.447   -0.000    1.000
##     motiv             0.000    0.447    0.000    1.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .read             64.708    4.092   15.811    0.000
##     ppsych           99.800    6.312   15.811    0.000
##     motiv            99.800    6.312   15.811    0.000
##    .arith            39.923    2.525   15.811    0.000</code></pre>
<p><img src="PathAnLablCoef.png" /></p>
</div>
<div id="structural-regression" class="section level3">
<h3>Structural Regression</h3>
<p>For the last example, we will create a structural model that relates multiple latent variables. First, we create a measurement model by defining each latent variable. Adjustment will be motivation, harmony, and stability. Risk will be verbal, negative parent psychology, and socioeconomic status. Achievement will be reading, arithmetic, and spelling. Next, we define the regression path. Achievement will be the combination of adjustment and risk.</p>
<p>We can illustrate this analysis using a path diagram such as the one below. <img src="StrRegLabl.png" /></p>
<pre class="r"><code>m3 &lt;- &#39;
# measurement model
adjust =~ motiv + harm + stabi
risk =~ verbal + ppsych + ses
achieve =~ read + arith + spell
# regressions
achieve ~ adjust + risk
&#39;</code></pre>
<p>Next, we fit the model to the data using sem() from lavaan. Followed by a summary, including model fit.</p>
<pre class="r"><code>fit3 &lt;- sem(m3, data=dat)
summary(fit3, fit.measures=TRUE)</code></pre>
<pre><code>## lavaan 0.6-9 ended normally after 130 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of model parameters                        21
##                                                       
##   Number of observations                           500
##                                                       
## Model Test User Model:
##                                                       
##   Test statistic                               148.982
##   Degrees of freedom                                24
##   P-value (Chi-square)                           0.000
## 
## Model Test Baseline Model:
## 
##   Test statistic                              2597.972
##   Degrees of freedom                                36
##   P-value                                        0.000
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    0.951
##   Tucker-Lewis Index (TLI)                       0.927
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)             -15517.857
##   Loglikelihood unrestricted model (H1)     -15443.366
##                                                       
##   Akaike (AIC)                               31077.713
##   Bayesian (BIC)                             31166.220
##   Sample-size adjusted Bayesian (BIC)        31099.565
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.102
##   90 Percent confidence interval - lower         0.087
##   90 Percent confidence interval - upper         0.118
##   P-value RMSEA &lt;= 0.05                          0.000
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.041
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Expected
##   Information saturated (h1) model          Structured
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   adjust =~                                           
##     motiv             1.000                           
##     harm              0.884    0.041   21.774    0.000
##     stabi             0.695    0.043   15.987    0.000
##   risk =~                                             
##     verbal            1.000                           
##     ppsych           -0.770    0.075  -10.223    0.000
##     ses               0.807    0.076   10.607    0.000
##   achieve =~                                          
##     read              1.000                           
##     arith             0.837    0.034   24.437    0.000
##     spell             0.976    0.028   34.338    0.000
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   achieve ~                                           
##     adjust            0.375    0.046    8.085    0.000
##     risk              0.724    0.078    9.253    0.000
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   adjust ~~                                           
##     risk             32.098    4.320    7.431    0.000
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .motiv            12.870    2.852    4.512    0.000
##    .harm             31.805    2.973   10.698    0.000
##    .stabi            57.836    3.990   14.494    0.000
##    .verbal           46.239    4.788    9.658    0.000
##    .ppsych           68.033    5.068   13.425    0.000
##    .ses              64.916    4.975   13.048    0.000
##    .read             11.372    1.608    7.074    0.000
##    .arith            37.818    2.680   14.109    0.000
##    .spell            15.560    1.699    9.160    0.000
##     adjust           86.930    6.830   12.727    0.000
##     risk             53.561    6.757    7.927    0.000
##    .achieve          30.685    3.449    8.896    0.000</code></pre>
<p><img src="StrRegLablCoef.png" /></p>
<p><br></p>
</div>
</div>
<div id="conclusion" class="section level2">
<h2>Conclusion</h2>
<p>Structural equation modeling is an effective form of analysis for ecology as it can describe complex networks of observed and unobserved (latent) variables and their relationships. This was a broad crash course in SEM. If you are interested in learning more about SEMs, I recommend “taking a look under the hood.” While I have given diagrams that illustrate how SEMs work, Lavaan() uses matrices to run these analyses.</p>
</div>
<div id="resources" class="section level2">
<h2>Resources</h2>
<ul>
<li><p>Introduction to structural equation modeling (SEM) in R with Lavaan. UCLA: Statistical Consulting Group. from <a href="https://stats.idre.ucla.edu/r/seminars/rsem/#s2h" class="uri">https://stats.idre.ucla.edu/r/seminars/rsem/#s2h</a></p></li>
<li><p>Liu, X., Swenson, N. G., Lin, D., Mi, X., Umaña, M. N., Schmid, B., &amp; Ma, K. (2016). Linking individual-level functional traits to tree growth in a subtropical forest. Ecology (Durham), 97(9), 2396-2405. <a href="https://doi.org/10.1002/ecy.1445" class="uri">https://doi.org/10.1002/ecy.1445</a></p></li>
<li><p>UCLA Office of Advanced Research Computing. (2021) Introduction to Structural Equation Modeling [video]. YouTube. <a href="https://www.youtube.com/watch?v=sKVFkVoYfbs" class="uri">https://www.youtube.com/watch?v=sKVFkVoYfbs</a></p></li>
</ul>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
