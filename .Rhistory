cat("
model {
for (i in 1:n) {
mean [ i ] <- a*day[ i ]/ (b + day[ i ])
rate [ i ] <- shape/mean[ i ]
titer [ i ] ~ dgamma (shape, rate[ i ])
}
##priors
a ~ dgamma (0.1, 0.1)
b ~ dgamma (0.1, 0.1)
shape ~ dgamma (0.01, 0.01)
}
", fill=TRUE)
sink()
#Run this model through R2WinBUGS.
datalist <- list(
titer=Myx$titer,
day=Myx$day,
n=nrow(Myx)
)
myxo2.bugs = jags(data=datalist, inits=inits, parameters.to.save=c("a", "b", "shape"), model.file= "myxomodel2.txt", n.thin=1, n.chains=3, n.burnin=300, n.iter=3000)
myxo2.bugs
myxo2.mcmc <- mcmc(myxo2.bugs)
plot(myxo2.mcmc)
myxo2.mcmc <- mcmc(myxo2.bugs)
plot(myxo2.mcmc)
densityplot(myxo2.mcmc)
myxo2.bugs = jags(data=datalist, inits=inits, parameters.to.save=c("a", "b", "shape"), model.file= "myxomodel2.txt", n.thin=1, n.chains=3, n.burnin=300, n.iter=3000)
myxo2.bugs
myxo2.mcmc <- as.mcmc(myxo2.bugs)
myxo2.mcmc <- as.mcmc(myxo2.bugs)
summary(myxo2.mcmc)
plot(myxo2.mcmc)
densityplot(myxo2.mcmc)
plot(Myx$titer~Myx$day,xlim=c(0,10),ylim=c(0,10))
curve(mm(x,a=8,b=0.6),from=0,to=10,add=T,col="red")
plot(Myx$titer~Myx$day,xlim=c(0,10),ylim=c(0,10))
curve(mm(x,a=9,b=0.6),from=0,to=10,add=T,col="red")
plot(Myx$titer~Myx$day,xlim=c(0,10),ylim=c(0,10))
curve(mm(x,a=9,b=0.4),from=0,to=10,add=T,col="red")
plot(Myx$titer~Myx$day,xlim=c(0,10),ylim=c(0,10))
curve(mm(x,a=9,b=0.7),from=0,to=10,add=T,col="red")
model {
sink("BUGSmodel.txt")
cat("
model {
#############
# LIKELIHOOD
############
for(obs in 1:n.observations){
titer[obs] ~ dgamma(shape,rate)
}
#############
# PRIORS
############
shape ~ dgamma(0.01,0.01)
scale ~ dgamma(0.001,0.001)
rate <- 1/scale
}
")
sink()
library(emdbook)
MyxDat <- MyxoTiter_sum
Myx <- subset(MyxDat,grade==1)  #Data set from grade 1 of myxo data
head(Myx)
myx.data.for.bugs <- list(
titer = Myx$titer,
n.observations = length(Myx$titer)
)
myx.data.for.bugs
init.vals.for.bugs <- function(){
list(
shape=runif(1,20,100),
scale=runif(1,0.05,0.3)
)
}
init.vals.for.bugs()
init.vals.for.bugs()
inits = list(list(shape=90,scale=0.1), list(shape=50,scale=0.2), list(shape=150,scale=0.04))
params.to.store <- c("shape","scale")    # specify the parameters we want to get the posteriors for
jags.fit <- jags(data=myx.data.for.bugs,inits=init.vals.for.bugs,parameters.to.save=params.to.store,n.iter=50000,model.file="BUGSmodel.txt",n.chains = 3,n.burnin = 5000,n.thin = 20 )
jags.fit
jagsfit.mcmc <- as.mcmc(jags.fit)   # convert to "MCMC" object (coda package)
summary(jagsfit.mcmc)
plot(jagsfit.mcmc)
library(lattice)
densityplot(jagsfit.mcmc)
mm = function(x,a,b) { a*x / (b+x) }
plot(Myx$titer~Myx$day,xlim=c(0,10),ylim=c(0,10))
curve(mm(x,a=9,b=0.7),from=0,to=10,add=T,col="red")
inits = list(list(a=8, b=0.5, shape=90), list(a=10, b=1, shape=100), list(a=7, b=1.2, shape=70))
#Make a model file:
sink("myxomodel2.txt")
cat("
model {
for (i in 1:n) {
mean [ i ] <- a*day[ i ]/ (b + day[ i ])
rate [ i ] <- shape/mean[ i ]
titer [ i ] ~ dgamma (shape, rate[ i ])
}
##priors
a ~ dgamma (0.1, 0.1)
b ~ dgamma (0.1, 0.1)
shape ~ dgamma (0.01, 0.01)
}
", fill=TRUE)
sink()
#Run this model through R2WinBUGS.
datalist <- list(
titer=Myx$titer,
day=Myx$day,
n=nrow(Myx)
)
myxo2.bugs = jags(data=datalist, inits=inits, parameters.to.save=c("a", "b", "shape"), model.file= "myxomodel2.txt", n.thin=1, n.chains=3, n.burnin=300, n.iter=3000)
myxo2.bugs
myxo2.mcmc <- as.mcmc(myxo2.bugs)
summary(myxo2.mcmc)
#plot(myxo2.mcmc)
densityplot(myxo2.mcmc)
plot(Myx$titer~Myx$day,xlim=c(0,10),ylim=c(0,10))
curve(mm(x,a=9,b=0.7),from=0,to=10,add=T,col="red")
inits = list(list(a=8, b=0.5, shape=90), list(a=10, b=1, shape=100), list(a=7, b=1.2, shape=70))
#Make a model file:
sink("myxomodel2.txt")
cat("
model {
for (i in 1:n) {
mean [ i ] <- a*day[ i ]/ (b + day[ i ])
rate [ i ] <- shape/mean[ i ]
titer [ i ] ~ dgamma (shape, rate[ i ])
}
##priors
a ~ dgamma (0.1, 0.1)
b ~ dgamma (0.1, 0.1)
shape ~ dgamma (0.01, 0.01)
}
", fill=TRUE)
sink()
#Run this model through R2WinBUGS.
datalist <- list(
titer=Myx$titer,
day=Myx$day,
n=nrow(Myx)
)
myxo2.bugs = jags(data=datalist, inits=inits, parameters.to.save=c("a", "b", "shape"), model.file= "myxomodel2.txt", n.thin=1, n.chains=3, n.burnin=300, n.iter=3000)
myxo2.bugs
myxo2.mcmc <- as.mcmc(myxo2.bugs)
summary(myxo2.mcmc)
#plot(myxo2.mcmc)
densityplot(myxo2.mcmc)
inits = list(list(a=8, b=0.5, shape=90), list(a=10, b=1, shape=100), list(a=7, b=1.2, shape=70))
#Make a model file:
sink("myxomodel2.txt")
cat("
model {
for (i in 1:n) {
mean [ i ] <- a*day[ i ]/ (b + day[ i ])
rate [ i ] <- shape/mean[ i ]
titer [ i ] ~ dgamma (shape, rate[ i ])
}
##priors
a ~ dgamma (0.1, 0.1)
b ~ dgamma (0.1, 0.1)
shape ~ dgamma (0.01, 0.01)
}
", fill=TRUE)
sink()
#Run this model through R2WinBUGS.
datalist <- list(
titer=Myx$titer,
day=Myx$day,
n=nrow(Myx)
)
myxo2.bugs = jags(data=datalist, inits=inits, parameters.to.save=c("a", "b", "shape"), model.file= "myxomodel2.txt", n.thin=1, n.chains=3, n.burnin=300, n.iter=3000)
myxo2.bugs
myxo2.mcmc <- as.mcmc(myxo2.bugs)
summary(myxo2.mcmc)
#plot(myxo2.mcmc)
densityplot(myxo2.mcmc)
knitr::opts_chunk$set(echo = TRUE, cache = TRUE)
par(mfrow=c(2,1))
curve(dgamma(x, shape=0.01, rate=0.01),3,100,ylim=c(0,0.1),xlab="shape parameter",ylab="probability density", main="Prior")
curve(dgamma(x, shape=0.001, rate=0.001),0.01,0.5,ylim=c(0,1),xlab="scale parameter",ylab="probability density")
library(R2jags)
library(coda)
sink("BUGSmodel.txt")
cat("
model {
#############
# LIKELIHOOD
############
for(obs in 1:n.observations){
titer[obs] ~ dgamma(shape,rate)
}
#############
# PRIORS
############
shape ~ dgamma(0.01,0.01)
scale ~ dgamma(0.001,0.001)
rate <- 1/scale
}
")
sink()
library(emdbook)
MyxDat <- MyxoTiter_sum
Myx <- subset(MyxDat,grade==1)  #Data set from grade 1 of myxo data
head(Myx)
myx.data.for.bugs <- list(
titer = Myx$titer,
n.observations = length(Myx$titer)
)
myx.data.for.bugs
init.vals.for.bugs <- function(){
list(
shape=runif(1,20,100),
scale=runif(1,0.05,0.3)
)
}
init.vals.for.bugs()
init.vals.for.bugs()
inits = list(list(shape=90,scale=0.1), list(shape=50,scale=0.2), list(shape=150,scale=0.04))
params.to.store <- c("shape","scale")    # specify the parameters we want to get the posteriors for
jags.fit <- jags(data=myx.data.for.bugs,inits=init.vals.for.bugs,parameters.to.save=params.to.store,n.iter=50000,model.file="BUGSmodel.txt",n.chains = 3,n.burnin = 5000,n.thin = 20 )
jags.fit
jagsfit.mcmc <- as.mcmc(jags.fit)   # convert to "MCMC" object (coda package)
summary(jagsfit.mcmc)
plot(jagsfit.mcmc)
library(lattice)
densityplot(jagsfit.mcmc)
shape95 = quantile(jags.fit$BUGSoutput$sims.list$shape,c(0.025,0.975))
scale95 = quantile(jags.fit$BUGSoutput$sims.list$scale,c(0.025,0.975))
shape95
scale95
mm = function(x,a,b) { a*x / (b+x) }
plot(Myx$titer~Myx$day,xlim=c(0,10),ylim=c(0,10))
curve(mm(x,a=9,b=0.7),from=0,to=10,add=T,col="red")
inits = list(list(a=8, b=0.5, shape=90), list(a=10, b=1, shape=100), list(a=7, b=1.2, shape=70))
#Make a model file:
sink("myxomodel2.txt")
cat("
model {
for (i in 1:n) {
mean [ i ] <- a*day[ i ]/ (b + day[ i ])
rate [ i ] <- shape/mean[ i ]
titer [ i ] ~ dgamma (shape, rate[ i ])
}
##priors
a ~ dgamma (0.1, 0.1)
b ~ dgamma (0.1, 0.1)
shape ~ dgamma (0.01, 0.01)
}
", fill=TRUE)
sink()
#Run this model through R2WinBUGS.
datalist <- list(
titer=Myx$titer,
day=Myx$day,
n=nrow(Myx)
)
myxo2.bugs = jags(data=datalist, inits=inits, parameters.to.save=c("a", "b", "shape"), model.file= "myxomodel2.txt", n.thin=1, n.chains=3, n.burnin=300, n.iter=3000)
myxo2.bugs
myxo2.mcmc <- as.mcmc(myxo2.bugs)
summary(myxo2.mcmc)
#plot(myxo2.mcmc)
densityplot(myxo2.mcmc)
inits = list(list(a=8, b=0.5, shape=90), list(a=10, b=1, shape=100), list(a=7, b=1.2, shape=70))
sink("myxomodel2.txt")
cat("
model {
for (i in 1:n) {
mean [ i ] <- a*day[ i ]/ (b + day[ i ])
rate [ i ] <- shape/mean[ i ]
titer [ i ] ~ dgamma (shape, rate[ i ])
}
##priors
a ~ dgamma (0.1, 0.1)
b ~ dgamma (0.1, 0.1)
shape ~ dgamma (0.01, 0.01)
}
")
sink()
datalist <- list(
titer=Myx$titer,
day=Myx$day,
n=nrow(Myx)
)
myxo2.bugs = jags(data=datalist, inits=inits, parameters.to.save=c("a", "b", "shape"), model.file= "myxomodel2.txt", n.thin=1, n.chains=3, n.burnin=300, n.iter=3000)
myxo2.bugs
myxo2.bugs = jags(data=datalist, inits=inits, parameters.to.save=c("a", "b", "shape"), model.file= "myxomodel2.txt", n.thin=1, n.chains=3, n.burnin=300, n.iter=3000)
myxo2.bugs
myxo2.mcmc <- as.mcmc(myxo2.bugs)
summary(myxo2.mcmc)
densityplot(myxo2.mcmc)
inits = list(list(a=8, b=0.5, shape=90), list(a=10, b=1, shape=100), list(a=7, b=1.2, shape=70))
#Make a model file:
sink("myxomodel2.txt")
cat("
model {
for (i in 1:n) {
mean [ i ] <- a*day[ i ]/ (b + day[ i ])
rate [ i ] <- shape/mean[ i ]
titer [ i ] ~ dgamma (shape, rate[ i ])
}
##priors
a ~ dgamma (0.1, 0.1)
b ~ dgamma (0.1, 0.1)
shape ~ dgamma (0.01, 0.01)
}
")
sink()
#Run this model through R2WinBUGS.
datalist <- list(
titer=Myx$titer,
day=Myx$day,
n=nrow(Myx)
)
myxo2.bugs = jags(data=datalist, inits=inits, parameters.to.save=c("a", "b", "shape"), model.file= "myxomodel2.txt", n.thin=1, n.chains=3, n.burnin=300, n.iter=3000)
myxo2.bugs
myxo2.mcmc <- as.mcmc(myxo2.bugs)
summary(myxo2.mcmc)
#plot(myxo2.mcmc)
densityplot(myxo2.mcmc)
inits = list(list(a=8, b=0.5, shape=90), list(a=10, b=1, shape=100), list(a=7, b=1.2, shape=70))
#Make a model file:
sink("myxomodel2.txt")
cat("
model {
for (i in 1:n) {
mean [ i ] <- a*day[ i ]/ (b + day[ i ])
rate [ i ] <- shape/mean[ i ]
titer [ i ] ~ dgamma (shape, rate[ i ])
}
##priors
a ~ dgamma (0.1, 0.1)
b ~ dgamma (0.1, 0.1)
shape ~ dgamma (0.01, 0.01)
}
")
sink()
inits = list(list(a=8, b=0.5, shape=90), list(a=10, b=1, shape=100), list(a=7, b=1.2, shape=70))
#Make a model file:
sink("myxomodel2.txt")
cat("
model {
for (i in 1:n) {
mean [ i ] <- a*day[ i ]/ (b + day[ i ])
rate [ i ] <- shape/mean[ i ]
titer [ i ] ~ dgamma (shape, rate[ i ])
}
##priors
a ~ dgamma (0.1, 0.1)
b ~ dgamma (0.1, 0.1)
shape ~ dgamma (0.01, 0.01)
}
")
sink()
datalist <- list(
titer=Myx$titer,
day=Myx$day,
n=nrow(Myx)
)
myxo2.bugs = jags(data=datalist, inits=inits, parameters.to.save=c("a", "b", "shape"), model.file= "myxomodel2.txt", n.thin=1, n.chains=3, n.burnin=300, n.iter=3000)
myxo2.bugs
#Run this model through R2WinBUGS.
myxo2.mcmc <- as.mcmc(myxo2.bugs)
summary(myxo2.mcmc)
#plot(myxo2.mcmc)
densityplot(myxo2.mcmc)
inits <- list(list(a=8, b=0.5, shape=90), list(a=10, b=1, shape=100), list(a=7, b=1.2, shape=70))
#Make a model file:
sink("myxomodel2.txt")
cat("
model {
for (i in 1:n) {
mean [ i ] <- a*day[ i ]/ (b + day[ i ])
rate [ i ] <- shape/mean[ i ]
titer [ i ] ~ dgamma (shape, rate[ i ])
}
##priors
a ~ dgamma (0.1, 0.1)
b ~ dgamma (0.1, 0.1)
shape ~ dgamma (0.01, 0.01)
}
")
sink()
inits <- list(list(a=8, b=0.5, shape=90), list(a=10, b=1, shape=100), list(a=7, b=1.2, shape=70))
#Make a model file:
sink("myxomodel2.txt")
cat("
model {
for (i in 1:n) {
mean [ i ] <- a*day[ i ]/ (b + day[ i ])
rate [ i ] <- shape/mean[ i ]
titer [ i ] ~ dgamma (shape, rate[ i ])
}
##priors
a ~ dgamma (0.1, 0.1)
b ~ dgamma (0.1, 0.1)
shape ~ dgamma (0.01, 0.01)
}
")
sink()
sink()
datalist <- list(
titer=Myx$titer,
day=Myx$day,
n=nrow(Myx)
)
knitr::opts_chunk$set(echo = TRUE, cache = TRUE)
par(mfrow=c(2,1))
curve(dgamma(x, shape=0.01, rate=0.01),3,100,ylim=c(0,0.1),xlab="shape parameter",ylab="probability density", main="Prior")
curve(dgamma(x, shape=0.001, rate=0.001),0.01,0.5,ylim=c(0,1),xlab="scale parameter",ylab="probability density")
library(R2jags)
library(coda)
sink("BUGSmodel.txt")
cat("
model {
#############
# LIKELIHOOD
############
for(obs in 1:n.observations){
titer[obs] ~ dgamma(shape,rate)
}
#############
# PRIORS
############
shape ~ dgamma(0.01,0.01)
scale ~ dgamma(0.001,0.001)
rate <- 1/scale
}
")
sink()
library(emdbook)
MyxDat <- MyxoTiter_sum
Myx <- subset(MyxDat,grade==1)  #Data set from grade 1 of myxo data
head(Myx)
myx.data.for.bugs <- list(
titer = Myx$titer,
n.observations = length(Myx$titer)
)
myx.data.for.bugs
init.vals.for.bugs <- function(){
list(
shape=runif(1,20,100),
scale=runif(1,0.05,0.3)
)
}
init.vals.for.bugs()
init.vals.for.bugs()
inits = list(list(shape=90,scale=0.1), list(shape=50,scale=0.2), list(shape=150,scale=0.04))
params.to.store <- c("shape","scale")    # specify the parameters we want to get the posteriors for
jags.fit <- jags(data=myx.data.for.bugs,inits=init.vals.for.bugs,parameters.to.save=params.to.store,n.iter=50000,model.file="BUGSmodel.txt",n.chains = 3,n.burnin = 5000,n.thin = 20 )
jags.fit
jagsfit.mcmc <- as.mcmc(jags.fit)   # convert to "MCMC" object (coda package)
summary(jagsfit.mcmc)
plot(jagsfit.mcmc)
library(lattice)
densityplot(jagsfit.mcmc)
shape95 = quantile(jags.fit$BUGSoutput$sims.list$shape,c(0.025,0.975))
scale95 = quantile(jags.fit$BUGSoutput$sims.list$scale,c(0.025,0.975))
shape95
scale95
mm = function(x,a,b) { a*x / (b+x) }
plot(Myx$titer~Myx$day,xlim=c(0,10),ylim=c(0,10))
curve(mm(x,a=9,b=0.7),from=0,to=10,add=T,col="red")
inits <- list(list(a=8, b=0.5, shape=90), list(a=10, b=1, shape=100), list(a=7, b=1.2, shape=70))
#Make a model file:
sink("myxomodel2.txt")
cat("
model {
for (i in 1:n) {
mean [ i ] <- a*day[ i ]/ (b + day[ i ])
rate [ i ] <- shape/mean[ i ]
titer [ i ] ~ dgamma (shape, rate[ i ])
}
##priors
a ~ dgamma (0.1, 0.1)
b ~ dgamma (0.1, 0.1)
shape ~ dgamma (0.01, 0.01)
}
")
sink()
datalist <- list(
titer=Myx$titer,
day=Myx$day,
n=nrow(Myx)
)
myxo2.bugs <- jags(data=datalist, inits=inits, parameters.to.save=c("a", "b", "shape"), model.file= "myxomodel2.txt", n.thin=5, n.chains=5, n.burnin=500, n.iter=5000)
library(emdbook)
MyxDat <- MyxoTiter_sum
Myx <- subset(MyxDat,grade==1)  #Data set from grade 1 of myxo data
head(Myx)
inits
inits <- list(list(a=8, b=0.5, shape=90), list(a=10, b=1, shape=100), list(a=7, b=1.2, shape=70))
#Make a model file:
sink("myxomodel2.txt")
cat("
model {
for (i in 1:n) {
mean [ i ] <- a*day[ i ]/ (b + day[ i ])
rate [ i ] <- shape/mean[ i ]
titer [ i ] ~ dgamma (shape, rate[ i ])
}
##priors
a ~ dgamma (0.1, 0.1)
b ~ dgamma (0.1, 0.1)
shape ~ dgamma (0.01, 0.01)
}
")
sink()
?jags
?split
