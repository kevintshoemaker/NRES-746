<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Kirsten Dutcher" />


<title>GraphTheory</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<link rel="stylesheet"
      href="site_libs/highlight/default.css"
      type="text/css" />
<script src="site_libs/highlight/highlight.js"></script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.9em;
  padding-left: 5px;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">NRES 746</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Schedule
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="schedule.html">Course Schedule</a>
    </li>
    <li>
      <a href="labschedule.html">Lab Schedule</a>
    </li>
    <li>
      <a href="Syllabus.pdf">Syllabus</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="INTRO.html">Introduction to NRES 746</a>
    </li>
    <li>
      <a href="LECTURE1.html">Why focus on algorithms?</a>
    </li>
    <li>
      <a href="LECTURE2.html">Working with probabilities</a>
    </li>
    <li>
      <a href="LECTURE3.html">The Virtual Ecologist</a>
    </li>
    <li>
      <a href="LECTURE4.html">Likelihood</a>
    </li>
    <li>
      <a href="LECTURE5.html">Optimization</a>
    </li>
    <li>
      <a href="LECTURE6.html">Bayesian #1: concepts</a>
    </li>
    <li>
      <a href="LECTURE7.html">Bayesian #2: mcmc</a>
    </li>
    <li>
      <a href="LECTURE8.html">Model Selection</a>
    </li>
    <li>
      <a href="LECTURE9.html">Model Performance Evaluation</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Lab exercises
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="LAB1.html">Lab 1: Algorithms in R</a>
    </li>
    <li>
      <a href="LAB2.html">Lab 2: Virtual ecologist</a>
    </li>
    <li>
      <a href="LAB3.html">Lab 3: Likelihood and optimization</a>
    </li>
    <li>
      <a href="LAB4.html">Lab 4: Bayesian inference</a>
    </li>
    <li>
      <a href="LAB5.html">Lab 5: Model selection</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Data sets
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="TreeData.csv">Tree Data</a>
    </li>
    <li>
      <a href="ReedfrogPred.csv">Reed Frog Predation Data</a>
    </li>
    <li>
      <a href="ReedfrogFuncresp.csv">Reed Frog Func Resp</a>
    </li>
    <li>
      <a href="uta_simulated_data.csv">Uta data</a>
    </li>
    <li>
      <a href="tide_ALL_navd_HH.csv">tide data?</a>
    </li>
    <li>
      <a href="TestDataset2.csv">test dataset for SDM?</a>
    </li>
    <li>
      <a href="PRISM_tmean_189511_201610.csv">Reed Frog Func Resp</a>
    </li>
    <li>
      <a href="PRISM_ppt_1895-2015Mo2.csv">Reed Frog Func Resp</a>
    </li>
    <li>
      <a href="final_winter_modeldata2.csv">winter model data</a>
    </li>
    <li>
      <a href="keeley_rawdata.csv">Keeley data</a>
    </li>
    <li>
      <a href="Nest_basic_ALL.csv">nest basic data</a>
    </li>
    <li>
      <a href="Cap_data_for SA.csv">cap data for SA</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Student-led topics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="forWebsite_SEM.html">SEMs</a>
    </li>
    <li>
      <a href="SEM_Minilab_v2.html">SEM mini-lab</a>
    </li>
    <li>
      <a href="GAMs.html">GAMs</a>
    </li>
    <li>
      <a href="RMarkdown_FigureDemo.html">Publication-quality figures in R</a>
    </li>
    <li>
      <a href="Bayesian Networks.pptx">Bayesian Networks</a>
    </li>
    <li>
      <a href="Bayes_Network_Markdown_Final.html">Bayesian Networks mini-lab</a>
    </li>
    <li>
      <a href="GraphTheory.html">Graph Theory</a>
    </li>
    <li>
      <a href="NRES746_IPMs.pptx">Integrated Population Models</a>
    </li>
    <li>
      <a href="TimeSeries_heckler.html">Time Series Analysis</a>
    </li>
    <li>
      <a href="Time_Series_Lab.html">Time-series mini-lab</a>
    </li>
    <li>
      <a href="Spatial_Autocorrelation.html">Spatial Autocorrelation</a>
    </li>
    <li>
      <a href="SA_miniLab.html">Spatial Autocorrelation mini-lab</a>
    </li>
    <li>
      <a href="SDM_pres.html">Species Distribution Modeling</a>
    </li>
    <li>
      <a href="IPM_miniLab.html">IPM mini-lab</a>
    </li>
    <li>
      <a href="Final_MiniLabScript.html">RSF mini-lab</a>
    </li>
    <li>
      <a href="MixedModelMinilab.html">Mixed-effects model mini-lab</a>
    </li>
    <li>
      <a href="Minilab_Ordination.html">Ordination mini-lab</a>
    </li>
  </ul>
</li>
<li>
  <a href="Links.html">Links</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">GraphTheory</h1>
<h4 class="author"><em>Kirsten Dutcher</em></h4>
<h4 class="date"><em>November 2, 2016</em></h4>

</div>


<div id="lecture-notes" class="section level2">
<h2>LECTURE NOTES</h2>
<div id="introduction-to-graph-theory" class="section level4">
<h4>Introduction to Graph Theory</h4>
<p>A GRAPH IS A MATHEMATICAL REPRESENTATION OF A NETWORK. Graph often refers to a mathematical representation of a network, using terms like vertex and edge, while a network often refers to the real system, using terms like node and link. A graph represents A relationship between elements of a set, where a set of nodes is connected pairwise by edges</p>
<p>Nodes=vertices (ex: vertices = {A, B, C, D, E})<br />
Edges=links (ex: edges = {AB}, {AC}, {B,C}, {C,E})</p>
<p>YOU DEFINE THE RELATIONSHIPS TO REPRESENT. Graph theory has been used to represent: transportation networks, social networks, economic networks, protein interaction networks, ecological networks (foodwebs, disease networks, resource use networks, connectivity networks from movement data). In ecology, path analysis and circuit theory use graph theory.</p>
</div>
<div id="why-you-may-want-to-use-a-network" class="section level3">
<h3>WHY YOU MAY WANT TO USE A NETWORK:</h3>
<ol style="list-style-type: decimal">
<li>They provide information on interactions</li>
<li>Once we understand network topology we can think about the consequences of network organization<br />
</li>
<li>We can ask what factors led to network organization.</li>
</ol>
<p>A study by Sah et al. (2016) asked if burrow refugia provide social networks for tortoises (a relatively solitary species)? And if so, what characteristics make up highly popular burrows? Knowing where these are and how tortoises relate to their environment is critical at a point in time when the Mojave is experiencing high levels of habitat loss and fragmentation. Tortoise use of burrows was surveyed. A bipartite network (where nodes of different types were allowed to connect) showed burrow use, popularity, and switching. From there the authors created a social network.They found that reduced burrow switching is associated with juveniles, stress, and poor habitat conditions.Burrow popularity could be identified for critical habitat and terrain and future work could simulate networks to determine how a development that causes the loss of burrow refugia might impact the network and potentially reduce social contacts.</p>
<p>A study by Aiello et al. (2014) examined the potential impacts of translocation and disease transmission. Moving animals from place to place is often done with great care regarding translocatee health and resident pop density. What if there is a diseased individual in the resident pop? How might that disease spread prior to translocation? Following translocation?Make a series of contact networks based on biweekly movement data with residents and translocated individuals. To answer this, they used a control group with no translocation and a resident population with subsequent translocation. Animals were followed via radio-telemetry. The authors randomly selected diseased individuals in the resident populations with varying probabilities of transmission and created contact networks at various time steps. The nearest neighbor networks were based on inferred contact (100 m within 3 days).The disease networks in the control group don’t change too much. However, the simulation predicts high levels of contact and betweenness following translocation. This provides information on interactions, and illustrates that translocation may spread disease in an immunocompromised resident population even if all translocatees are thought to by healthy.</p>
</div>
<div id="background-math" class="section level3">
<h3>BACKGROUND MATH</h3>
<p>The max number of edges in a simple complete graph:</p>
<p><span class="math inline">\(Emax=N(N-1)/2\)</span></p>
<p>Where N=node, E=edge</p>
<p>To find the distance between nodes start at any node (1), find nodes adjacent to 1, mark them as distance x=1, from these find adjacent nodes, mark as x+1, repeat until you find all nodes.</p>
<p>You can build an adjacency matrix based on node distances, actual distances, genetic distances. Simple adjacency matrices are binary and contain data on contact (1) or no contact (0).</p>
<p>In a graph, degree (k) = number of edges connected to a node and betweenness is a measure of the number of paths that pass through a node.</p>
<p>igraph is on CRAN and the igraph package can be found at: <a href="http://igraph.org/r/" class="uri">http://igraph.org/r/</a></p>
<p>You will also need to access a couple other libraries to work through this example</p>
<pre class="r"><code>install.packages(&quot;igraph&quot;)</code></pre>
<pre class="r"><code>library(igraph)</code></pre>
<pre><code>## 
## Attaching package: &#39;igraph&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     decompose, spectrum</code></pre>
<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
##     union</code></pre>
<pre class="r"><code>library(sp)

library(dismo)</code></pre>
<pre><code>## Loading required package: raster</code></pre>
<pre class="r"><code>library(NetIndices)</code></pre>
<pre><code>## Warning: package &#39;NetIndices&#39; was built under R version 3.3.2</code></pre>
<pre><code>## Loading required package: MASS</code></pre>
<pre><code>## 
## Attaching package: &#39;MASS&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:raster&#39;:
## 
##     area, select</code></pre>
</div>
</div>
<div id="lecture-example---ecological-network" class="section level2">
<h2>LECTURE EXAMPLE - ECOLOGICAL NETWORK</h2>
<p>Let’s assume you have movement data from a common lizard species and you want to find out how connected this species is on the landscape. First, read in the .csv found on the UNR course website:</p>
<pre class="r"><code>uta&lt;-read.csv(&quot;uta_simulated_data.csv&quot;)</code></pre>
<p>Let’s look at a summary of individuals by their ID:</p>
<pre class="r"><code>summary(uta$ID)</code></pre>
<pre><code>## U001 U002 U003 U004 U005 U006 U007 U008 U009 U010 U011 U012 U013 U014 U015 
##   68   66   59   67   68   69   64   68   66   45   32   38   22   23   20</code></pre>
<p>Now we are going to break up the day, week, and year column into a new numeric column to identify connections based on temporal overlap:</p>
<pre class="r"><code>uta$Date2 &lt;- as.Date(uta$Date , &quot;%m/%d/%Y&quot;)
uta$Week &lt;- as.numeric(strftime(uta$Date2,format=&quot;%W&quot;))
uta$Year &lt;- as.numeric(strftime(uta$Date2,format=&quot;%Y&quot;))
uta$YW &lt;- paste(uta$Year, uta$Week, sep=&#39;_&#39;)
uta$YW &lt;- factor(uta$YW)</code></pre>
<p>as.Date converts between character representations and objects of the date class. as.numeric creates objects of a numeric. strftime converts between characters and objects of classes representing calendar dates and times. paste concatenates vectors. factor encodes a vector as a factor. %m = abbreviated month, %Y = full year.</p>
<div id="to-remove-lines-of-data-when-the-animal-was-tracked-but-not-located-or-when-utms-eastings-are-missing" class="section level4">
<h4>To remove lines of data when the animal was tracked, but not located, or when UTM’s (eastings) are missing:</h4>
<pre class="r"><code>uta &lt;- subset(uta, Attempted2TrackOnly != &#39;Yes&#39;)
uta &lt;- subset(uta, is.na(Easting) != T)</code></pre>
<p>This is subseting the data for attempted tracking not equal to yes, and na for easting not equal to true. Only lines where attempted to track is not yes and easting is filled in are kept.</p>
</div>
<div id="the-summary-now-shows-the-same-number-of-individuals-but-fewer-observations." class="section level4">
<h4>The summary now shows the same number of individuals, but fewer observations.</h4>
<pre class="r"><code>summary(uta$ID)</code></pre>
<pre><code>## U001 U002 U003 U004 U005 U006 U007 U008 U009 U010 U011 U012 U013 U014 U015 
##   68   62   59   67   67   68   63   68   66   45   25   37   22   23   20</code></pre>
</div>
<div id="now-we-need-to-create-an-empty-matrix-for-each-pairwise-location" class="section level4">
<h4>Now we need to create an empty matrix for each pairwise location:</h4>
<pre class="r"><code>utapairs &lt;-  matrix(data = 0, nrow = length(unique(uta$ID)), ncol = length(unique(uta$ID)), dimnames = list(unique(uta$ID),unique(uta$ID)))</code></pre>
<p>This matrix uses the unique ID once for rows and once for columns in the matrix and is populated with zeros.</p>
</div>
<div id="run-a-for-loop-to-fill-in-the-matrix-which-is-actually-a-loop-within-a-loop-within-a-loop-within-a-loop" class="section level4">
<h4>Run a for loop to fill in the matrix, which is actually a loop within a loop within a loop within a loop:</h4>
<pre class="r"><code>tmp &lt;- uta[1,]
for (i in 1:length(unique(uta$YW))){
  tmp1 &lt;- subset(uta, YW ==  unique(uta$YW)[i])
  tmputa &lt;- factor(unique(tmp1$ID))
  for (l in 1:length(tmputa)){
    tmp[l,] &lt;- tmp1[match(tmputa[l],tmp1$ID),]
  }
  tmpxy &lt;- data.frame(x=tmp$Easting, y=tmp$Northing)
  tmpsp &lt;- SpatialPoints(tmpxy)
  d &lt;- pointDistance(tmpsp,longlat=F)
  for(j in 1:length(tmputa)){
    for(k in 1:length(tmputa)){
      if (j==k){
        utapairs[as.character(tmp$ID[j]),as.character(tmp$ID[k])] &lt;- 0
      } else if (d[j,k] &lt; 101){
        utapairs[as.character(tmp$ID[j]),as.character(tmp$ID[k])] &lt;- utapairs[as.character(tmp$ID[j]),as.character(tmp$ID[k])] + 1
        
      }
    }
  }
}</code></pre>
<p>This for loop, with loops inside loops, is a way to fill in the matrix and associate date (YW) with ID (because ID and YW are repeated), then use the unique ID (now unique ID and unique YW) with UTMs as spatial points, finally ID (unique ID and unique YW) is looped twice to fill in the matrix by rows and columns (instead of row by row or column by column) and populate the matrix by utapairs. The matrix is filled in as 0 if animals were &gt;100 m apart in the same YW, and filled in with 1 if &lt;101 m apart. Since there is more than one observation for each individual ID the for loop will run through the matrix repeatedly, adding nothing if &gt;100 m in the same YW, adding 1 if &lt;101 m.</p>
</div>
<div id="call-utapairs-to-see-the-matrix-created" class="section level4">
<h4>Call utapairs to see the matrix created:</h4>
<pre class="r"><code>utapairs</code></pre>
<pre><code>##      U004 U006 U005 U007 U001 U002 U008 U009 U003 U010 U011 U012 U013 U014
## U004    0    1    0    0    2    0    0    0    0    0    0    0    8    9
## U006    1    0    0    0    0    0    0    0    0    0    0    0    1    0
## U005    0    0    0    0    0    6    0    0    3    3    0    0    0    0
## U007    0    0    0    0    0    0    0    0    0    0    0    0    0    0
## U001    2    0    0    0    0    0    0    0    0    0    0    0    0    1
## U002    0    0    6    0    0    0    0    0   10    0    0    0    0    0
## U008    0    0    0    0    0    0    0    0    0    0    0    0    0    0
## U009    0    0    0    0    0    0    0    0    0    0    0    0    0    0
## U003    0    0    3    0    0   10    0    0    0   10    0    0    0    0
## U010    0    0    3    0    0    0    0    0   10    0    0    0    0    0
## U011    0    0    0    0    0    0    0    0    0    0    0    2    0    0
## U012    0    0    0    0    0    0    0    0    0    0    2    0    1    0
## U013    8    1    0    0    0    0    0    0    0    0    0    1    0    8
## U014    9    0    0    0    1    0    0    0    0    0    0    0    8    0
## U015    0    0    0    0    0    0    0    1    0    0    0    0    0    0
##      U015
## U004    0
## U006    0
## U005    0
## U007    0
## U001    0
## U002    0
## U008    0
## U009    1
## U003    0
## U010    0
## U011    0
## U012    0
## U013    0
## U014    0
## U015    0</code></pre>
<p>Notice that the matrix is not fillid in using distance in meters or number of edges between pairs. Rather it is populated with the number of contacts between pairs.</p>
</div>
<div id="now-we-create-an-object-to-graph-and-call-it-to-see-the-adjacency-object-of-vertices-and-edges." class="section level4">
<h4>Now we create an object to graph and call it to see the adjacency object of vertices and edges.</h4>
<pre class="r"><code>uta_graph &lt;- graph.adjacency(utapairs, weighted=T, mode = &quot;undirected&quot;)
uta_graph</code></pre>
<pre><code>## IGRAPH UNW- 15 15 -- 
## + attr: name (v/c), weight (e/n)
## + edges (vertex names):
##  [1] U004--U006 U004--U001 U004--U013 U004--U014 U006--U013 U005--U002
##  [7] U005--U003 U005--U010 U001--U014 U002--U003 U009--U015 U003--U010
## [13] U011--U012 U012--U013 U013--U014</code></pre>
<p>Weighted means the graph edges are of values other than only 0 and 1. This allows for the production of a weighted graph in the future, where vertices that have weighted edges can be shown as different thicknesses. (For example: if 2 lizards came into contact only once the line would be thin; however, if contact were made 7 times, the line conecting them would be fairly thick). Undirected means the edges connect without arrows. If I wanted to create a directed graph they edges would be directional.</p>
</div>
<div id="examine-the-names-in-uta_graph" class="section level4">
<h4>Examine the names in uta_graph:</h4>
<pre class="r"><code>V(uta_graph)$name</code></pre>
<pre><code>##  [1] &quot;U004&quot; &quot;U006&quot; &quot;U005&quot; &quot;U007&quot; &quot;U001&quot; &quot;U002&quot; &quot;U008&quot; &quot;U009&quot; &quot;U003&quot; &quot;U010&quot;
## [11] &quot;U011&quot; &quot;U012&quot; &quot;U013&quot; &quot;U014&quot; &quot;U015&quot;</code></pre>
</div>
<div id="look-at-all-the-edges-in-the-dataset-and-all-the-vertices" class="section level4">
<h4>Look at all the edges in the dataset and all the vertices:</h4>
<pre class="r"><code>E(uta_graph)</code></pre>
<pre><code>## + 15/15 edges (vertex names):
##  [1] U004--U006 U004--U001 U004--U013 U004--U014 U006--U013 U005--U002
##  [7] U005--U003 U005--U010 U001--U014 U002--U003 U009--U015 U003--U010
## [13] U011--U012 U012--U013 U013--U014</code></pre>
<pre class="r"><code>V(uta_graph)</code></pre>
<pre><code>## + 15/15 vertices, named:
##  [1] U004 U006 U005 U007 U001 U002 U008 U009 U003 U010 U011 U012 U013 U014
## [15] U015</code></pre>
</div>
<div id="you-can-convert-back-to-a-table-to-look-at-your-vertices-and-edges" class="section level4">
<h4>You can convert back to a table to look at your vertices and edges:</h4>
<pre class="r"><code>as_data_frame(uta_graph, what = &quot;vertices&quot;)</code></pre>
<pre><code>##      name
## U004 U004
## U006 U006
## U005 U005
## U007 U007
## U001 U001
## U002 U002
## U008 U008
## U009 U009
## U003 U003
## U010 U010
## U011 U011
## U012 U012
## U013 U013
## U014 U014
## U015 U015</code></pre>
<pre class="r"><code>as_data_frame(uta_graph, what = &quot;edges&quot;)</code></pre>
<pre><code>##    from   to weight
## 1  U004 U006      1
## 2  U004 U001      2
## 3  U004 U013      8
## 4  U004 U014      9
## 5  U006 U013      1
## 6  U005 U002      6
## 7  U005 U003      3
## 8  U005 U010      3
## 9  U001 U014      1
## 10 U002 U003     10
## 11 U009 U015      1
## 12 U003 U010     10
## 13 U011 U012      2
## 14 U012 U013      1
## 15 U013 U014      8</code></pre>
</div>
<div id="you-can-query-the-data-to-see-if-an-edge-exists" class="section level4">
<h4>You can query the data to see if an edge exists:</h4>
<pre class="r"><code>uta_graph[&quot;U004&quot;, &quot;U006&quot;]</code></pre>
<pre><code>## [1] 1</code></pre>
<p>Anything above 1 = yes, an edge (or edges) exists between these.</p>
<pre class="r"><code>uta_graph[&quot;U004&quot;, &quot;U015&quot;]</code></pre>
<pre><code>## [1] 0</code></pre>
<p>0 = no edge connection. This provides a way for you to check your data to see if you have specific connections of interest or not.</p>
</div>
<div id="you-can-also-see-all-adjacent-vertices-of-a-specified-vertex" class="section level4">
<h4>You can also see all adjacent vertices of a specified vertex:</h4>
<pre class="r"><code>uta_graph[[&quot;U004&quot;]]</code></pre>
<pre><code>## $U004
## + 4/15 vertices, named:
## [1] U006 U001 U013 U014</code></pre>
</div>
<div id="now-lets-graph-all-the-individuals-in-the-network" class="section level4">
<h4>Now lets graph all the individuals in the network:</h4>
<pre class="r"><code>plot.igraph(uta_graph)</code></pre>
<p><img src="GraphTheory_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
</div>
<div id="determine-paths-between-two-vertices.-in-this-case-using-distance-will-tell-you-how-many-times-these-2-individuals-came-into-contact-because-the-for-loop-was-built-as-no-contact0-and-contactprevious-contact1-so-a-distance-of-5-is-not-a-measure-of-actual-distance-but-number-of-contacts-between-these-2-inividuals.-you-can-look-at-the-matrix-structure-to-verify-this." class="section level4">
<h4>Determine paths between two vertices. (in this case using “distance” will tell you how many times these 2 individuals came into contact because the for loop was built as “no contact=0” and “contact=previous contact+1”, so a “distance” of 5 is not a measure of actual distance, but number of contacts between these 2 inividuals. You can look at the matrix structure to verify this).</h4>
<pre class="r"><code>distances(uta_graph, &#39;U004&#39;, &#39;U011&#39;)</code></pre>
<pre><code>##      U011
## U004    5</code></pre>
</div>
<div id="or-use-table-to-look-at-all-your-distances-i.e.number-of-contacts-in-this-example-between-connections" class="section level4">
<h4>Or use table to look at all your “distances” (i.e. number of contacts in this example) between connections:</h4>
<pre class="r"><code>table(distances(uta_graph))</code></pre>
<pre><code>## 
##   0   1   2   3   4   5   6   7   8   9 Inf 
##  15  10   8  12   6   6   6   2   2   4 154</code></pre>
</div>
<div id="we-can-determine-the-degree-at-a-single-vector" class="section level4">
<h4>We can determine the degree at a single vector:</h4>
<pre class="r"><code>degree(uta_graph, &#39;U004&#39;)</code></pre>
<pre><code>## U004 
##    4</code></pre>
</div>
<div id="or-for-the-entire-dataset" class="section level4">
<h4>Or for the entire dataset:</h4>
<pre class="r"><code>degree(uta_graph)</code></pre>
<pre><code>## U004 U006 U005 U007 U001 U002 U008 U009 U003 U010 U011 U012 U013 U014 U015 
##    4    2    3    0    2    2    0    1    3    2    1    2    4    3    1</code></pre>
<p>Degree is an important measure of how connected an individual is. Knowing how many connections individuals have lets you evaluate how connected or isolated they are.</p>
</div>
<div id="degree-can-be-sorted-as-can-distance-and-betweenness" class="section level4">
<h4>Degree can be sorted (as can distance and betweenness):</h4>
<pre class="r"><code>sort(degree(uta_graph))</code></pre>
<pre><code>## U007 U008 U009 U011 U015 U006 U001 U002 U010 U012 U005 U003 U014 U004 U013 
##    0    0    1    1    1    2    2    2    2    2    3    3    3    4    4</code></pre>
</div>
<div id="we-can-also-calculate-betweenness-centrality-for-all-the-vertices" class="section level4">
<h4>We can also calculate betweenness centrality for all the vertices:</h4>
<pre class="r"><code>betweenness(uta_graph)</code></pre>
<pre><code>## U004 U006 U005 U007 U001 U002 U008 U009 U003 U010 U011 U012 U013 U014 U015 
##    8    9    3    0    5    0    0    0    0    0    0    5    8    0    0</code></pre>
<p>In this example knowing the “betweenness” is an indicator of individuals that may be highly important links connecting other individuals or populations. Loosing these individuals or their habitat may result in disarticulation of the observed network structure and lead to potential isolation.</p>
</div>
<div id="if-we-want-to-look-at-the-structure-of-these-relationships-is-by-throat-color" class="section level4">
<h4>If we want to look at the structure of these relationships is by throat color:</h4>
<pre class="r"><code>ingraph_names &lt;- as.character(V(uta_graph)$name)

throatvals &lt;- as.character(uta$Throat[match(V(uta_graph)$name, uta$ID)])

uta_graph2 &lt;- set_vertex_attr(graph=uta_graph, name=&quot;throat&quot;, index=V(uta_graph), value=throatvals)

V(uta_graph2)$throat</code></pre>
<pre><code>##  [1] &quot;B&quot; &quot;B&quot; &quot;O&quot; &quot;Y&quot; &quot;Y&quot; &quot;Y&quot; &quot;Y&quot; &quot;B&quot; &quot;O&quot; &quot;Y&quot; &quot;O&quot; &quot;Y&quot; &quot;B&quot; &quot;B&quot; &quot;Y&quot;</code></pre>
<pre class="r"><code>V(uta_graph2)$color=V(uta_graph2)$throat 
V(uta_graph2)$color=gsub(&quot;O&quot;,&quot;orange&quot;,V(uta_graph2)$color) 
V(uta_graph2)$color=gsub(&quot;Y&quot;,&quot;yellow&quot;,V(uta_graph2)$color)
V(uta_graph2)$color=gsub(&quot;B&quot;,&quot;blue&quot;,V(uta_graph2)$color)
plot.igraph(uta_graph,vertex.label=uta_graph$ID,layout=layout.fruchterman.reingold,vertex.color=V(uta_graph2)$color)</code></pre>
<p><img src="GraphTheory_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
</div>
</div>
<div id="cheatsheet-to-useful-expressions-in-igraph" class="section level2">
<h2>CHEATSHEET TO USEFUL EXPRESSIONS IN IGRAPH</h2>
<p>V(dataset) ####returns all vertices V(dataset)[#, #:#] ####shows vertices in the specified positions V(dataset)[degree(dataset) &lt; #] ####finds vertices satisfying the specified condition (degree=number of edges connected to a node) V(dataset)[nei(‘vertex name’)] ####shows vertex neighbors V(dataset)[‘vertex name’, ‘vertex name’] ####selects given vertices E(dataset) ####returns all edges E(dataset)[vertexset %–% vertexset] ####shows all edges between two vertex sets (in the yeast example a vertex set could be Class or Descrition)</p>
</div>
<div id="excercise-1---basic-graph-tutorial" class="section level2">
<h2>EXCERCISE #1 - BASIC GRAPH TUTORIAL</h2>
<div id="in-this-excercise-we-will-walk-through-building-basic-graphs-with-code-provided." class="section level4">
<h4>In this excercise we will walk through building basic graphs with code provided.</h4>
</div>
<div id="use-make_empty_graph-to-create-a-dataset-of-10-meaningless-points" class="section level4">
<h4>Use make_empty_graph to create a dataset of 10 meaningless points:</h4>
<pre class="r"><code>graph &lt;- make_empty_graph(10)
graph[-1, 1] &lt;- TRUE
graph</code></pre>
<pre><code>## IGRAPH D--- 10 9 -- 
## + edges:
## [1]  2-&gt;1  3-&gt;1  4-&gt;1  5-&gt;1  6-&gt;1  7-&gt;1  8-&gt;1  9-&gt;1 10-&gt;1</code></pre>
</div>
<div id="add-vertices-then-plot-a-ring-graph" class="section level4">
<h4>Add vertices, then plot a RING GRAPH:</h4>
<pre class="r"><code>graph &lt;- make_ring(10) + 4
plot(graph)</code></pre>
<p><img src="GraphTheory_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
</div>
<div id="add-attributes" class="section level4">
<h4>Add attributes:</h4>
<pre class="r"><code>graph &lt;- make_(ring(10), with_vertex_(color = &quot;black&quot;)) +
  vertices(&#39;outlier&#39;, color = &quot;red&quot;)
plot(graph)</code></pre>
<p><img src="GraphTheory_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
</div>
<div id="make-a-directed-star-graph" class="section level4">
<h4>Make a directed STAR GRAPH:</h4>
<pre class="r"><code>graph &lt;- make_(star(10), with_edge_(color = &quot;black&quot;))
plot(graph)</code></pre>
<p><img src="GraphTheory_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<p>(notice all the edge connections are directed arrows feeding into node #1)</p>
</div>
<div id="add-a-chain-of-edges" class="section level4">
<h4>Add a chain of edges:</h4>
<pre class="r"><code>graph &lt;- make_(empty_graph(5)) + path(1,2,3,4,5,1)
graph2 &lt;- make_(empty_graph(5)) + path(1:5, 1)</code></pre>
</div>
<div id="call-graph-and-graph2-to-see-what-the-data-look-like.-then-graph-the-plots-and-see-if-they-are-different.-why-or-why-not" class="section level4">
<h4>Call graph and graph2 to see what the data look like. Then, graph the plots and see if they are different. Why or why not?</h4>
</div>
<div id="create-a-wheel-graph" class="section level4">
<h4>Create a WHEEL GRAPH:</h4>
<pre class="r"><code>graph&lt;-make_star(11, center = 11, mode = &quot;undirected&quot;) + path(1:10, 1)
par(mar = c(0,0,0,0)); plot(graph)</code></pre>
<p><img src="GraphTheory_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
</div>
<div id="creating-paths-in-graph---start-by-making-some-random-data-using-set.seed-to-randomly-generate-numbers-and-sample_gnp-to-create-every-possible-edge-with-equal-probability" class="section level4">
<h4>CREATING PATHS IN GRAPH - start by making some random data using set.seed to randomly generate numbers and sample_gnp to create every possible edge with equal probability:</h4>
<pre class="r"><code>set.seed(42)
graph &lt;- sample_gnp(12, 0.25)</code></pre>
</div>
<div id="now-we-will-build-a-path-between-vertices" class="section level4">
<h4>Now we will build a path between vertices:</h4>
<pre class="r"><code>mypath &lt;- V(graph)[11, 2, 12, 8]</code></pre>
</div>
<div id="then-assign-them-graph-attributes" class="section level4">
<h4>Then assign them graph attributes:</h4>
<pre class="r"><code>V(graph)[mypath]$color &lt;- &#39;green&#39;
E(graph)$color &lt;- &#39;grey&#39;
E(graph, path = mypath)$color &lt;- &#39;red&#39;
E(graph, path = mypath)$width &lt;- 3</code></pre>
</div>
<div id="plot-the-path-in-the-graph" class="section level4">
<h4>PLOT THE PATH IN THE GRAPH:</h4>
<pre class="r"><code>plot(graph, margin = 0, layout = layout_nicely)</code></pre>
<p><img src="GraphTheory_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<p>Reference:<a href="http://igraph.org/r/doc/aaa-igraph-package.html" class="uri">http://igraph.org/r/doc/aaa-igraph-package.html</a></p>
</div>
</div>
<div id="excercise-2---yeast-protein-protein-interaction-network" class="section level2">
<h2>EXCERCISE #2 - YEAST PROTEIN-PROTEIN INTERACTION NETWORK</h2>
<p>Installed public data sets from: <a href="https://github.com/igraph/igraphdata" class="uri">https://github.com/igraph/igraphdata</a></p>
<pre class="r"><code>install.packages(&quot;igraphdata&quot;)</code></pre>
<p>Import dataset:</p>
<pre class="r"><code>library(igraphdata)</code></pre>
<pre><code>## Warning: package &#39;igraphdata&#39; was built under R version 3.3.2</code></pre>
<pre class="r"><code>data(&quot;yeast&quot;)
data()</code></pre>
<p>View the matrix for yeast protein:</p>
<pre class="r"><code>yeast</code></pre>
<div id="make-sure-you-can-see-which-proteins-are-connected-to-each-other-in-this-example." class="section level4">
<h4>Make sure you can see which proteins are connected to each other in this example.</h4>
<p>To create a simple graph from a multigraph, specify what it should do with edges:</p>
<pre class="r"><code>yp &lt;- simplify(yeast, edge.attr.comb =
                 list(name = &quot;sum&quot;, Class = &quot;sum&quot;, Description = &quot;sum&quot;, &quot;ignore&quot;))</code></pre>
<p>Check to make sure the graph is simple and view the summary info:</p>
<pre class="r"><code>is_simple(yp)</code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="r"><code>summary(yp)</code></pre>
<pre><code>## IGRAPH UN-- 2617 11855 -- Yeast protein interactions, von Mering et al.
## + attr: name (g/c), Citation (g/c), Author (g/c), URL (g/c),
## | Classes (g/x), name (v/c), Class (v/c), Description (v/c)</code></pre>
</div>
<div id="convert-back-to-tables-to-see-the-vertices-and-edges-tables---hint-use-code-from-lecture-example." class="section level4">
<h4>Convert back to tables to see the vertices and edges tables - hint: use code from lecture example.</h4>
</div>
<div id="query-the-data-to-see-if-an-edge-exists-between-two-randomly-selected-proteins.1-or-more-yes-an-edge-exists-between-these-0-no-edge-connection" class="section level4">
<h4>Query the data to see if an edge exists between two randomly selected proteins.1 (or more) = yes, an edge exists between these, 0 = no edge connection</h4>
<p>You can also see all adjacent vertices of a specified vertex:</p>
<pre class="r"><code>yp[[&quot;YPR110C&quot;]]</code></pre>
</div>
<div id="how-do-you-see-all-vertices" class="section level4">
<h4>How do you see all vertices?</h4>
</div>
<div id="all-edges" class="section level4">
<h4>All edges?</h4>
</div>
<div id="what-does-the-plot-for-the-network-look-like" class="section level4">
<h4>What does the plot for the network look like?</h4>
<p>Call yp:</p>
<pre class="r"><code>yp</code></pre>
<pre><code>## IGRAPH UN-- 2617 11855 -- Yeast protein interactions, von Mering et al.
## + attr: name (g/c), Citation (g/c), Author (g/c), URL (g/c),
## | Classes (g/x), name (v/c), Class (v/c), Description (v/c)
## + edges (vertex names):
##  [1] YLR197W--YPL093W YLR197W--YER006W YLR197W--YHR052W YLR197W--YGR162W
##  [5] YLR197W--YOL041C YLR197W--YPL043W YLR197W--YOR310C YLR197W--YPL012W
##  [9] YLR197W--YMR049C YLR197W--YLR409C YLR197W--YLR222C YLR197W--YOL077C
## [13] YLR197W--YPL126W YLR197W--YDR496C YLR197W--YGR145W YLR197W--YGR103W
## [17] YLR197W--YLR175W YLR197W--YNL132W YLR197W--YOR206W YLR197W--YNL061W
## [21] YLR197W--YMR290C YLR197W--YBL004W YLR197W--YGR090W YLR197W--YJL109C
## [25] YLR197W--YDR449C YLR197W--YER082C YLR197W--YCR057C YLR197W--YDR324C
## + ... omitted several edges</code></pre>
<p>Note that IGRAPH means this is a graph object, that is undirected (U) and named (N). (D=directed, B=bipartate, like the graph of tortoises and burrows, W=weighted)</p>
</div>
<div id="look-at-the-yeast-classes.-what-does-1e-signify" class="section level4">
<h4>Look at the yeast classes. What does #1(E) signify?</h4>
</div>
<div id="determine-the-shortest-path-between-two-vertices-choose-any-2-randomly-using-distance.-notethis-will-provide-the-shortest-path-calculated-based-on-the-number-of-edges." class="section level4">
<h4>Determine the shortest path between two vertices (choose any 2 randomly) using distance. (note:this will provide the shortest path calculated based on the number of edges).</h4>
<p>You can also use table to look at all your distances between connections:</p>
<pre class="r"><code>table(distances(yp))</code></pre>
<p>You can sort the distances:</p>
<pre class="r"><code>sort(rowMeans(distances(yp))[1:15])</code></pre>
<pre><code>## YLR197W YOR039W YDR473C YOR332W YER090W YDR394W YER021W YPR029C YIL106W 
##     Inf     Inf     Inf     Inf     Inf     Inf     Inf     Inf     Inf 
## YKL166C YGL026C YOR061W YGL115W YGL049C YDL140C 
##     Inf     Inf     Inf     Inf     Inf     Inf</code></pre>
</div>
<div id="why-might-this-be-useful" class="section level4">
<h4>Why might this be useful?</h4>
</div>
<div id="what-is-the-code-to-determine-the-degree-of-a-single-vector" class="section level4">
<h4>What is the code to determine the degree of a single vector?</h4>
</div>
<div id="what-code-provides-degrees-for-the-entire-dataset" class="section level4">
<h4>What code provides degrees for the entire dataset?</h4>
</div>
<div id="how-would-you-calculate-betweenness-centrality-why-might-you-want-to" class="section level4">
<h4>How would you calculate betweenness centrality? Why might you want to?</h4>
</div>
<div id="feel-free-to-explore-the-additional-datasets-in-your-igraphdata-library" class="section level4">
<h4>Feel free to explore the additional datasets in your igraphdata library!</h4>
</div>
<div id="acknowledgements" class="section level4">
<h4>Acknowledgements</h4>
<p>I would like to thank Ken Nussear (UNR-Geography) for suppling simulated data frameworks, sharing code, and continued assistance with R. Also, Kevin Shoemaker (UNR-EECB) for additional help understanding R and contributing to the code presented here.</p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
