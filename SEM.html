<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="NRES 746" />


<title>Structural Equation Modeling and Path Analysis</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">NRES 746</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Schedule
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="schedule.html">Course Schedule</a>
    </li>
    <li>
      <a href="labschedule.html">Lab Schedule</a>
    </li>
    <li>
      <a href="Syllabus2.pdf">Syllabus</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="INTRO.html">Introduction to NRES 746</a>
    </li>
    <li>
      <a href="LECTURE1.html">Why focus on algorithms?</a>
    </li>
    <li>
      <a href="LECTURE2.html">Working with probabilities</a>
    </li>
    <li>
      <a href="LECTURE3.html">The Virtual Ecologist</a>
    </li>
    <li>
      <a href="LECTURE4.html">Likelihood</a>
    </li>
    <li>
      <a href="LECTURE5.html">Optimization</a>
    </li>
    <li>
      <a href="LECTURE6.html">Bayesian #1: concepts</a>
    </li>
    <li>
      <a href="LECTURE7.html">Bayesian #2: mcmc</a>
    </li>
    <li>
      <a href="LECTURE8.html">Model Selection</a>
    </li>
    <li>
      <a href="LECTURE9.html">Performance Evaluation</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Lab exercises
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="LAB1.html">Lab 1: Algorithms in R</a>
    </li>
    <li>
      <a href="FINALPROJ.html">Final project overview</a>
    </li>
    <li>
      <a href="LAB2.html">Lab 2: Virtual ecologist</a>
    </li>
    <li>
      <a href="LAB3.html">Lab 3: Likelihood</a>
    </li>
    <li>
      <a href="LAB4.html">Lab 4: Bayesian Inference</a>
    </li>
    <li>
      <a href="FigureDemo.html">Demo: Figures in R</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Student-led topics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="TimeSeries.html">Time-series analysis</a>
    </li>
    <li>
      <a href="SEM.html">Structural Equation Models</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Data sets
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="TreeData.csv">Tree Data</a>
    </li>
    <li>
      <a href="ReedfrogPred.csv">Reed Frog Predation Data</a>
    </li>
    <li>
      <a href="ReedfrogFuncresp.csv">Reed Frog Func Resp</a>
    </li>
  </ul>
</li>
<li>
  <a href="Links.html">Links</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Structural Equation Modeling and Path Analysis</h1>
<h4 class="author"><em>NRES 746</em></h4>
<h4 class="date"><em>Fall 2018</em></h4>

</div>


<p><strong>Presenters</strong>: Maya Zawlodzki, Stephanie Coronado, Stephanie Cole, Elaine Chu, Chris Wolfe</p>
<p>For those wishing to follow along with the R-based demo in class, <a href="SEM.R">click here</a> for the companion R script for this lecture.</p>
<p>For those wishing to follow along with the slide presentation, <a href="https://docs.google.com/presentation/d/1BibPb9OGinVAimd1QLBxxWenz72K1sQchATXXWoO5Q0/edit?usp=sharing">click here</a> for the Google Sheets component of this lecture.</p>
<div id="set-up" class="section level1">
<h1>Set-Up</h1>
<p>There are a LOT of packages / libraries used in this tutorial. So load them sooner than later!</p>
<pre class="r"><code>## Install packages
#install.packages(&quot;OpenMx&quot;)
#install.packages(&quot;lavaan&quot;)
#install.packages(&quot;semPlot&quot;)
#install.packages(&quot;tidyverse&quot;)
#install.packages(&quot;GGally&quot;)

## Load libraries
suppressMessages(library(lavaan))
suppressMessages(library(OpenMx))
suppressMessages(library(semPlot))
suppressMessages(library(tidyverse))</code></pre>
<pre><code>## Warning: package &#39;ggplot2&#39; was built under R version 3.5.1</code></pre>
<pre class="r"><code>suppressMessages(library(GGally))</code></pre>
</div>
<div id="path-analysis" class="section level1">
<h1>Path Analysis</h1>
<ul>
<li>This tutorial was adapted from <a href="http://www.rpubs.com/tbihansk/302732">“Introduction to Path Analysis in R”</a> by Thomas Bihansky (2017)</li>
</ul>
<div id="modeling" class="section level2">
<h2>Modeling</h2>
<p>Because SEM is method of model verification, we need to have an initial model in mind. Keep in mind that SEM is inherently <em>causal</em>. Therefore, our results will depend on our research design.</p>
<p>The first step is to look at our data.</p>
<pre class="r"><code>## View your data
summary(mtcars)</code></pre>
<pre><code>##       mpg             cyl             disp             hp       
##  Min.   :10.40   Min.   :4.000   Min.   : 71.1   Min.   : 52.0  
##  1st Qu.:15.43   1st Qu.:4.000   1st Qu.:120.8   1st Qu.: 96.5  
##  Median :19.20   Median :6.000   Median :196.3   Median :123.0  
##  Mean   :20.09   Mean   :6.188   Mean   :230.7   Mean   :146.7  
##  3rd Qu.:22.80   3rd Qu.:8.000   3rd Qu.:326.0   3rd Qu.:180.0  
##  Max.   :33.90   Max.   :8.000   Max.   :472.0   Max.   :335.0  
##       drat             wt             qsec             vs        
##  Min.   :2.760   Min.   :1.513   Min.   :14.50   Min.   :0.0000  
##  1st Qu.:3.080   1st Qu.:2.581   1st Qu.:16.89   1st Qu.:0.0000  
##  Median :3.695   Median :3.325   Median :17.71   Median :0.0000  
##  Mean   :3.597   Mean   :3.217   Mean   :17.85   Mean   :0.4375  
##  3rd Qu.:3.920   3rd Qu.:3.610   3rd Qu.:18.90   3rd Qu.:1.0000  
##  Max.   :4.930   Max.   :5.424   Max.   :22.90   Max.   :1.0000  
##        am              gear            carb      
##  Min.   :0.0000   Min.   :3.000   Min.   :1.000  
##  1st Qu.:0.0000   1st Qu.:3.000   1st Qu.:2.000  
##  Median :0.0000   Median :4.000   Median :2.000  
##  Mean   :0.4062   Mean   :3.688   Mean   :2.812  
##  3rd Qu.:1.0000   3rd Qu.:4.000   3rd Qu.:4.000  
##  Max.   :1.0000   Max.   :5.000   Max.   :8.000</code></pre>
<p>We can use a correlation plot to explore the relationships between the variables in our data:</p>
<pre class="r"><code>ggcorr(mtcars[-c(5,7,9)], nbreaks=NULL, label=T, low=&quot;red3&quot;, high=&quot;green3&quot;, label_round=2, name=&quot;Correlation Scale&quot;, label_alpha=T, hjust=0.75) + 
     ggtitle(label=&quot;Correlation Plot&quot;) + 
     theme(plot.title=element_text(hjust=0.6))</code></pre>
<p><img src="SEM_files/figure-html/PA%20correlation%20plot-1.png" width="1152" /></p>
<p>From our summary and correlation plot, we can decide what variables we want to use in our model:</p>
<div id="dependent-variable" class="section level5">
<h5><strong>dependent variable:</strong></h5>
<ul>
<li>mpg</li>
</ul>
</div>
<div id="independent-variables" class="section level5">
<h5><strong>independent variables:</strong></h5>
<ul>
<li>hp<br />
</li>
<li>cyl<br />
</li>
<li>disp<br />
</li>
<li>carb<br />
</li>
<li>am<br />
</li>
<li>wt</li>
</ul>
<p>First, we could evaluate this relationship using a simple linear regression:</p>
<pre class="r"><code>## Simple Linear Model:
linear &lt;- lm(mpg ~ hp+ cyl + disp + carb + am + wt, data=mtcars)

linear</code></pre>
<pre><code>## 
## Call:
## lm(formula = mpg ~ hp + cyl + disp + carb + am + wt, data = mtcars)
## 
## Coefficients:
## (Intercept)           hp          cyl         disp         carb  
##   36.988646    -0.020796    -0.996962     0.006998    -0.320956  
##          am           wt  
##    1.904625    -2.848489</code></pre>
<p>With our generalized linear model, we have the best coefficients (beta-values) for our relationship.</p>
<p>But what if the relationships between our independent variables are more complex?</p>
<p>We can explore these complexites by applying a structure to our model. To do so, we are <strong>applying causality</strong>.</p>
<p>For that, we could draw a model:</p>
<div class="figure">
<img src="Model.jpg" />

</div>
<p>Now, lets code our model:</p>
<pre class="r"><code>## Set up your model in R
model = &#39;
     # Blue Relationship
     mpg ~ hp + cyl + disp + carb + am + wt
     
     # Green Relationship
     hp ~ cyl + disp + carb
&#39;</code></pre>
</div>
</div>
<div id="test-your-model" class="section level2">
<h2>Test Your Model</h2>
<p>After we have our model coded in our global environment, we can test our model to see how well it works using the sem() function:</p>
<pre class="r"><code>## run sem()
path &lt;- sem(model, data=mtcars)

path</code></pre>
<pre><code>## lavaan (0.6-1) converged normally after  59 iterations
## 
##   Number of observations                            32
## 
##   Estimator                                         ML
##   Model Fit Test Statistic                       7.575
##   Degrees of freedom                                 2
##   P-value (Chi-square)                           0.023</code></pre>
<p>This simple output from returning “path” provides us with a quick evaluation of our model. Here, we can do a basic evaluation of how well our model has worked, by looking at our “Model Fit Test Statistic”, which is a Chi-Square statistic. Our “Degrees of Freedom” tells us how many potential paths were <em>NOT</em> used in our model. Additionally, our p-value lets us know if the Chi-Square is statisically significant. This analysis informs us how “good” our model is. Because we reject the null hypothesis, this means that our model essentially could be better.</p>
</div>
<div id="interpreting-results" class="section level2">
<h2>Interpreting Results</h2>
<p>To get a more in-depth look at our path results, including our coefficients, we can use the summary() function:</p>
<pre class="r"><code>summary(path, standardized = T, fit.measures=T, rsquare=T)</code></pre>
<pre><code>## lavaan (0.6-1) converged normally after  59 iterations
## 
##   Number of observations                            32
## 
##   Estimator                                         ML
##   Model Fit Test Statistic                       7.575
##   Degrees of freedom                                 2
##   P-value (Chi-square)                           0.023
## 
## Model test baseline model:
## 
##   Minimum Function Test Statistic              132.287
##   Degrees of freedom                                11
##   P-value                                        0.000
## 
## User model versus baseline model:
## 
##   Comparative Fit Index (CFI)                    0.954
##   Tucker-Lewis Index (TLI)                       0.747
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)               -220.208
##   Loglikelihood unrestricted model (H1)       -216.420
## 
##   Number of free parameters                         11
##   Akaike (AIC)                                 462.416
##   Bayesian (BIC)                               478.539
##   Sample-size adjusted Bayesian (BIC)          444.247
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.295
##   90 Percent Confidence Interval          0.094  0.531
##   P-value RMSEA &lt;= 0.05                          0.030
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.024
## 
## Parameter Estimates:
## 
##   Information                                 Expected
##   Information saturated (h1) model          Structured
##   Standard Errors                             Standard
## 
## Regressions:
##                    Estimate   Std.Err  z-value  P(&gt;|z|)   Std.lv   Std.all
##   mpg ~                                                                   
##     hp                -0.021    0.016   -1.330    0.184    -0.021   -0.234
##     cyl               -0.997    0.642   -1.554    0.120    -0.997   -0.292
##     disp               0.007    0.012    0.585    0.559     0.007    0.142
##     carb              -0.321    0.506   -0.634    0.526    -0.321   -0.085
##     am                 1.905    1.425    1.336    0.181     1.905    0.156
##     wt                -2.848    1.198   -2.378    0.017    -2.848   -0.457
##   hp ~                                                                    
##     cyl                7.717    6.554    1.177    0.239     7.717    0.201
##     disp               0.233    0.087    2.666    0.008     0.233    0.421
##     carb              20.273    3.405    5.954    0.000    20.273    0.478
## 
## Variances:
##                    Estimate   Std.Err  z-value  P(&gt;|z|)   Std.lv   Std.all
##    .mpg                5.045    1.261    4.000    0.000     5.045    0.140
##    .hp               644.737  161.184    4.000    0.000   644.737    0.142
## 
## R-Square:
##                    Estimate 
##     mpg                0.860
##     hp                 0.858</code></pre>
</div>
<div id="summary-break-down" class="section level2">
<h2>Summary Break-down</h2>
<p>The summary can provide us with additional information about our model:</p>
<ul>
<li>CFI and TFI are numerical indicators of fit. A value of 0.9+ is the industry standard for a “good” model fit. The closer to 1, the better<br />
</li>
<li>AIC and BIC: allows us to compare models<br />
</li>
<li>Unstandardized coefficients: provides us with model-specific path coefficients that are of <strong>original scale</strong> of the data, and allows for estimation of expected values<br />
</li>
<li>Standardized: Allows for comparison of path coefficients between models<br />
</li>
<li>R-Square: descriptive statistic to tell us about the fit of our coefficients</li>
</ul>
</div>
<div id="visualize-your-model" class="section level2">
<h2>Visualize Your Model!</h2>
<pre class="r"><code>## Generated path
semPaths(path, &quot;std&quot;, layout=&#39;tree&#39;, edge.label.cex=.9, curvePivot=T)</code></pre>
<p><img src="SEM_files/figure-html/PA%20paths-1.png" width="1152" /></p>
<p>The model allows us to visualize how well our model fits the data we have.</p>
</div>
</div>
<div id="sem-with-latent-variables" class="section level1">
<h1>SEM with Latent Variables</h1>
<ul>
<li>The following tutorial was adapted from <a href="http://users.ugent.be/~yrosseel/lavaan/lavaanIntroduction.pdf">Yves Rossel Lavaan Tutorial (2012)</a></li>
</ul>
<p>To this point, we have demonstrated the simplest form of structural equation modeling in which only single known indicators (exogenous/independent variables) are employed for the casual model. As we have mentioned earlier, path analysis is just a special form of multiple regression and SEM.</p>
<p>What if some of the observed variables are related to one another in some way? This may lead to issues associated with dimensionality and multicollinearity. Therefore, a hallmark of SEM is the ability to define latent variables to account for such issues and in turn, to see how the <em>unobserved</em> (unquantified) may be related to the endogenous/response variable.</p>
<p>Here is the syntax for such construction in ‘lavaan’:</p>
<blockquote>
<pre><code>y ~ f1 + f2 + x1 + x2      
f1 ~ f2 + f3        
f2 ~ f3 + x1 + x2        </code></pre>
</blockquote>
<p>Where <strong>y</strong> is the observed response, <strong>x</strong> is the observed independent, and <strong>f</strong> is a latent variable. Notice that this is still a series of regression equations.</p>
<p>Any of the latent variables found in the regression formulas must be “defined” by listing their (manifestor latent) indicators. We do this by using the special operator “=~”, which can be read as “is measured by.”</p>
<p>For example, to define the three latent variables <strong>f1</strong>, <strong>f2</strong>, and <strong>f3</strong>, we can use the following model:</p>
<blockquote>
<pre><code>f1 =~ y1 + y2 + y3        
f2 =~ y4 + y5 + y6         
f3 =~ y7 + y8 + y9        </code></pre>
</blockquote>
<p>Additonally, SEM allows us to define variances and covariances between variables up front using the special operator “~~” or intercepts using “~”. We will leave this out of the model. Let’s apply our model using the lavaan package to a built-in dataset called <em>HolzingerSwineford1939</em>:</p>
<pre class="r"><code>#?HolzingerSwineford1939  # some information about the data

head(HolzingerSwineford1939)  # let&#39;s look at the first few lines</code></pre>
<pre><code>##   id sex ageyr agemo  school grade       x1   x2    x3       x4   x5
## 1  1   1    13     1 Pasteur     7 3.333333 7.75 0.375 2.333333 5.75
## 2  2   2    13     7 Pasteur     7 5.333333 5.25 2.125 1.666667 3.00
## 3  3   2    13     1 Pasteur     7 4.500000 5.25 1.875 1.000000 1.75
## 4  4   1    13     2 Pasteur     7 5.333333 7.75 3.000 2.666667 4.50
## 5  5   2    12     2 Pasteur     7 4.833333 4.75 0.875 2.666667 4.00
## 6  6   2    14     1 Pasteur     7 5.333333 5.00 2.250 1.000000 3.00
##          x6       x7   x8       x9
## 1 1.2857143 3.391304 5.75 6.361111
## 2 1.2857143 3.782609 6.25 7.916667
## 3 0.4285714 3.260870 3.90 4.416667
## 4 2.4285714 3.000000 5.30 4.861111
## 5 2.5714286 3.695652 6.30 5.916667
## 6 0.8571429 4.347826 6.65 7.500000</code></pre>
<p>This is a classic SEM dataset that consists of mental ability test scores of seventh- and eight-grade children from two different schools.</p>
<p>To help with understanding the data, the descriptions of certain variables are as follows:</p>
<pre><code> x1: visual perception      
 x2: cubes      
 x3: lozenges     
 x4: paragraph comprehension     
 x5: sentence completion      
 x6: word meaning     
 x7: speeded addition     
 x8: speeded counting of dots     
 x9: speeded discrimination straight and curved capitals      </code></pre>
<p>An SEM model that is often proposed for these 9 variables consists of three latent variables (f#), each with three indicators(y#):</p>
<ol style="list-style-type: decimal">
<li>visual factor (f1) measured by 3 variables: x1, x2, and x3<br />
</li>
<li>textual factor (f2) measured by 3 variables: x4, x5, and x6<br />
</li>
<li>speed factor (f3) measured by 3 variables: x7, x8, and x9</li>
</ol>
<p>What if we want to observe the relationship of age, sex, school, and grade in addition to the three latent variables?</p>
<div class="figure">
<img src="Model2.jpg" />

</div>
<div id="test-your-model-1" class="section level2">
<h2>Test Your Model</h2>
<pre class="r"><code>## Define your model:
ability_model &lt;- &#39;
     # regression equations
     visual ~ sex + ageyr + school + grade
     textual ~ sex + ageyr + school + grade
     speed ~ sex + ageyr + school + grade

     # latent variables
     visual =~ x1 + x2 + x3
     textual =~ x4 + x5 + x6
     speed =~ x7 + x8 + x9

     # covariances
     visual ~~ textual
     visual ~~ speed
     textual ~~ speed
&#39;</code></pre>
<pre class="r"><code>## Run the model
fit_ability &lt;- sem(ability_model, data=HolzingerSwineford1939)

## Summarize including fit measures
summary(fit_ability, standardized=T, rsquare=T, fit.measures=T)</code></pre>
<pre><code>## lavaan (0.6-1) converged normally after  38 iterations
## 
##                                                   Used       Total
##   Number of observations                           300         301
## 
##   Estimator                                         ML
##   Model Fit Test Statistic                     177.588
##   Degrees of freedom                                48
##   P-value (Chi-square)                           0.000
## 
## Model test baseline model:
## 
##   Minimum Function Test Statistic             1151.889
##   Degrees of freedom                                72
##   P-value                                        0.000
## 
## User model versus baseline model:
## 
##   Comparative Fit Index (CFI)                    0.880
##   Tucker-Lewis Index (TLI)                       0.820
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)              -3655.286
##   Loglikelihood unrestricted model (H1)      -3566.492
## 
##   Number of free parameters                         33
##   Akaike (AIC)                                7376.572
##   Bayesian (BIC)                              7498.797
##   Sample-size adjusted Bayesian (BIC)         7394.140
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.095
##   90 Percent Confidence Interval          0.080  0.110
##   P-value RMSEA &lt;= 0.05                          0.000
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.063
## 
## Parameter Estimates:
## 
##   Information                                 Expected
##   Information saturated (h1) model          Structured
##   Standard Errors                             Standard
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   visual =~                                                             
##     x1                1.000                               0.829    0.711
##     x2                0.618    0.106    5.848    0.000    0.512    0.435
##     x3                0.881    0.118    7.488    0.000    0.730    0.647
##   textual =~                                                            
##     x4                1.000                               0.993    0.853
##     x5                1.115    0.064   17.404    0.000    1.107    0.859
##     x6                0.916    0.055   16.788    0.000    0.910    0.831
##   speed =~                                                              
##     x7                1.000                               0.679    0.624
##     x8                1.073    0.134    8.002    0.000    0.729    0.722
##     x9                0.934    0.122    7.664    0.000    0.635    0.629
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   visual ~                                                              
##     sex              -0.392    0.115   -3.391    0.001   -0.472   -0.236
##     ageyr            -0.238    0.066   -3.580    0.000   -0.287   -0.301
##     school            0.271    0.117    2.326    0.020    0.327    0.164
##     grade             0.633    0.136    4.669    0.000    0.763    0.381
##   textual ~                                                             
##     sex               0.062    0.110    0.565    0.572    0.062    0.031
##     ageyr            -0.373    0.064   -5.816    0.000   -0.376   -0.395
##     school           -0.419    0.113   -3.708    0.000   -0.422   -0.211
##     grade             0.844    0.129    6.524    0.000    0.851    0.425
##   speed ~                                                               
##     sex               0.074    0.088    0.836    0.403    0.109    0.054
##     ageyr             0.001    0.051    0.020    0.984    0.001    0.002
##     school            0.169    0.091    1.860    0.063    0.249    0.125
##     grade             0.580    0.112    5.179    0.000    0.854    0.427
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##  .visual ~~                                                             
##    .textual           0.288    0.058    4.989    0.000    0.441    0.441
##    .speed             0.192    0.047    4.061    0.000    0.417    0.417
##  .textual ~~                                                            
##    .speed             0.146    0.043    3.374    0.001    0.279    0.279
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .x1                0.674    0.097    6.927    0.000    0.674    0.495
##    .x2                1.124    0.101   11.086    0.000    1.124    0.811
##    .x3                0.741    0.088    8.420    0.000    0.741    0.582
##    .x4                0.369    0.046    7.957    0.000    0.369    0.272
##    .x5                0.434    0.056    7.726    0.000    0.434    0.262
##    .x6                0.370    0.043    8.687    0.000    0.370    0.309
##    .x7                0.725    0.078    9.322    0.000    0.725    0.611
##    .x8                0.487    0.067    7.253    0.000    0.487    0.478
##    .x9                0.616    0.067    9.236    0.000    0.616    0.605
##    .visual            0.576    0.110    5.231    0.000    0.838    0.838
##    .textual           0.743    0.087    8.567    0.000    0.754    0.754
##    .speed             0.367    0.075    4.894    0.000    0.795    0.795
## 
## R-Square:
##                    Estimate
##     x1                0.505
##     x2                0.189
##     x3                0.418
##     x4                0.728
##     x5                0.738
##     x6                0.691
##     x7                0.389
##     x8                0.522
##     x9                0.395
##     visual            0.162
##     textual           0.246
##     speed             0.205</code></pre>
<pre class="r"><code>## Visualize your paths (may have to try a few!)
semPaths(fit_ability, &#39;std&#39;, layout=&#39;circle&#39;)</code></pre>
<p><img src="SEM_files/figure-html/SEM%20plot-1.png" width="1152" /></p>
<pre class="r"><code>semPaths(fit_ability,&#39;std&#39;, layout=&#39;tree&#39;, edge.label.cex =.9, curvePivot=T)</code></pre>
<p><img src="SEM_files/figure-html/SEM%20plot-2.png" width="1152" /></p>
</div>
</div>
<div id="questions" class="section level1">
<h1>Questions?</h1>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
