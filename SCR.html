<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Heather Reich, Josh Vasquez, Megan Osterhout" />

<meta name="date" content="2021-11-10" />

<title>Spatial Capture-Recapture</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">NRES 746</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Schedule
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="schedule.html">Course Schedule</a>
    </li>
    <li>
      <a href="Syllabus.pdf">Syllabus</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="INTRO.html">Introduction to NRES 746</a>
    </li>
    <li>
      <a href="LECTURE1.html">Why focus on algorithms?</a>
    </li>
    <li>
      <a href="LECTURE2.html">Working with probabilities</a>
    </li>
    <li>
      <a href="LECTURE3.html">The Virtual Ecologist</a>
    </li>
    <li>
      <a href="LECTURE4.html">Likelihood</a>
    </li>
    <li>
      <a href="LECTURE5.html">Optimization</a>
    </li>
    <li>
      <a href="LECTURE6.html">Bayesian #1: concepts</a>
    </li>
    <li>
      <a href="LECTURE7.html">Bayesian #2: mcmc</a>
    </li>
    <li>
      <a href="LECTURE8.html">Model Selection</a>
    </li>
    <li>
      <a href="LECTURE9.html">Performance Evaluation</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Lab exercises
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="LAB_Instructions.html">Instructions for Labs</a>
    </li>
    <li>
      <a href="FINALPROJ.html">Final project overview</a>
    </li>
    <li>
      <a href="LAB3demo.html">Lab 3: Likelihood (intro)</a>
    </li>
    <li>
      <a href="LAB5.html">Lab 5: Model selection (optional)</a>
    </li>
    <li>
      <a href="FigureDemo.html">Demo: Figures in R</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Student-led topics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="LECTURE10.html">Machine Learning</a>
    </li>
    <li>
      <a href="TimeSeries_all.html">Time Series</a>
    </li>
    <li>
      <a href="SCR.html">Spatial Capture-Recapture</a>
    </li>
    <li>
      <a href="spatial_autocorrelation.html">Spatial Autocorrelation</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Data sets
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="TreeData.csv">Tree Data</a>
    </li>
    <li>
      <a href="ReedfrogPred.csv">Reed Frog Predation Data</a>
    </li>
    <li>
      <a href="ReedfrogFuncresp.csv">Reed Frog Func Resp</a>
    </li>
  </ul>
</li>
<li>
  <a href="Links.html">Links</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Spatial Capture-Recapture</h1>
<h4 class="author">Heather Reich, Josh Vasquez, Megan Osterhout</h4>
<h4 class="date">11/10/2021</h4>

</div>

<div id="TOC">
<ul>
<li><a href="#capture-recapture-cr">Capture-Recapture (CR)</a>
<ul>
<li><a href="#assumptions-of-capture-recapture">Assumptions of Capture-Recapture:</a></li>
<li><a href="#capture-recapture-inadequacies">Capture-Recapture Inadequacies:</a></li>
</ul></li>
<li><a href="#spatially-explicit-capture-recapture-scr-or-secr">Spatially Explicit Capture-Recapture (SCR or SECR)</a>
<ul>
<li><a href="#assumptions-of-spatial-capture-recapture">Assumptions of Spatial Capture-Recapture:</a></li>
<li><a href="#secr-models">SECR Models:</a></li>
<li><a href="#basic-secr-model"><strong>Basic SECR model:</strong></a></li>
<li><a href="#working-with-secr-data">Working with SECR data</a></li>
<li><a href="#another-example-this-time-with-horned-lizards">Another example, this time with horned lizards!</a></li>
</ul></li>
</ul>
</div>

<p>Here is the download link for the R script for this lecture: <a href="SCR.R">Spatial Capture-Recapture</a></p>
<p>Abundance and density of an animal population is integral to their conservation and management. These parameters can be difficult to estimate when individuals cannot be observed perfectly.</p>
<p>Spatially Explicit Capture-Recapture models “estimate the density and size of a spatially distributed animal population sampled with an array of detectors, such as traps, or by searching polygons or transects.”</p>
<p><img src="bears.jpg" /></p>
<div id="capture-recapture-cr" class="section level1">
<h1>Capture-Recapture (CR)</h1>
<p>A century old technique that is the primary way for researchers and managers to estimate population size and demographic processes. CR uses individual-level detection data, in the form of presence and absence.</p>
<p><strong>Examples of CR:</strong></p>
<p>(video of ants!)</p>
<p><img src="lola.JPG" /></p>
<p float="left">
<p><img src="birdband.jpg" width="350"/> <img src="CRexample.JPG" width="200"/></p>
</p>
<p><strong>Population abundance estimate:</strong></p>
<p>The Lincoln-Peterson Method is used to estimate populations with 2 capture occasions. <span class="math display">\[
\hat{N}=\frac{nK}{k}
\]</span> Where:</p>
<p><span class="math inline">\(\hat{N}\)</span>=population abundance estimate</p>
<p><span class="math inline">\(n\)</span>= animals marked on the first occasion</p>
<p><span class="math inline">\(K\)</span>= animals encountered on the second occasion</p>
<p><span class="math inline">\(k\)</span>= marked animals on the second occasion</p>
<p><strong>Survival and detection probability estimates:</strong></p>
<p>Individual encounter events (<span class="math inline">\(y_{ik}\)</span>) are Bernoulli trials</p>
<p><span class="math display">\[
y_{ik}\sim Bernoulli(p_{ik})
\]</span></p>
<ul>
<li>Cormack-Jolly-Sebers (CJS) models are used to estimate survival and detection probabilities.</li>
</ul>
<div id="assumptions-of-capture-recapture" class="section level3">
<h3>Assumptions of Capture-Recapture:</h3>
<ol style="list-style-type: decimal">
<li><p>Each individual has an equal chance of being captured</p></li>
<li><p>Marking does not influence an individual’s chance of being recaptured</p></li>
<li><p>Births and immigration do not occur between the marking and recapture efforts</p></li>
<li><p>Marks are not lost between capture and recapture</p></li>
</ol>
</div>
<div id="capture-recapture-inadequacies" class="section level3">
<h3>Capture-Recapture Inadequacies:</h3>
<ul>
<li><p>Does not admit the spatial structure of the ecological processes that give rise to the encounter history data, nor the spatial aspect of data collection</p></li>
<li><p>The parameter <span class="math inline">\(N\)</span> is unrelated to any notion of the sample area, resulting in arbitrary guesses as area</p></li>
<li><p>Does not provide information relating to movement, space usage, resource selection, etc.</p></li>
<li><p>Too simple!</p></li>
<li><p>Movement estimates are based off of the trapping grid</p>
<ul>
<li>Researchers have suggested that the grid should be four times that of an individual’s home range in order to avoid positive bias of the estimates of density. This can be problematic with large mammals whose home ranges will become extremely large with the suggested grid size.</li>
</ul></li>
</ul>
<p><strong>What if we were trying to estimate the population of a sensitive species? Would this be acceptable?</strong></p>
</div>
</div>
<div id="spatially-explicit-capture-recapture-scr-or-secr" class="section level1">
<h1>Spatially Explicit Capture-Recapture (SCR or SECR)</h1>
<p>A new “revolutionary” way to study animal populations. SECR overcomes the edge effects that occur in CR models. SECR allows us to define a point process and its state space, which allows an accurate density estimate, giving context to the population size.</p>
<p><strong>Examples of detectors:</strong></p>
<ul>
<li><p>Live traps</p>
<ul>
<li>Sherman</li>
<li>Pitfall</li>
<li>Culvert</li>
<li>Mist net</li>
</ul></li>
<li><p>Sticky traps/snags that collect hair</p></li>
<li><p>Cameras</p></li>
<li><p>Scat sampling</p></li>
<li><p>Polygon or transect surveys</p></li>
<li><p>Acoustics</p></li>
</ul>
<p float="left">
<p><img src="bearrub.jpg" width="350"/> <img src="bearhair.jpg" width="250"/></p>
</p>
<p><img src="SolarPanelBear.jpg" /></p>
<p><strong>Influence of trap type on detection</strong> <img src="singlevmulti.JPG" /></p>
<p>SECR models can be used anytime animal recaptures are recorded but using a grid design is the most common</p>
<p float="left">
<p><img src="poopolygon.jpg" width="550"/> <img src="standardgrid.JPG" width="275"/></p>
</p>
<div id="assumptions-of-spatial-capture-recapture" class="section level3">
<h3>Assumptions of Spatial Capture-Recapture:</h3>
<ol style="list-style-type: decimal">
<li><p>Demographic closure: there is no recruitment or mortality in the sampled population</p></li>
<li><p>Geographic closure: there is no emigration or immigration from the state-space. However, SECR allows for “temporary” movements around the state-space</p></li>
<li><p>Activity centers are randomly disbursed</p></li>
<li><p>Detection is a function of distance: the encounter probability declines as a function of distance from an individual’s activity center</p></li>
<li><p>Independence of encounters among individuals</p></li>
<li><p>Independence of encounters of the same individual</p></li>
</ol>
</div>
<div id="secr-models" class="section level2">
<h2>SECR Models:</h2>
<p>SECR models are a combination of <strong><em>state</em></strong> and <strong><em>observation</em></strong> models</p>
<ul>
<li><p><strong><em>observation model</em></strong>: spatially explicit model for encounter history data</p>
<ul>
<li><p>Elements of SECR data collection:</p>
<ul>
<li><p><span class="math inline">\(i\)</span> individuals</p></li>
<li><p><span class="math inline">\(j\)</span> traps</p></li>
<li><p><span class="math inline">\(k\)</span> occasions</p></li>
</ul></li>
</ul></li>
<li><p><strong><em>state model</em></strong>: spatially explicit model for the distribution of individuals (<span class="math inline">\(s\)</span>: activity centers!)</p>
<ul>
<li>Point process: SECR requires us to describe the possible location of activity centers, <span class="math inline">\(s\)</span>. Since these are unknown, we assign a prior distribution (typically uniform)</li>
</ul></li>
</ul>
<p><strong>Choosing a prior distribution for <span class="math inline">\(s\)</span>:</strong></p>
<ul>
<li><p><strong>Homogenous point process (HPP):</strong> activity centers are distributed independent of one another and uniformly in the plane</p></li>
<li><p><strong>Inhomogenous point process (IPP):</strong> local point density depends on habitat covariates</p></li>
</ul>
<p><img src="pointprocess.JPG" /></p>
<p><img src="heatmap.JPG" /></p>
<p float="left">
<img src="activitycenter.jpg" style="border: 1px solid black" width="400"/><img src="g0andsigma.JPG" style="border: 1px solid black" width="400"/>
</p>
</div>
<div id="basic-secr-model" class="section level2">
<h2><strong>Basic SECR model:</strong></h2>
<p>Capture probability is a function of the distance between the activity center, <span class="math inline">\(s_{i}\)</span> and the traps, <span class="math inline">\(x_{j}\)</span> <span class="math display">\[
y_{ijk}|s_{i}\sim Bernoulli(p||x_{j}-s_{i}||)
\]</span></p>
<p>Activity centers are uniformly distributed (in the 2D plane) <span class="math display">\[
s_{i}\sim Uniform(S)
\]</span></p>
</div>
<div id="working-with-secr-data" class="section level2">
<h2>Working with SECR data</h2>
<p>A simple example!</p>
<p>Snowshoe hare capture by Burham and Cushwa:</p>
<ul>
<li><p>Live trapping grid north of Fairbanks, AK in 1972</p></li>
<li><p>10 x 10 grid with traps placed 200 ft (61m) apart</p></li>
<li><p>Traps were set for 9 consecutive days in early winter. They were baited after the 3rd day so this example dismisses the first 3 days</p></li>
</ul>
<p><img src="hare.JPG" /></p>
<pre class="r"><code>library(secr)</code></pre>
<pre><code>## Warning: package &#39;secr&#39; was built under R version 4.1.1</code></pre>
<p>Primary data:</p>
<ol style="list-style-type: decimal">
<li><p>Encounter data, containing a record of which animals were encountered at which trap and on what occasion</p></li>
<li><p>Trap deployment data, containing the spatial coordinates of each trap</p></li>
</ol>
<pre class="r"><code>capture.history&lt;-read.table(&quot;hareCH6capt.txt&quot;,col.names = c(&quot;Session&quot;,&quot;ID&quot;,&quot;Occasion&quot;,&quot;Detector&quot;))
head(capture.history)</code></pre>
<pre><code>##             Session ID Occasion Detector
## 1 wickershamunburne  1        2      201
## 2 wickershamunburne 19        1      501
## 3 wickershamunburne 72        5      601
## 4 wickershamunburne 73        6      601
## 5 wickershamunburne  2        2      701
## 6 wickershamunburne 60        3      701</code></pre>
<pre class="r"><code>trap.data&lt;-read.table(&quot;hareCH6trap.txt&quot;,col.names = c(&quot;Detector&quot;,&quot;x&quot;,&quot;y&quot;))
head(trap.data) ##note that the x,y information is given in meter distances, do NOT use latitude/longitude</code></pre>
<pre><code>##   Detector      x y
## 1      101   0.00 0
## 2      201  60.96 0
## 3      301 121.92 0
## 4      401 182.88 0
## 5      501 243.84 0
## 6      601 304.80 0</code></pre>
<p>Create a capture history object to work with (<em>observation model</em>)</p>
<pre class="r"><code>hare.secr&lt;-read.capthist(&quot;hareCH6capt.txt&quot;,&quot;hareCH6trap.txt&quot;,detector = &quot;single&quot;)</code></pre>
<pre><code>## No errors found :-)</code></pre>
<p>Let’s take a look at the object!</p>
<pre class="r"><code>summary(hare.secr)</code></pre>
<pre><code>## Object class       capthist 
## Detector type      single 
## Detector number    100 
## Average spacing    60.96 m 
## x-range            0 548.64 m 
## y-range            0 548.64 m 
## 
## Counts by occasion 
##                     1   2   3   4   5   6 Total
## n                  16  28  20  26  23  32   145
## u                  16  24   9   9   6   4    68
## f                  25  22  13   5   1   2    68
## M(t+1)             16  40  49  58  64  68    68
## losses              0   0   0   0   0   0     0
## detections         16  28  20  26  23  32   145
## detectors visited  16  28  20  26  23  32   145
## detectors used    100 100 100 100 100 100   600</code></pre>
<pre class="r"><code>plot(hare.secr, tracks = TRUE) </code></pre>
<p><img src="SCR_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>We can look at a histogram of successive movements</p>
<pre class="r"><code>movements &lt;- unlist(moves(hare.secr))</code></pre>
<pre class="r"><code>hist(movements, breaks = seq(-61/2, 500,61), xlab = &quot;Movement&quot;, main = &quot;&quot;) #another illustration that majority of movements are within 100m</code></pre>
<p><img src="SCR_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>Next, secr can give us a quick and biased estimate of sigma, ignoring the issue of movements being truncated by the edge of the grid</p>
<pre class="r"><code>initialsigma &lt;- RPSV(hare.secr, CC = TRUE)
cat(&quot;Quick and biased estimate of sigma =&quot;, initialsigma, &quot;m\n&quot;) #our spatial scale parameter that determines how rapidly capture probability declines with distance AKA our state model </code></pre>
<pre><code>## Quick and biased estimate of sigma = 63.66117 m</code></pre>
<p>Now we can fit a VERY simple SECR model!</p>
<pre class="r"><code>fit &lt;- secr.fit (hare.secr, buffer = 4 * initialsigma, trace = FALSE) </code></pre>
<p><img src="bufferexample.jpg" /></p>
<pre class="r"><code>esa.plot(fit)
abline(v = 4 * initialsigma, lty = 2, col = &#39;red&#39;)    </code></pre>
<p><img src="SCR_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<pre class="r"><code>#The theory of SECR tells us that buffer width is not critical as long as it is wide enough that animals with activity centers close to the edge of the buffer have effectively zero chance of appearing in our sample. 

#We can check this with the function esa.plot and see that the estimated density has easily reached a plateau at the chosen buffer width (dashed red line)</code></pre>
<pre class="r"><code>print(fit)</code></pre>
<pre><code>## 
## secr.fit(capthist = hare.secr, buffer = 4 * initialsigma, trace = FALSE)
## secr 4.4.7, 10:55:17 10 Nov 2021
## 
## Detector type      single 
## Detector number    100 
## Average spacing    60.96 m 
## x-range            0 548.64 m 
## y-range            0 548.64 m 
## 
## N animals       :  68  
## N detections    :  145 
## N occasions     :  6 
## Mask area       :  106.1286 ha 
## 
## Model           :  D~1 g0~1 sigma~1 
## Fixed (real)    :  none 
## Detection fn    :  halfnormal
## Distribution    :  poisson 
## N parameters    :  3 
## Log likelihood  :  -607.9883 
## AIC             :  1221.977 
## AICc            :  1222.352 
## 
## Beta parameters (coefficients) 
##            beta    SE.beta        lcl        ucl
## D      0.382512 0.12995433  0.1278062  0.6372178
## g0    -2.723728 0.16091321 -3.0391117 -2.4083435
## sigma  4.224543 0.06530755  4.0965429  4.3525438
## 
## Variance-covariance matrix of beta parameters 
##                  D           g0        sigma
## D      0.016888127 -0.001729427 -0.001624203
## g0    -0.001729427  0.025893061 -0.007372130
## sigma -0.001624203 -0.007372130  0.004265076
## 
## Fitted (real) parameters evaluated at base levels of covariates 
##        link    estimate SE.estimate         lcl         ucl
## D       log  1.46596251 0.191315338  1.13633280  1.89121188
## g0    logit  0.06158768 0.009299921  0.04568989  0.08253867
## sigma   log 68.34328742 4.468096141 60.13204534 77.67580347</code></pre>
<pre class="r"><code>#The printed report gives us the following useful information:
#      function call and time stamp
#      summary of the data
#      model description (with log likelihood and AIC)
#      estimates of the coefficients
#      estimates of covariance matrix of coefficients
#      estimates of the real parameters</code></pre>
<p>Estimated density is 1.47 hares per hectare, 95% CI between 1.14-1.89. The detection function is jointly determined by <span class="math inline">\(g_{0}\)</span>, the intercept of the detection probability, and <span class="math inline">\(\sigma\)</span>, the spatial scale.</p>
<pre class="r"><code>plot(fit, limits = TRUE) </code></pre>
<p><img src="SCR_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p><strong>Now we can add a detection function to the model!</strong></p>
<ul>
<li><p>There are 20 detection functions included in the package, some are used only for acoustic data, some do not decline monotonically, etc.</p></li>
<li><p>Let’s look at half-normal and negative exponential</p></li>
</ul>
<p><img src="NEvHN.png" /></p>
<pre class="r"><code>fit.halfnormal &lt;- secr.fit (hare.secr, buffer = 4 * initialsigma, detectfn = &#39;HN&#39;, trace = FALSE)
fit.negative.exponential &lt;- secr.fit (hare.secr, buffer = 4 * initialsigma, detectfn = &#39;EX&#39;, trace = FALSE)
fits &lt;- secrlist(HN = fit.halfnormal, EX = fit.negative.exponential)#compare the models
predict(fits)</code></pre>
<pre><code>## $HN
##        link    estimate SE.estimate         lcl         ucl
## D       log  1.46596243 0.191315356  1.13633269  1.89121184
## g0    logit  0.06158769 0.009299908  0.04568991  0.08253865
## sigma   log 68.34328831 4.468093572 60.13205063 77.67579865
## 
## $EX
##        link   estimate SE.estimate        lcl        ucl
## D       log  1.4795947  0.19470072  1.1444928  1.9128128
## g0    logit  0.1805312  0.03154027  0.1266829  0.2506977
## sigma   log 39.9017318  3.33367368 33.8844127 46.9876287</code></pre>
<pre class="r"><code>AIC(fits)</code></pre>
<pre><code>##               model    detectfn npar    logLik      AIC     AICc dAICc AICcwt
## EX D~1 g0~1 sigma~1 exponential    3 -601.6335 1209.267 1209.642  0.00      1
## HN D~1 g0~1 sigma~1  halfnormal    3 -607.9883 1221.977 1222.352 12.71      0</code></pre>
<p><strong>How can we make the model more accurately reflect our population?</strong> There are “model” arguments within the secr.fit function to account for learned responses, spatial variation, group trends, etc:</p>
<p><img src="modelarguments.JPG" /></p>
</div>
<div id="another-example-this-time-with-horned-lizards" class="section level2">
<h2>Another example, this time with horned lizards!</h2>
<p>In this example we look at polygon and transect detectors</p>
<pre class="r"><code>library(gstat)
lizard&lt;-hornedlizardCH
head(lizard)</code></pre>
<pre><code>## Session =  1 
## , , 1
## 
##   1 2 3 4 5 6 7 8 9 10 11 12 13 14
## 1 0 0 0 0 0 0 0 1 0  0  0  0  0  0
## 2 0 0 0 0 0 0 0 1 0  0  0  0  0  0
## 3 0 0 0 0 0 0 0 1 0  0  0  0  0  0
## 4 0 0 0 0 0 0 0 1 0  0  0  0  0  0
## 5 0 0 0 0 0 0 0 0 0  0  0  0  1  0
## 6 0 0 0 0 0 0 0 0 0  0  0  0  1  0</code></pre>
<pre class="r"><code>par(mar=c(1,1,2,1))
plot(hornedlizardCH, tracks = TRUE, varycol = FALSE, lab1cap = TRUE, laboffset = 8,
     border = 10, title =&#39;&#39;)</code></pre>
<p><img src="SCR_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>Fit and plot a basic model:</p>
<pre class="r"><code>FTHL.fit &lt;- secr.fit(hornedlizardCH, buffer = 80, trace = FALSE)
predict(FTHL.fit)</code></pre>
<pre><code>##         link   estimate SE.estimate        lcl        ucl
## D        log  8.0130680  1.06170100  6.1873999 10.3774218
## lambda0  log  0.1317132  0.01512831  0.1052403  0.1648453
## sigma    log 18.5049025  1.19938839 16.2995006 21.0087060</code></pre>
<pre class="r"><code>plot(FTHL.fit, xv = 0:80, xlab = &quot;Distance (m)&quot;, ylab = &#39;p&#39;, main=&quot;Probability of detection&quot;)</code></pre>
<p><img src="SCR_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>Cue data for animals with 1 occasion :</p>
<pre class="r"><code>datadir &lt;- system.file(&quot;extdata&quot;, package = &quot;secr&quot;)
examplefile1 &lt;- paste0(datadir, &#39;/polygonexample1.txt&#39;)
polyexample1 &lt;- read.traps(file = examplefile1, detector = &#39;polygon&#39;)
polygonCH &lt;- sim.capthist(polyexample1, popn = list(D = 1, buffer = 200),
                          detectfn = &#39;HHN&#39;, detectpar = list(lambda0 = 5, sigma = 50),
                          noccasions = 1, seed = 123)
par(mar = c(1,2,3,2))
plot(polygonCH, tracks = TRUE, varycol = FALSE, lab1cap = TRUE, laboffset = 15,
     title = paste(&quot;Simulated &#39;polygon&#39; data&quot;, &quot;D = 1, lambda0 = 5, sigma = 50&quot;))</code></pre>
<p><img src="SCR_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<pre class="r"><code>#cuesim.fit &lt;- secr.fit(polygonCH, buffer = 200, trace = FALSE) #Takes a long time to run! 
#predict(cuesim.fit)</code></pre>
<p><img src="cuesim.fit.png" /></p>
<p>Convert the polygon data into raster representation</p>
<pre class="r"><code>discreteCH &lt;- discretize (polygonCH, spacing = 20)</code></pre>
<pre><code>## Warning: count data converted to binary; information may be lost</code></pre>
<pre class="r"><code>par(mar = c(1,2,3,2))
plot(discreteCH, varycol = FALSE, tracks = TRUE)</code></pre>
<pre><code>## Warning in plot.capthist(discreteCH, varycol = FALSE, tracks = TRUE): track for
## repeat detections on same occasion joins points in arbitrary sequence</code></pre>
<p><img src="SCR_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<pre class="r"><code>discrete.fit &lt;- secr.fit(discreteCH, buffer = 200, detectfn = &#39;HHN&#39;, trace = FALSE)</code></pre>
<pre><code>## Warning in dpois(data$nc, N * meanpdot, log = TRUE): NaNs produced</code></pre>
<pre class="r"><code>predict(discrete.fit)</code></pre>
<pre><code>##         link   estimate SE.estimate         lcl        ucl
## D        log  1.0953488  0.15276747  0.83446347  1.4377970
## lambda0  log  0.1120451  0.01449157  0.08704767  0.1442209
## sigma    log 49.8385750  2.67401656 44.86714624 55.3608547</code></pre>
<p>Polygon concavity:</p>
<p><img src="polygon.png" /></p>
<pre class="r"><code>examplefile2 &lt;- paste0(datadir, &#39;/polygonexample2.txt&#39;) #this txt file is within secr package
polyexample2 &lt;- read.traps(file = examplefile2, detector = &#39;polygon&#39;)
par(mfrow = c(1,2), mar = c(2,1,1,1))
plot(polyexample2)
text(polyexample2$x, polyexample2$y, 1:nrow(polyexample2), cex = 0.7)
newpoly &lt;- make.poly (list(p1 = polyexample2[11:23,],
                           p2 = polyexample2[c(1:11, 23:27),]))</code></pre>
<pre><code>## No errors found :-)</code></pre>
<pre class="r"><code>plot(newpoly, label = TRUE)</code></pre>
<p><img src="SCR_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p><strong>A taste of what is to come: our group project will be taking NDOW’s 20+ year dataset of CR and (hopefully!) applying it to a SECR framework.</strong></p>
<p><img src="lola.JPG" /></p>
<p>Nevada’s bear population is has a wide estimate (400-700 bears). Our CR model says 452 bears as of 2018 within a designated study area. We have 452 bears “in the study area” but beyond those boundaries there are more. So we may have up to 700 bears. Not a very confident-sounding statement for an animal that is highly politicized and the public is constantly asking for scientific data to back up management.</p>
<p><strong><em>References:</em></strong></p>
<p><em>Efford, M.G. (2010). SECR: spatially explicit capture-recapture in R. Dunedin: Department of Zoology, University of Otago.</em></p>
<p><em>Efford, M.G. (2019). A tutorial on fitting spatially explicit capture-recapture models in secr. Dunedin: Department of Zoology, University of Otago.</em></p>
<p><em>Efford, M.G. (2021). Polygon and transect detectors in secr 4.4. Dunedin: Department of Zoology, University of Otago.</em></p>
<p><em>Otis, D.L, Burnham, K.P., White, G.C., and Anderson, D.R. (1978) Statistical inference from capture data on closed animal populations. Wildlife Monographs No. 62.</em></p>
<p><em>Royle, A.J. Andrew. et al. Spatial Capture-Recapture. Boston: Elsevier, 2013. Print.</em></p>
<p><em>Royle, A.J. (2016) Spatial Capture-Recapture Modeling.</em> <a href="https://www.youtube.com/watch?v=4HKFimATq9E&amp;t=1s" class="uri">https://www.youtube.com/watch?v=4HKFimATq9E&amp;t=1s</a></p>
<p><em>Royle, A.J. (2020) Introduction to Spatial Capture-Recapture.</em> <a href="https://www.youtube.com/watch?v=yRRDi07FtPg" class="uri">https://www.youtube.com/watch?v=yRRDi07FtPg</a></p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
