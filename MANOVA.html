<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Maria Sole Bonarota, Mona Farnisa, Ranae Zauner" />


<title>ANOVA/MANOVA</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">NRES 746</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Schedule
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="schedule.html">Course Schedule</a>
    </li>
    <li>
      <a href="Syllabus.pdf">Syllabus</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="INTRO.html">Introduction to NRES 746</a>
    </li>
    <li>
      <a href="LECTURE1.html">Why focus on algorithms?</a>
    </li>
    <li>
      <a href="LECTURE2.html">Working with probabilities</a>
    </li>
    <li>
      <a href="LECTURE3.html">The Virtual Ecologist</a>
    </li>
    <li>
      <a href="LECTURE4.html">Likelihood</a>
    </li>
    <li>
      <a href="LECTURE5.html">Optimization</a>
    </li>
    <li>
      <a href="LECTURE6.html">Bayesian #1: concepts</a>
    </li>
    <li>
      <a href="LECTURE7.html">Bayesian #2: mcmc</a>
    </li>
    <li>
      <a href="LECTURE8.html">Model Selection</a>
    </li>
    <li>
      <a href="LECTURE9.html">Performance Evaluation</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Lab exercises
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="LAB_Instructions.html">Instructions for Labs</a>
    </li>
    <li>
      <a href="FINALPROJ.html">Final project overview</a>
    </li>
    <li>
      <a href="LAB3demo.html">Lab 3: Likelihood (intro)</a>
    </li>
    <li>
      <a href="LAB5.html">Lab 5: Model selection (optional)</a>
    </li>
    <li>
      <a href="FigureDemo.html">Demo: Figures in R</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Student-led topics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="LECTURE10.html">Machine Learning</a>
    </li>
    <li>
      <a href="TimeSeries_all.html">Time Series</a>
    </li>
    <li>
      <a href="SCR.html">Spatial Capture-Recapture</a>
    </li>
    <li>
      <a href="spatial_autocorrelation.html">Spatial Autocorrelation</a>
    </li>
    <li>
      <a href="MANOVA.html">MANOVA</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Data sets
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="TreeData.csv">Tree Data</a>
    </li>
    <li>
      <a href="ReedfrogPred.csv">Reed Frog Predation Data</a>
    </li>
    <li>
      <a href="ReedfrogFuncresp.csv">Reed Frog Func Resp</a>
    </li>
  </ul>
</li>
<li>
  <a href="Links.html">Links</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">ANOVA/MANOVA</h1>
<h4 class="author">Maria Sole Bonarota, Mona Farnisa, Ranae Zauner</h4>
<h4 class="date">Fall 2021</h4>

</div>


<div id="manova" class="section level1">
<h1>MANOVA</h1>
<p>Here is the download link for the R script for this lecture: <a href="MANOVA.R">MANOVA script</a></p>
<div id="overview" class="section level2">
<h2>Overview</h2>
<ol style="list-style-type: decimal">
<li>Introduction (Sole)
<ul>
<li>ANOVA vs. MANOVA</li>
<li>Assumptions of MANOVA</li>
<li>Theory of ANOVA (Sum of Squares)</li>
<li>Theory of MANOVA (Sum of Squares and Cross Product Matrices)</li>
<li>One-way vs. Factorial</li>
</ul></li>
<li>Demo 1 – One-way MANOVA (Mona)</li>
<li>Demo 2 – Factorial MANOVA (Ranae)</li>
</ol>
</div>
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>MANOVA is an extension of ANOVA and assesses the effects of one or multiple groups on multiple dependent variables. ANOVA is widely used in life science and it allows us to determine whether the means between three or more groups are statistically different. ANOVA is the statistical analysis that we should use when we want to test a particular hypothesis, such as how different groups respond to a certain effect.</p>
<p>One-way ANOVA compares the effects of one group on one dependent variable, while Two-way and Factorial ANOVA compare the effects of two and more groups and their interaction terms on one dependent variable.</p>
<p><strong>What is the purpose of ANOVA?</strong> To determine whether the group variable(s) can affect the outcome variable.</p>
<pre class="r"><code>library(heplots)</code></pre>
<pre><code>## Warning: package &#39;heplots&#39; was built under R version 4.1.1</code></pre>
<pre><code>## Loading required package: car</code></pre>
<pre><code>## Loading required package: carData</code></pre>
<pre class="r"><code>data(RootStock) # Dataset from an experiment comparing apple trees from from six different root stocks from 1918-1934. 

str(RootStock)</code></pre>
<pre><code>## &#39;data.frame&#39;:    48 obs. of  5 variables:
##  $ rootstock: Factor w/ 6 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 1 1 1 1 1 1 1 1 2 2 ...
##  $ girth4   : num  1.11 1.19 1.09 1.25 1.11 1.08 1.11 1.16 1.05 1.17 ...
##  $ ext4     : num  2.57 2.93 2.87 3.84 3.03 ...
##  $ girth15  : num  3.58 3.75 3.93 3.94 3.6 3.51 3.98 3.62 4.09 4.06 ...
##  $ weight15 : num  0.76 0.821 0.928 1.009 0.766 ...</code></pre>
<p><img src="MANOVA_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p><em>Figure 1: Histogram variable RootStock$weight15 illustrating bell curves for trees from each root stock.</em></p>
<ul>
<li>Examples of using one-way ANOVA in plant science:
<ul>
<li>Does tree species affect the survival to fire disturbance?</li>
<li>Does crop variety affect the final yield?</li>
<li>Does the soil type affect root development?</li>
<li>Does irrigation scheduling affect fruit weight?</li>
</ul></li>
<li>Examples of using two-way ANOVA in plant science:
<ul>
<li>Do tree species and fire duration affect the survival to fire disturbance?</li>
<li>Do variety and water regime affect crop yield?</li>
<li>Do soil type and microbiome affect root development?</li>
<li>Do irrigation scheduling and water quality affect fruit weight?</li>
</ul></li>
<li>Examples of using factorial ANOVA in plant science:
<ul>
<li>Do tree species, tree age, and fire duration affect the survival to fire disturbance?</li>
<li>Do variety, air temperature, and water regime affect crop yield?</li>
<li>Do soil type, soil temperature, and microbiome affect root development?</li>
<li>Do irrigation scheduling, irrigation type, and water quality affect fruit weight?</li>
</ul></li>
</ul>
<p>However, ANOVA can only assess one dependent variable at a time. This can be a problem because it can prevent the researcher from detecting effects and interaction terms that might actually exist.</p>
<p>MANOVA allows us to test multiple dependent variables at a time, providing a solution to this limitation from ANOVA. So, while in ANOVA we compare the means of more than two groups, in MANOVA we compare vectors of means between more than two groups (see Table 1).</p>
<p><img src="UniVsMulti.PNG" /></p>
<p><em>Table 1: A table comparing differences between univariate and multivariate ANOVA.</em></p>
<ul>
<li><strong>Advantages of using MANOVA are:</strong>
<ul>
<li>Assess the influence of independent variables on the relationships between dependent variables;</li>
<li>Limits the joint error rate, meaning that when performing multiple ANOVAs on each dependent variable, the joint probability of rejecting a true null hypothesis (Type I error) increases with each additional test. When using MANOVA the error rate equals the significance level.</li>
</ul></li>
</ul>
</div>
<div id="data-assumptions" class="section level2">
<h2>Data assumptions</h2>
<ul>
<li>As in ANOVA, data have to meet the following assumptions in MANOVA:
<ul>
<li><p><strong><em>Independent observations:</em></strong> MANOVA assumes that each observation is randomly and independently sampled from the population. This assumption is met when the probability sampling method is used to collect data. Examples of probability sampling methods are: simple, stratified, clustered or systematic random sampling.</p></li>
<li><p><strong><em>Multivariate normality for each group under comparison:</em></strong> this assumption is met when &gt;20 observation per each factor*outcome variable are collected (Multivariate Central Limit Theorem). If the sample number is &lt;20, we have to check the normality of the residuals of the data for each outcome variable. However, MANOVA is robust against slight violations of this assumption.</p></li>
<li><p><strong><em>Equal variance and covariance matrices between groups:</em></strong> the most common way to check for this assumption is using Box’s M test. We usually use a significance level of 0.001 to determine whether or not the population covariance matrices are equal. If the p-value is higher than 0.001, the assumption is met. MANOVA is robust against slight variation of this assumption.</p></li>
<li><p><strong><em>No multivariate outliers:</em></strong> calculate Mahalanobis distance can be for each observation, which represents the distance between two points in a multivariate space. Is the p-value associated with the Mahalanobis distance for one observation is less than 0.001, we declare that that observation is an outlier.</p></li>
</ul></li>
</ul>
</div>
<div id="how-does-it-work" class="section level2">
<h2>How does it work?</h2>
<p>To understand how MANOVA assesses differences between groups, we will start by explaining how ANOVA works. ANOVA works by dividing the total deviation for each observation (observed value / overall mean) into the between groups deviation (group mean – overall mean) and the within groups deviation (also called error deviation, observed value – group mean). If these two are equal, the group means are equal. If they differ, the group means are not equal (see Figure 2).</p>
<p><img src="MANOVA_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p><em>Figure 2: Histogram for tree weights illustrating mean differences for trees from root stock 1 and root stock 2.</em></p>
<p><img src="MANOVA_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p><em>Figure 3: A boxplot showing total deviation, error deviation, and group deviation of tree weight.</em></p>
<p><img src="ANOVAtable.PNG" /></p>
<p><em>Table 2: A table showing calculations for an ANOVA table.</em></p>
<p>The F-value is calculated as variation between sample means and variation within samples. To calculate the p-value associate with the F-statistics, we use the F Distribution Calculator (<a href="https://www.statology.org/f-distribution-calculator/">F Distribution Calculator - Statology</a>).</p>
<p>The F distribution has two parameters, which can be called “degrees of freedom 1 and 2” or “degrees of freedom numerator and denominator”. The F table (<a href="f-table.com">F Table - F distribution table</a>) shows the F statistics correspondent to the cutoff threshold, below which we fail to reject the null hypothesis, and above which we can reject the null hypothesis.</p>
<p>The P-value associate with an F-value represents the area of the F distribution after the F-value. The higher the F-value, the more variance is explained by groups rather than by error deviation and the lower the p-value will be. If the p-value is lower than the cutoff threshold we set (alpha value), then we are able to reject the null hypothesis.</p>
<p><img src="MANOVA_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p><em>Figure 4: Illustration of the F-distribution.</em></p>
</div>
<div id="anova-vs-manova---vectors" class="section level2">
<h2>ANOVA vs MANOVA - vectors!</h2>
<p>A key difference between ANOVA and MANOVA tests is in how Sum of Squares are calculated (called Sum of Squares and Cross Product Matrices in MANOVA). In short, MANOVA uses a vector of means for the response variables to calculate the Sum of Squares calculations instead of a single mean of one response variable in an ANOVA test.</p>
<p>In MANOVA, the sum of squares is calculated by multiplying vectors of means (one mean per outcome variable), which implies that the Sum of Squares are matrices.</p>
<p>Total sum of squares in MANOVA is called T, or “Sum of Squares and Cross Product Matrices”.</p>
<p>SSgroup is called H, or “Hypothesis Sum of Squares and Cross Product Matrices”.</p>
<p>SSerror is called E, or “Error Sum of Squares and Cross Product Matrices”.</p>
<div id="manova-test-statistics" class="section level3">
<h3>MANOVA test statistics</h3>
<p>Because we are now working with matrices and not single values, we have to group response variables differently. We can do this by calculating 4 statistics which convert matrices into a scalar value.The significance of effects in MANOVA can be tested using the following test statistics:</p>
<div id="wilks-lambda" class="section level4">
<h4>Wilk’s lambda:</h4>
<p>Wilks Lambda is the ratio of the determinant of the error sums of squares and cross products matrix E to the determinant of the total sum of squares and cross products matrix T= H + E. That is:</p>
<p><img src="wilks.png" /></p>
<p>The null hypothesis of equality of treatment mean vectors is rejected if the ratio of generalized variance (Wilk’s lambda statistic) Λ* is too small (i.e. H is large relative to E). In short, This statistic represents the proportion of variation NOT explained by the model.</p>
<p>The Wilk’s lambda test is considered between liberal and conservative. Wilk’s lambda is often used as the default test statistic.</p>
</div>
<div id="pillais-trace" class="section level4">
<h4>Pillai’s Trace:</h4>
<p>Pillai’s trace is formulated by multiplying H by the inverse of the total sum of squares and cross products matrix T = H + E. Large value of the test statistics means H is relatively large to E, which leads to the rejection of the null hypothesis.</p>
<p><img src="Pillai.png" /></p>
<p>This test statistic is considered to be very robust and has a greater tolerance for non-normal data. Type II errors are more likely with Pillai’s Trace. When assumptions are violated and cannot be remedied or the experimental design is unbalanced, Pillai’s trace can be used.</p>
</div>
<div id="hotelling-lawley-trace" class="section level4">
<h4>Hotelling-Lawley trace:</h4>
<p>The inverse of E is multiplied by H (sum of squares and sum of cross product matrices of treatments) and the trace of the resultant matrix is taken. For Larger H in comparison to E, means large value of the test statistics, large value of Hotelling-Lawley trace, leads to the rejection of the null hypothesis.</p>
<p><img src="Hotelling.png" /></p>
<p>Hotelling-Lawley trace is analogous to an F-test and is equivalent to Hotelling’s T-squared divided by the differences between number of groups and sample size. It is considered a liberal test, as Type I errors are more likely. It is generally used in a controlled experimental setting where MANOVA assumptions are met very well.</p>
</div>
<div id="roys-largest-root" class="section level4">
<h4>Roy’s Largest Root:</h4>
<p>H is multiplied by the inverse of E, and from the result and matrix the largest eigen value is obtained. Roy’s root will be large if H is substantially large compare to E, which leads to the rejection of the null hypothesis.</p>
<p>Also known as Roy’s largest eigenvalue, this statistic is most powerful in cases where one variable strongly distinguishes one group from all other groups. If all test statistics are significant, we can reject the null hypothesis and perform a post-hoc analysis to determine specific differences between groups.</p>
</div>
</div>
</div>
<div id="manova-examples-in-r" class="section level2">
<h2>MANOVA examples in R</h2>
<div id="one-way-manova-example-in-r" class="section level3">
<h3>One-Way MANOVA example in R</h3>
</div>
<div id="references" class="section level3">
<h3>References</h3>
<p>Data: Mona Farnisa. Hemp Phenotyping Study, 2021. University of Nevada, Reno.</p>
<p>Code: Tabachnick, Barbara, and Linda.S. Fidell. 2012. Using Multivarite Statistics. 6th ed. Pearson.</p>
</div>
</div>
</div>
<div id="packages" class="section level1">
<h1>Packages</h1>
<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## -- Attaching packages --------------------------------------- tidyverse 1.3.1 --</code></pre>
<pre><code>## v ggplot2 3.3.5     v purrr   0.3.4
## v tibble  3.1.3     v dplyr   1.0.7
## v tidyr   1.1.3     v stringr 1.4.0
## v readr   2.0.0     v forcats 0.5.1</code></pre>
<pre><code>## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()
## x dplyr::recode() masks car::recode()
## x purrr::some()   masks car::some()</code></pre>
<pre class="r"><code>library(tibble)
library(ggpubr)</code></pre>
<pre><code>## Warning: package &#39;ggpubr&#39; was built under R version 4.1.1</code></pre>
<pre class="r"><code>library(rstatix)</code></pre>
<pre><code>## 
## Attaching package: &#39;rstatix&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     filter</code></pre>
<pre class="r"><code>library(car)
library(broom)
library(mvtnorm)
library(dplyr)
library(tidyr)
library(purrr)
library(psych)</code></pre>
<pre><code>## Warning: package &#39;psych&#39; was built under R version 4.1.1</code></pre>
<pre><code>## 
## Attaching package: &#39;psych&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:ggplot2&#39;:
## 
##     %+%, alpha</code></pre>
<pre><code>## The following object is masked from &#39;package:car&#39;:
## 
##     logit</code></pre>
<pre class="r"><code>library(magrittr)</code></pre>
<pre><code>## 
## Attaching package: &#39;magrittr&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     set_names</code></pre>
<pre><code>## The following object is masked from &#39;package:tidyr&#39;:
## 
##     extract</code></pre>
<pre class="r"><code># Load cleaned data

phenotype2.5 &lt;- read.csv(&quot;phenotype_data.csv&quot;)
phenotype2.5$X &lt;- NULL</code></pre>
<pre class="r"><code># Visualize dataset with boxplots
ggboxplot(phenotype2.5, x = &quot;Variety&quot;, y = c(&quot;Height_cm&quot;, &quot;True_Leaves&quot;), 
  merge = TRUE, palette = &quot;ggplot2&quot;)</code></pre>
<p><img src="MANOVA_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<pre class="r"><code># Get Summary Statistics
phenotype2.5 %&gt;%
  group_by(Variety) %&gt;%
  get_summary_stats(Height_cm, True_Leaves, type = &quot;mean_sd&quot;)</code></pre>
<pre><code>## # A tibble: 6 x 5
##   Variety          variable        n  mean    sd
##   &lt;chr&gt;            &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 &quot;Auto CBD&quot;       Height_cm      10  68.1 12.1 
## 2 &quot;Auto CBD&quot;       True_Leaves    10   7.3  3.06
## 3 &quot;Berry Blossom &quot; Height_cm      10 114.  16.8 
## 4 &quot;Berry Blossom &quot; True_Leaves    10  22.8  2.7 
## 5 &quot;Matterhorn CBG&quot; Height_cm      10 113.  35.5 
## 6 &quot;Matterhorn CBG&quot; True_Leaves    10  18.1  6.87</code></pre>
<div id="checking-assumptions" class="section level4">
<h4>Checking Assumptions</h4>
<p>Adequate sample size: the n in each cell &gt; the number of outcome variables.</p>
<p>Absense of univariate or multivariate outliers.</p>
<p>Multivariate normality.</p>
<p>Absence of multicollinearity.</p>
<p>Linearity between all outcome variables for each group.</p>
<p>Homogeneity of variances.</p>
<p>Homogeneity of variance-covariance matrices.</p>
</div>
<div id="check-sample-size-assumption" class="section level3">
<h3>Check sample size assumption</h3>
<pre class="r"><code># n in each group should be greater than number of outcome variables 
phenotype2.5 %&gt;%
  group_by(Variety) %&gt;%
  summarise(N = n())</code></pre>
<pre><code>## # A tibble: 3 x 2
##   Variety              N
##   &lt;chr&gt;            &lt;int&gt;
## 1 &quot;Auto CBD&quot;          10
## 2 &quot;Berry Blossom &quot;    10
## 3 &quot;Matterhorn CBG&quot;    10</code></pre>
</div>
<div id="identify-univariate-outliers" class="section level3">
<h3>Identify univariate outliers</h3>
<p>If outliers exist, they can be left in the data and compared in MANOVA result with and without outlier.</p>
<pre class="r"><code>phenotype2.5 %&gt;% 
  group_by(Variety) %&gt;%
  identify_outliers(Height_cm)</code></pre>
<pre><code>## [1] Variety     id          Height_cm   True_Leaves is.outlier  is.extreme 
## &lt;0 rows&gt; (or 0-length row.names)</code></pre>
<pre class="r"><code># no outliers!

phenotype2.5 %&gt;% 
  group_by(Variety) %&gt;%
  identify_outliers(True_Leaves)</code></pre>
<pre><code>## # A tibble: 3 x 6
##   Variety             id Height_cm True_Leaves is.outlier is.extreme
##   &lt;chr&gt;            &lt;int&gt;     &lt;dbl&gt;       &lt;int&gt; &lt;lgl&gt;      &lt;lgl&gt;     
## 1 &quot;Auto CBD&quot;           6       57           14 TRUE       FALSE     
## 2 &quot;Berry Blossom &quot;    12      118           28 TRUE       FALSE     
## 3 &quot;Berry Blossom &quot;    17      106.          18 TRUE       FALSE</code></pre>
<pre class="r"><code># no outliers!</code></pre>
</div>
<div id="detect-multivariate-outliers-with-mahalnobis-distance" class="section level3">
<h3>Detect multivariate outliers with mahalnobis distance</h3>
<p>Returns the squared Mahalanobis distance of all rows in x</p>
<pre class="r"><code>phenotype2.5 %&gt;%
  group_by(Variety) %&gt;%
  mahalanobis_distance(-id) %&gt;%
  filter(is.outlier == TRUE) %&gt;%
  as.data.frame()</code></pre>
<pre><code>## [1] id          Height_cm   True_Leaves mahal.dist  is.outlier 
## &lt;0 rows&gt; (or 0-length row.names)</code></pre>
<pre class="r"><code># no outliers!</code></pre>
</div>
<div id="univariate-normality-assumption-with-shapiro-wilks-test" class="section level3">
<h3>Univariate normality assumption with shapiro-wilks test</h3>
<p>For sample sizer larger than 50, QQ-plots are recommended over Shapiro-Wilks, which becomes more sensitive to larger sample sizes</p>
<pre class="r"><code>phenotype2.5 %&gt;%
  group_by(Variety) %&gt;%
  shapiro_test(Height_cm, True_Leaves) %&gt;%
  arrange(variable)</code></pre>
<pre><code>## # A tibble: 6 x 4
##   Variety          variable    statistic      p
##   &lt;chr&gt;            &lt;chr&gt;           &lt;dbl&gt;  &lt;dbl&gt;
## 1 &quot;Auto CBD&quot;       Height_cm       0.961 0.796 
## 2 &quot;Berry Blossom &quot; Height_cm       0.951 0.684 
## 3 &quot;Matterhorn CBG&quot; Height_cm       0.893 0.184 
## 4 &quot;Auto CBD&quot;       True_Leaves     0.807 0.0177
## 5 &quot;Berry Blossom &quot; True_Leaves     0.929 0.440 
## 6 &quot;Matterhorn CBG&quot; True_Leaves     0.928 0.430</code></pre>
<pre class="r"><code># p-value &gt; 0.05, so data is normally distributed, except for Auto CBD-True Leaves. 
# However, MANOVA is fairly robust to deviations from normality so we will continue</code></pre>
</div>
<div id="test-multivariate-normality-assumption" class="section level3">
<h3>Test multivariate normality assumption</h3>
<p>mshapiro_test() in rstatix package can be used to perform the Shapiro-Wilk test for multivariate normality.</p>
<pre class="r"><code># phenotype2.5 %&gt;%
#   select(Height_cm, True_Leaves) %&gt;%
#   mshapiro_test()


mshapiro_test(phenotype2.5[,2:3])</code></pre>
<pre><code>## # A tibble: 1 x 2
##   statistic p.value
##       &lt;dbl&gt;   &lt;dbl&gt;
## 1     0.969   0.499</code></pre>
<pre class="r"><code># p-value greater than 0.05, assumption met!</code></pre>
</div>
<div id="check-multicolinearity-between-the-variables" class="section level3">
<h3>Check multicolinearity between the variables</h3>
<p>The dependent (outcome) variables cannot be too correlated to each other.</p>
<p>No correlation should be above r = 0.90 [Tabachnick and Fidell (2012)}.</p>
<p>Correlations that are too low can also be a problem</p>
<p>For more than 2 variables cor_mat() can be used</p>
<pre class="r"><code>phenotype2.5 %&gt;% cor_test(Height_cm, True_Leaves)</code></pre>
<pre><code>## # A tibble: 1 x 8
##   var1      var2          cor statistic      p conf.low conf.high method 
##   &lt;chr&gt;     &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;  
## 1 Height_cm True_Leaves  0.37      2.13 0.0421   0.0151     0.647 Pearson</code></pre>
<pre class="r"><code># Pearson correlation = 0.37
# p-value &lt; 0.05, so no multicolinearity! </code></pre>
</div>
<div id="check-linearity-assumption" class="section level3">
<h3>Check linearity Assumption</h3>
<p>Create a ggplot lm scatterplot by group to visually assess linearity between variables among groups</p>
<p>MANOVAs are best conducted when the dependent variables used in the analysis are highly negatively correlated and are also acceptable if the dependent variables are found to be correlated around .60, either positive or negative.</p>
<pre class="r"><code>check.linearity &lt;- ggplot(phenotype2.5, aes(x=Height_cm, y=True_Leaves, color=Variety))+
  geom_point(size = 4)+
  theme_classic()+
  geom_smooth(method=lm, se=FALSE) + 
  ylab(&#39;True Leaves&#39; ) +
  xlab(&#39;Height (cm)&#39;) + 
  labs(color = &#39;Hemp Variety&#39;)  #rename legend title
check.linearity</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="MANOVA_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
</div>
<div id="check-homogeneity-of-covariances-with-boxs-m-test-in-rstatix-package" class="section level3">
<h3>Check homogeneity of covariances with Box’s M-test in rstatix package</h3>
<p>Box-M test is the equivalent of a multivariate homogeneity of variance.</p>
<p>This test is highly sensitive and significance for this test is determined at alpha = 0.001.</p>
<pre class="r"><code>box_m(phenotype2.5[, c(&quot;Height_cm&quot;, &quot;True_Leaves&quot;)], phenotype2.5$Variety)</code></pre>
<pre><code>## # A tibble: 1 x 4
##   statistic p.value parameter method                                            
##       &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;                                             
## 1      19.0 0.00424         6 Box&#39;s M-test for Homogeneity of Covariance Matric~</code></pre>
<pre class="r"><code># p-value &lt; 0.001, so assumption not met</code></pre>
<p>With a balanced design of groups with similar n, violating homogeneity of variances-covariances matrices is not a problem and analysis can be continued!</p>
<p>However, an unbalanced design will present problems.</p>
</div>
<div id="check-homogeneity-of-variance-assumption-with-levenes-test" class="section level3">
<h3>Check homogeneity of variance assumption with Levene’s test</h3>
<p>The Levene’s test can be used to test the equality of variances between groups.</p>
<p>Non-significant values of Levene’s test indicate equal variance between groups.</p>
<pre class="r"><code>phenotype2.5 %&gt;% 
  gather(key = &quot;variable&quot;, value = &quot;value&quot;, Height_cm, True_Leaves) %&gt;%
  group_by(variable) %&gt;%
  levene_test(value ~ Variety)</code></pre>
<pre><code>## Warning in leveneTest.default(y = y, group = group, ...): group coerced to
## factor.

## Warning in leveneTest.default(y = y, group = group, ...): group coerced to
## factor.</code></pre>
<pre><code>## # A tibble: 2 x 5
##   variable      df1   df2 statistic       p
##   &lt;chr&gt;       &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;   &lt;dbl&gt;
## 1 Height_cm       2    27      7.97 0.00190
## 2 True_Leaves     2    27      3.17 0.0581</code></pre>
<pre class="r"><code># p-value &lt; 0.05, so no homogeneity of variances!
# True Leaves p-value is 0.05, we will accept, but use Pillais test because it is robust against violations of assumptions</code></pre>
</div>
<div id="manova-1" class="section level3">
<h3>MANOVA</h3>
<p>4 test statistics to use (Pillai, Wilks, Hotelling-Lawley, Roy)</p>
<p>Pillai test is more robust against violations of assumptions and recommended for unbalanced design.</p>
<p>Wilk’s lambda is default in R</p>
<pre class="r"><code>model &lt;- lm(cbind(Height_cm, True_Leaves) ~ Variety, phenotype2.5)
Manova(model, test.statistic = &quot;Pillai&quot;)</code></pre>
<pre><code>## 
## Type II MANOVA Tests: Pillai test statistic
##         Df test stat approx F num Df den Df    Pr(&gt;F)    
## Variety  2   0.87714   10.546      4     54 2.186e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code># Statistically significant difference between Variety on the combined 
# dependent variables (Height and True Leaves), F(4, 54) = 10.546, p &lt; 0.0001.</code></pre>
</div>
<div id="post-hoc-tests-for-statistically-significant-manova" class="section level3">
<h3>Post-hoc tests for statistically significant MANOVA</h3>
<p>Do a one-way ANOVA for each dependent variable.</p>
<p>anova_test() when normality and homogeneity of variances is met</p>
<p>welch_anova_test() when homogeneity of variance is violated</p>
<p>kruskal_test() non-parametric alternative</p>
<pre class="r"><code>grouped.data &lt;- phenotype2.5 %&gt;%
  gather(key = &quot;variable&quot;, value = &quot;value&quot;, Height_cm, True_Leaves) %&gt;%
  group_by(variable)
grouped.data %&gt;% welch_anova_test(value ~ Variety)</code></pre>
<pre><code>## # A tibble: 2 x 8
##   variable    .y.       n statistic   DFn   DFd             p method     
## * &lt;chr&gt;       &lt;chr&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;         &lt;dbl&gt; &lt;chr&gt;      
## 1 Height_cm   value    30      27.2     2  16.2 0.00000662    Welch ANOVA
## 2 True_Leaves value    30      69.9     2  16.7 0.00000000766 Welch ANOVA</code></pre>
<pre class="r"><code># Statistically significant univariate welch_anova difference in Height (F(2, 16.2) = 27.2, p &lt; 0.0001)
# and True Leaves (F(2, 16.7) = 69.9, p &lt; 0.0001 ) between hemp varieties. </code></pre>
</div>
<div id="compute-multiple-pairwise-comparisons-to-determine-which-groups-are-different" class="section level3">
<h3>Compute multiple pairwise comparisons to determine which groups are different</h3>
<p>If homogeneity of variance assumption is met use tukey_hsd()</p>
<p>If assumption of homogeneity of variance violated use Games-Howell post-hoc test.</p>
<pre class="r"><code>pwc &lt;- phenotype2.5 %&gt;%
  gather(key = &quot;variables&quot;, value = &quot;value&quot;, Height_cm, True_Leaves) %&gt;%
  group_by(variables) %&gt;%
  games_howell_test(value ~ Variety) %&gt;%
  select(-estimate, -conf.low, -conf.high) # Remove details
pwc</code></pre>
<pre class="r"><code>pwc_alt_code &lt;- phenotype2.5 %&gt;%
  gather(key = &quot;variables&quot;, value = &quot;value&quot;, Height_cm, True_Leaves) %&gt;%
  group_by(variables) %&gt;%
  games_howell_test(value ~ Variety) # %&gt;%
  # select(-estimate, -conf.low, -conf.high) # Remove details
pwc_alt_code$estimate &lt;- NULL
pwc_alt_code$conf.low &lt;- NULL
pwc_alt_code$conf.high &lt;- NULL
pwc_alt_code</code></pre>
<pre><code>## # A tibble: 6 x 6
##   variables   .y.   group1           group2                   p.adj p.adj.signif
##   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;            &lt;chr&gt;                    &lt;dbl&gt; &lt;chr&gt;       
## 1 Height_cm   value &quot;Auto CBD&quot;       &quot;Berry Blossom &quot; 0.00000643    ****        
## 2 Height_cm   value &quot;Auto CBD&quot;       &quot;Matterhorn CBG&quot; 0.007         **          
## 3 Height_cm   value &quot;Berry Blossom &quot; &quot;Matterhorn CBG&quot; 0.996         ns          
## 4 True_Leaves value &quot;Auto CBD&quot;       &quot;Berry Blossom &quot; 0.00000000172 ****        
## 5 True_Leaves value &quot;Auto CBD&quot;       &quot;Matterhorn CBG&quot; 0.002         **          
## 6 True_Leaves value &quot;Berry Blossom &quot; &quot;Matterhorn CBG&quot; 0.152         ns</code></pre>
</div>
<div id="results" class="section level3">
<h3>Results</h3>
<pre class="r"><code># Visualize Results: box plots with p-values
pwc_alt_code &lt;- pwc_alt_code %&gt;% add_xy_position(x = &quot;Variety&quot;)
test.label &lt;- create_test_label(
  description = &quot;MANOVA&quot;, statistic.text = quote(italic(&quot;F&quot;)),
  statistic = 10.546, p= &quot;&lt;0.0001&quot;, parameter = &quot;4,54&quot;,
  type = &quot;expression&quot;, detailed = TRUE
)
ggboxplot(
  phenotype2.5, x = &quot;Variety&quot;, y = c(&quot;Height_cm&quot;, &quot;True_Leaves&quot;), 
  merge = TRUE, palette = &quot;ggplot2&quot;
) + 
  stat_pvalue_manual(
    pwc_alt_code, hide.ns = FALSE, tip.length = 0, 
    step.increase = 0.3, step.group.by = &quot;variables&quot;,
    color = &quot;variables&quot;
  ) +
  labs(
    subtitle = test.label,
    caption = get_pwc_label(pwc_alt_code, type = &quot;expression&quot;)
  )</code></pre>
<p><img src="MANOVA_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>A one-way MANOVA to determine effect of 3 different hemp varieties (Auto CBD, Berry Blossom, Matterhorn CBG) on Height and True Leaves.</p>
<p>A statistically significant difference between varieties on the combined dependent variables F(4, 54) = 10.546, p &lt; 0.0001.</p>
<p>Univariate ANOVAs, using a Bonferroni adjusted alpha level of 0.025, showed a statistically significant difference in Height (F(2, 16.2) = 27.2, p &lt; 0.0001) and True Leaves (F(2, 16.7) = 69.9, p &lt; 0.0001).</p>
<p>All pairwise comparisons between groups were significant except for Height and True Leaves between Berry Blossom and Matterhorn CBG using the Games-Howell pairwise comparison.</p>
</div>
<div id="factorial-manova-example-in-r" class="section level3">
<h3>Factorial MANOVA example in R</h3>
<p>A factorial MANOVA is used when a researcher wishes to investigate whether two or more grouping variables affect two or more outcome variables.</p>
<p>For this example, we will use the Soils dataset from the cars package. Details:</p>
<p>“Soil characteristics were measured on samples from three types of contours (Top, Slope, and Depression) and at four depths (0-10cm, 10-30cm, 30-60cm, and 60-90cm). The area was divided into 4 blocks, in a randomized block design.”</p>
<pre class="r"><code># load packages
library(&quot;car&quot;)
library(&quot;MASS&quot;)</code></pre>
<pre><code>## 
## Attaching package: &#39;MASS&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:rstatix&#39;:
## 
##     select</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     select</code></pre>
<pre class="r"><code>#Load the data
soils &lt;- Soils

# Make variables factors 
Contour &lt;- factor(soils$Contour)
Depth &lt;- factor(soils$Depth)

head(soils)</code></pre>
<pre><code>##   Group Contour Depth Gp Block   pH     N Dens   P    Ca   Mg    K   Na Conduc
## 1     1     Top  0-10 T0     1 5.40 0.188 0.92 215 16.35 7.65 0.72 1.14   1.09
## 2     1     Top  0-10 T0     2 5.65 0.165 1.04 208 12.25 5.15 0.71 0.94   1.35
## 3     1     Top  0-10 T0     3 5.14 0.260 0.95 300 13.02 5.68 0.68 0.60   1.41
## 4     1     Top  0-10 T0     4 5.14 0.169 1.10 248 11.92 7.88 1.09 1.01   1.64
## 5     2     Top 10-30 T1     1 5.14 0.164 1.12 174 14.17 8.12 0.70 2.17   1.85
## 6     2     Top 10-30 T1     2 5.10 0.094 1.22 129  8.55 6.92 0.81 2.67   3.18</code></pre>
<p>We will focus on three outcome variables (pH, Density, Conductivity) and two independent variables (contour (top, slope, and depression), depth (0-10 cm, 10-30 cm, 30-60cm, and 60-90 cm)). And test the following:</p>
<p><em>Null hypotheses being tested:</em></p>
<ol style="list-style-type: decimal">
<li><p>The joint mean of the outcome variables (pH, Density, and COnductivity) ARE NOT significantly different among the categories of the grouping variables.</p></li>
<li><p>The joint mean of the outcome variables (pH, Density, and Conductivity) ARE NOT significantly different for combinations of the contrours*Depth interaction.</p></li>
</ol>
<p><em>Note: Assumptions should always be verified as was done in the one-way MANOVA example. For brevity, this will be skipped here.</em></p>
<div id="create-a-model-and-determine-sum-of-squares-type" class="section level4">
<h4>Create a model and determine Sum of Squares type:</h4>
<p><strong>Three types of sum of squares</strong></p>
<ol style="list-style-type: decimal">
<li><p>Type I SS: Also called Sequential Sum of Squares, will assign variation in sequential order to grouping variables.</p></li>
<li><p>Type II SS: Here, variation assigned to each variable takes into account the other grouping variable(s). Type II is used when there is <strong>no</strong> significant interaction term.</p></li>
<li><p>Type III SS: Also called the partial sums of squares, like Type II, order of the variables is not considered. It is different from Type II in that it is used when there is a significant interaction term. </p></li>
</ol>
<pre class="r"><code># Create a model, have to bind the 3 outcome variables using cbind().

soils.mod &lt;- lm(cbind(pH, Dens, Conduc) ~ Contour + Depth + Contour*Depth -1, data = soils) # Note: -1 removes the intercept effect
summary(soils.mod)</code></pre>
<pre><code>## Response pH :
## 
## Call:
## lm(formula = pH ~ Contour + Depth + Contour * Depth - 1, data = soils)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.7125 -0.1775 -0.0125  0.1681  1.3875 
## 
## Coefficients:
##                         Estimate Std. Error t value Pr(&gt;|t|)    
## ContourDepression         5.3525     0.1951  27.438  &lt; 2e-16 ***
## ContourSlope              5.5075     0.1951  28.233  &lt; 2e-16 ***
## ContourTop                5.3325     0.1951  27.336  &lt; 2e-16 ***
## Depth10-30               -0.4725     0.2759  -1.713 0.095366 .  
## Depth30-60               -0.9900     0.2759  -3.589 0.000982 ***
## Depth60-90               -1.1800     0.2759  -4.277 0.000133 ***
## ContourSlope:Depth10-30   0.2475     0.3901   0.634 0.529848    
## ContourTop:Depth10-30    -0.0100     0.3901  -0.026 0.979693    
## ContourSlope:Depth30-60  -0.2500     0.3901  -0.641 0.525723    
## ContourTop:Depth30-60    -0.1375     0.3901  -0.352 0.726571    
## ContourSlope:Depth60-90  -0.4000     0.3901  -1.025 0.312085    
## ContourTop:Depth60-90    -0.2600     0.3901  -0.666 0.509396    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3901 on 36 degrees of freedom
## Multiple R-squared:  0.9949, Adjusted R-squared:  0.9932 
## F-statistic: 581.6 on 12 and 36 DF,  p-value: &lt; 2.2e-16
## 
## 
## Response Dens :
## 
## Call:
## lm(formula = Dens ~ Contour + Depth + Contour * Depth - 1, data = soils)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.25250 -0.07687  0.01750  0.08000  0.21750 
## 
## Coefficients:
##                         Estimate Std. Error t value Pr(&gt;|t|)    
## ContourDepression        0.97750    0.06148  15.899  &lt; 2e-16 ***
## ContourSlope             1.05000    0.06148  17.079  &lt; 2e-16 ***
## ContourTop               1.00250    0.06148  16.306  &lt; 2e-16 ***
## Depth10-30               0.38000    0.08695   4.370 0.000101 ***
## Depth30-60               0.55750    0.08695   6.412 1.96e-07 ***
## Depth60-90               0.52500    0.08695   6.038 6.18e-07 ***
## ContourSlope:Depth10-30 -0.08250    0.12296  -0.671 0.506539    
## ContourTop:Depth10-30   -0.05000    0.12296  -0.407 0.686685    
## ContourSlope:Depth30-60 -0.09750    0.12296  -0.793 0.433012    
## ContourTop:Depth30-60   -0.23750    0.12296  -1.932 0.061323 .  
## ContourSlope:Depth60-90 -0.15250    0.12296  -1.240 0.222914    
## ContourTop:Depth60-90   -0.09750    0.12296  -0.793 0.433012    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.123 on 36 degrees of freedom
## Multiple R-squared:  0.9936, Adjusted R-squared:  0.9915 
## F-statistic: 467.6 on 12 and 36 DF,  p-value: &lt; 2.2e-16
## 
## 
## Response Conduc :
## 
## Call:
## lm(formula = Conduc ~ Contour + Depth + Contour * Depth - 1, 
##     data = soils)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.9275 -0.7400 -0.0463  0.7981  3.1900 
## 
## Coefficients:
##                         Estimate Std. Error t value Pr(&gt;|t|)    
## ContourDepression         1.4725     0.6127   2.403  0.02153 *  
## ContourSlope              2.0500     0.6127   3.346  0.00193 ** 
## ContourTop                1.3725     0.6127   2.240  0.03136 *  
## Depth10-30                4.0075     0.8665   4.625 4.70e-05 ***
## Depth30-60                7.9200     0.8665   9.140 6.49e-11 ***
## Depth60-90                9.9650     0.8665  11.500 1.31e-13 ***
## ContourSlope:Depth10-30  -1.1475     1.2255  -0.936  0.35532    
## ContourTop:Depth10-30    -1.7975     1.2255  -1.467  0.15111    
## ContourSlope:Depth30-60  -1.0450     1.2255  -0.853  0.39944    
## ContourTop:Depth30-60    -1.8525     1.2255  -1.512  0.13935    
## ContourSlope:Depth60-90  -0.0450     1.2255  -0.037  0.97091    
## ContourTop:Depth60-90    -0.3075     1.2255  -0.251  0.80330    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.225 on 36 degrees of freedom
## Multiple R-squared:  0.9809, Adjusted R-squared:  0.9745 
## F-statistic: 154.1 on 12 and 36 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>The summary of this model shows contour and depth have significant effects on our outcome variables, but interaction terms are not (all greater than 0.05). When running a MANOVA, the type of Sum of Squares we wish to estimate must be specified.</p>
<p><strong><em>In our case, so we can use the type II sum of squares to test our null hypotheses as we do not have a significant interaction term.</em></strong></p>
<p>As discussed previously, Wilk’s lambda is considered between liberal and conservative and often used as the default test statistic. Because there is no obvious reason to use another test statistic at this point, let’s use Wilk’s lambda.</p>
<p><em>Note: <a href="https://towardsdatascience.com/anovas-three-types-of-estimating-sums-of-squares-don-t-make-the-wrong-choice-91107c77a27a">This article</a> gives a great summary of ANOVA Sum of Squares types.</em></p>
</div>
<div id="run-the-manova" class="section level4">
<h4>Run the MANOVA</h4>
<pre class="r"><code># Note: Manova() is brought to you by the car package

Manova(soils.mod, multivariate=T, type= c(&quot;II&quot;), test=(&quot;Wilks&quot;))</code></pre>
<pre><code>## 
## Type II MANOVA Tests: Wilks test statistic
##               Df test stat approx F num Df den Df Pr(&gt;F)    
## Contour        3   0.00939   53.497      9 82.898 &lt;2e-16 ***
## Depth          3   0.03164   28.855      9 82.898 &lt;2e-16 ***
## Contour:Depth  6   0.71510    0.676     18 96.652 0.8269    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code># Manova(soils.mod, multivariate=T, type= c(&quot;II&quot;), test=(&quot;Pillai&quot;))
# Manova(soils.mod, multivariate=T, type= c(&quot;II&quot;), test=(&quot;Hotelling-Lawley&quot;))
# Manova(soils.mod, multivariate=T, type= c(&quot;II&quot;), test=(&quot;Roy&quot;))

### If we did have an interaction term we would use type III 

manova(soils.mod, multivariate=T, type= c(&quot;III&quot;), test=(&quot;wilks&quot;))</code></pre>
<pre><code>## Warning: In lm.fit(x, y, offset = offset, singular.ok = singular.ok, ...) :
##  extra arguments &#39;multivariate&#39;, &#39;type&#39;, &#39;test&#39; will be disregarded</code></pre>
<pre><code>## Call:
##    manova(soils.mod, multivariate = T, type = c(&quot;III&quot;), test = (&quot;wilks&quot;))
## 
## Terms:
##                   Contour     Depth Contour:Depth Residuals
## pH              1046.8077   14.9590        0.5159    5.4798
## Dens              83.1553    1.5898        0.0884    0.5443
## Conduc          2096.4990  674.4830        5.8732   54.0631
## Deg. of Freedom         3         3             6        36
## 
## Residual standard errors: 0.3901487 0.1229612 1.22546
## Estimated effects may be unbalanced</code></pre>
<pre class="r"><code># manova(soils.mod, multivariate=T, type= c(&quot;III&quot;), test=(&quot;Pillai&quot;))
# manova(soils.mod, multivariate=T, type= c(&quot;III&quot;), test=(&quot;Hotelling-Lawley&quot;))
# manova(soils.mod, multivariate=T, type= c(&quot;III&quot;), test=(&quot;Roy&quot;))</code></pre>
<p>Each test statistic shows the interaction between contour and depth are not significant. Can reject our first null, but not the second one.</p>
</div>
</div>
<div id="partial-eta-squared-values-for-a-factorial-manova" class="section level3">
<h3>Partial Eta-Squared Values for a factorial MANOVA</h3>
<p>Partial eta-squared explains the portion of total variation from a specific grouping variable excluding all other grouping variables. This is commonly used as a measure of effect size.</p>
<p>In our example, each group variable(Contour and Depth) will have their own partial eta-squared values.</p>
<pre class="r"><code>library(&quot;heplots&quot;)
etasq(Anova(soils.mod),anova=TRUE)</code></pre>
<pre><code>## 
## Type II MANOVA Tests: Pillai test statistic
##                 eta^2 Df test stat approx F num Df den Df    Pr(&gt;F)    
## Contour       0.39218  3   1.17654   7.7427      9    108 1.010e-08 ***
## Depth         0.45907  3   1.37721  10.1840      9    108 3.154e-11 ***
## Contour:Depth 0.10488  6   0.31463   0.7030     18    108    0.8015    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>etasq(soils.mod,test=&quot;Wilks&quot;) # Using Wilks to be consistent with above</code></pre>
<pre><code>##                   eta^2
## Contour       0.7890322
## Depth         0.6837136
## Contour:Depth 0.1057565</code></pre>
<pre class="r"><code># etasq(soils.mod,test=&quot;Hotelling&quot;)
# etasq(soils.mod,test=&quot;Roy&quot;)
# etasq(soils.mod,test=&quot;Pillai&quot;)</code></pre>
<p>We can say that 78.9% of the variance of our outcome variables is due to the differences in the contour of the soil, and 68% due to the depth.</p>
</div>
<div id="other-variations-of-anova" class="section level2">
<h2>Other variations of ANOVA</h2>
<p><strong><em>ANCOVA/MANCOVA</em></strong> - Analysis of Covariance - an extension of ANOVA which can be used to control for covariates, or to study combinations of categorical and continuous variables.</p>
<p><strong><em>Repeated Measures ANOVA</em></strong> - useful when using pre- and post-treatment data, or differences over two or more time periods.</p>
<p><strong><em>Mixed-Model ANOVA (within-between ANOVA)</em></strong> - Used when examining differences in a response between/among treatments and over time (pre and post treatment, for example)</p>
<p><strong><em>Bayesian ANOVA</em></strong> - Instead of traditional hypothesis testing in which an F statistic and p-value are used to reject/not reject a null hypothesis, a Bayesian ANOVA can provide support for an alternative hypothesis.</p>
</div>
<div id="resources-we-found-helpful" class="section level2">
<h2>Resources we found helpful</h2>
<p>Bobbitt, Z. (2021, August 3). The Complete Guide: How To Check Manova Assumptions. Statology. Retrieved November 14, 2021, from <a href="https://www.statology.org/manova-assumptions/" class="uri">https://www.statology.org/manova-assumptions/</a>.</p>
<p>Buttigieg PL, Ramette A (2014) A Guide to Statistical Analysis in Microbial Ecology: a community-focused, living review of multivariate data analyses. FEMS Microbiol Ecol. 90: 543–550.</p>
<p>Cleophas T.J., Zwinderman A.H. (2018) Bayesian Analysis of Variance (Anova). In: Modern Bayesian Statistics in Clinical Research. Springer, Cham. <a href="https://doi-org.unr.idm.oclc.org/10.1007/978-3-319-92747-3_8" class="uri">https://doi-org.unr.idm.oclc.org/10.1007/978-3-319-92747-3_8</a></p>
<p>Korstanje, J. (2019, November 29). ANOVA’s three types of estimating sums of squares: Don’t make the wrong choice! Medium. Retrieved November 14, 2021, from <a href="https://towardsdatascience.com/anovas-three-types-of-estimating-sums-of-squares-don-t-make-the-wrong-choice-91107c77a27a" class="uri">https://towardsdatascience.com/anovas-three-types-of-estimating-sums-of-squares-don-t-make-the-wrong-choice-91107c77a27a</a>.</p>
<p>RenaissanceWoman. (2018, February 14). Multivariate Statistical Analysis Part 2: MANOVA (with R Demonstration) [Video]. YouTube. <a href="https://www.youtube.com/watch?v=SK6Tg3na3mo" class="uri">https://www.youtube.com/watch?v=SK6Tg3na3mo</a></p>
<p>Sarhad Journal of Agriculture, Vol.37, Iss. 4, Pages 1250-1259</p>
<p>Wang, Yifan. (2016). Using Multivariate Analysis for Pharmaceutical Drug Product Development. 10.13140/RG.2.2.23379.78881.</p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
