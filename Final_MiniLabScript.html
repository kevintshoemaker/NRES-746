<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Nathan Jackson &amp; Levi Heffelfinger" />

<meta name="date" content="2016-11-28" />

<title>Resource Selection Using GLMER</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">NRES 746</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Schedule
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="schedule.html">Course Schedule</a>
    </li>
    <li>
      <a href="labschedule.html">Lab Schedule</a>
    </li>
    <li>
      <a href="Syllabus2.pdf">Syllabus</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="INTRO.html">Introduction to NRES 746</a>
    </li>
    <li>
      <a href="LECTURE1.html">Why focus on algorithms?</a>
    </li>
    <li>
      <a href="LECTURE2.html">Working with probabilities</a>
    </li>
    <li>
      <a href="LECTURE3.html">The Virtual Ecologist</a>
    </li>
    <li>
      <a href="LECTURE4.html">Likelihood</a>
    </li>
    <li>
      <a href="LECTURE5.html">Optimization</a>
    </li>
    <li>
      <a href="LECTURE6.html">Bayesian #1: concepts</a>
    </li>
    <li>
      <a href="LECTURE7.html">Bayesian #2: mcmc</a>
    </li>
    <li>
      <a href="LECTURE8.html">Model Selection</a>
    </li>
    <li>
      <a href="LECTURE9.html">Performance Evaluation</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Lab exercises
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="NRES-746_lab1.zip">Lab 1: Algorithms in R</a>
    </li>
  </ul>
</li>
<li class="dropdown-header">Student-led topics</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Data sets
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="TreeData.csv">Tree Data</a>
    </li>
    <li>
      <a href="ReedfrogPred.csv">Reed Frog Predation Data</a>
    </li>
    <li>
      <a href="ReedfrogFuncresp.csv">Reed Frog Func Resp</a>
    </li>
  </ul>
</li>
<li>
  <a href="Links.html">Links</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Resource Selection Using GLMER</h1>
<h4 class="author">Nathan Jackson &amp; Levi Heffelfinger</h4>
<h4 class="date">November 28, 2016</h4>

</div>


<p>#Generalized Linear Mixed Effects Regression</p>
<p>###Before you begin</p>
<p>-Install the lme4 package</p>
<p>-Download the dataset for this exercise and save it to your working directory: final_winter_modeldata2.csv</p>
<p>###Read the dataset into R</p>
<pre class="r"><code>winter_deer_data1=read.csv(&#39;final_winter_modeldata2.csv&#39;)  # read data file into R</code></pre>
<p>These data were obtained by extracting values for each GPS collar location from GIS layers for the area these deer were occupying. Random points were created and had values extracted to classify what was “available” to the deer. The data has a “used” column that is coded 1 or 0 for used or unused respectively. Deer ID is “altid”.</p>
<p>###Convert catagorical variables to factors</p>
<p>Catgorical variables must be converted to factors to be recognized properly in R for this exercise</p>
<pre class="r"><code>winter_deer_data1$altid=factor(winter_deer_data1$altid) #convert catagorical variable to a vector of factor variables
winter_deer_data1$veg_class=factor(winter_deer_data1$veg_class) #convert catagorical variable to a vector of factor variables</code></pre>
<p>###Standardize all continuous variables</p>
<p>To avoid convergence issues related to scaling, it is important to standardize continuous variables</p>
<pre class="r"><code>stand_dist_to_water=(winter_deer_data1$dist_to_water-mean(winter_deer_data1$dist_to_water))/sd(winter_deer_data1$dist_to_water) #standardize continuous variable
stand_cos_aspect=(winter_deer_data1$cos_aspect-mean(winter_deer_data1$cos_aspect))/sd(winter_deer_data1$cos_aspect) #standardize continuous variable
stand_sin_aspect=(winter_deer_data1$sin_aspect-mean(winter_deer_data1$sin_aspect))/sd(winter_deer_data1$sin_aspect) #standardize continuous variable
stand_elevation=(winter_deer_data1$elevation-mean(winter_deer_data1$elevation))/sd(winter_deer_data1$elevation) #standardize continuous variable
stand_slope=(winter_deer_data1$slope-mean(winter_deer_data1$slope))/sd(winter_deer_data1$slope) #standardize continuous variable</code></pre>
<p>####Load the lme4 package</p>
<pre class="r"><code>library(lme4) #load lme4 package</code></pre>
<pre><code>## Loading required package: Matrix</code></pre>
<p>##Build a general mixed-effect additive model with random intercept</p>
<p>Here we build a basic generalized linear mixed-effects model. We use the glmer function and reference the used column from our data to compare used vs available points. This is an additive model that accounts for random effects allowing for random slope by individual. Note: “altid” is the identification number for each deer. The values associated with each GPS location have the deer ID value. This is treated as the “group” for mixed-effects in this example.</p>
<pre class="r"><code># generalized linear mixed effect additive model with random intercept for individual
winter_pequop_model=glmer(used~stand_dist_to_water+stand_cos_aspect
                          +stand_elevation+stand_slope+veg_class+
                          (1|altid),family=&quot;binomial&quot;,data=winter_deer_data1,
                          nAGQ = 1, na.action=&quot;na.fail&quot;)
summary(winter_pequop_model)</code></pre>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Laplace
##   Approximation) [glmerMod]
##  Family: binomial  ( logit )
## Formula: 
## used ~ stand_dist_to_water + stand_cos_aspect + stand_elevation +  
##     stand_slope + veg_class + (1 | altid)
##    Data: winter_deer_data1
## 
##      AIC      BIC   logLik deviance df.resid 
##  14993.5  15081.5  -7485.8  14971.5    22061 
## 
## Scaled residuals: 
##      Min       1Q   Median       3Q      Max 
## -27.6196  -0.3260   0.0032   0.3248   7.6500 
## 
## Random effects:
##  Groups Name        Variance Std.Dev.
##  altid  (Intercept) 0.9835   0.9917  
## Number of obs: 22072, groups:  altid, 53
## 
## Fixed effects:
##                     Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)          0.41433    0.14108    2.94  0.00332 ** 
## stand_dist_to_water -0.74022    0.02806  -26.38  &lt; 2e-16 ***
## stand_cos_aspect    -0.18377    0.02122   -8.66  &lt; 2e-16 ***
## stand_elevation      1.56434    0.04095   38.20  &lt; 2e-16 ***
## stand_slope          1.22337    0.03380   36.20  &lt; 2e-16 ***
## veg_class3          -0.57140    0.05883   -9.71  &lt; 2e-16 ***
## veg_class4          -4.67309    0.76972   -6.07 1.27e-09 ***
## veg_class6          -0.05232    0.12770   -0.41  0.68199    
## veg_class7           1.71760    0.13837   12.41  &lt; 2e-16 ***
## veg_class8          -2.67071    0.45203   -5.91 3.46e-09 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) stn___ stnd__ stnd_l stnd_s vg_cl3 vg_cl4 vg_cl6 vg_cl7
## stnd_dst_t_  0.034                                                        
## stnd_cs_spc -0.009 -0.002                                                 
## stand_elvtn  0.075  0.207  0.009                                          
## stand_slope  0.033 -0.219  0.057 -0.420                                   
## veg_class3  -0.146 -0.054  0.051 -0.197 -0.241                            
## veg_class4  -0.016  0.033  0.001 -0.036 -0.026  0.037                     
## veg_class6  -0.073  0.038  0.025 -0.284  0.058  0.255  0.024              
## veg_class7  -0.054 -0.169  0.008  0.090 -0.031  0.158  0.000  0.048       
## veg_class8  -0.032 -0.006 -0.028 -0.149  0.007  0.104  0.010  0.097  0.017</code></pre>
<p>The summary will give the coefficients for each parameter evaluated in the model. Positive coefficients mean selection for that variable with the exception of “distance to” variables" which are opposite. The summary also provides an AIC value to be used for comparison to models that will be built in the below excercises. Keep an eye on the standard error and significance values as you build models for anything that looks out of the ordinary.</p>
<p>***Note: in the following exercises it is important to understand that convergence issues may occur as models become too complex or if there is large variation in your group effect. Think about the relationships that may exist between covariates and omit those that may be less important after evaluating significance from several models.</p>
<p>##Exercise 1</p>
<p>###Building more complex models</p>
<p>Explore building more complex models. Generalized linear mixed effect models are flexible allowing the user to specify random slope, random intercept and other random effects. Be wary in blindly building models without biological reasoning. Below is a list of coding options for random effects code modifications:</p>
<p>(1|group) = random group intercept</p>
<p>(x|group) = random slope of x within group with correlated intercept</p>
<p>(0+x|group) = random slope of x within group: no variation in intercept</p>
<p>(1|group) + (0+x|group) = uncorrelated random intercept and random slope within group</p>
<p>(1|site/block) = intercept varying among sites and among blocks within sites (nested random effects)</p>
<p>site+(1|site:block) = fixed effect of sites plus random variation in intercept among blocks within sites</p>
<p>(x|site/block) = slope and intercept varying among sites and among blocks within sites</p>
<p>(x*site+(x|site:block)) = fixed effect variation of slope and intercept varying among sites and random variation of slope and intercept among blocks within sites</p>
<p>(1|group1)+(1|group2) = intercept varying among crossed random effects (e.g. site, year)</p>
<p>####Example of a model allowing coefficient for elevation to vary among each altid (deer)</p>
<pre class="r"><code>winter_pequop_model2=glmer(used~stand_dist_to_water+stand_cos_aspect
                          +(stand_elevation|altid)+stand_slope+veg_class,
                          family=&quot;binomial&quot;,data=winter_deer_data1,
                          nAGQ = 1, na.action=&quot;na.fail&quot;)</code></pre>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control
## $checkConv, : Model failed to converge with max|grad| = 0.00376095 (tol =
## 0.001, component 1)</code></pre>
<pre class="r"><code>summary(winter_pequop_model2) </code></pre>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Laplace
##   Approximation) [glmerMod]
##  Family: binomial  ( logit )
## Formula: 
## used ~ stand_dist_to_water + stand_cos_aspect + (stand_elevation |  
##     altid) + stand_slope + veg_class
##    Data: winter_deer_data1
## 
##      AIC      BIC   logLik deviance df.resid 
##  12744.3  12840.4  -6360.2  12720.3    22060 
## 
## Scaled residuals: 
##      Min       1Q   Median       3Q      Max 
## -264.989   -0.237    0.000    0.248    4.026 
## 
## Random effects:
##  Groups Name            Variance Std.Dev. Corr
##  altid  (Intercept)      75.44    8.686       
##         stand_elevation 116.54   10.795   0.98
## Number of obs: 22072, groups:  altid, 53
## 
## Fixed effects:
##                     Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)         -1.49577    0.30814  -4.854 1.21e-06 ***
## stand_dist_to_water -0.64301    0.02993 -21.482  &lt; 2e-16 ***
## stand_cos_aspect    -0.08085    0.02214  -3.652 0.000261 ***
## stand_slope          0.87497    0.03545  24.681  &lt; 2e-16 ***
## veg_class3          -0.82505    0.06128 -13.464  &lt; 2e-16 ***
## veg_class4          -5.33809    0.93785  -5.692 1.26e-08 ***
## veg_class6           0.23839    0.12385   1.925 0.054251 .  
## veg_class7           1.34350    0.16274   8.256  &lt; 2e-16 ***
## veg_class8          -1.60572    0.57540  -2.791 0.005261 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) stn___ stnd__ stnd_s vg_cl3 vg_cl4 vg_cl6 vg_cl7
## stnd_dst_t_ -0.010                                                 
## stnd_cs_spc -0.002  0.006                                          
## stand_slope  0.056 -0.224  0.021                                   
## veg_class3  -0.059 -0.067  0.036 -0.183                            
## veg_class4  -0.003  0.027 -0.001 -0.007  0.038                     
## veg_class6  -0.013  0.028  0.034  0.059  0.265  0.020              
## veg_class7  -0.039 -0.149  0.000 -0.010  0.172  0.011  0.061       
## veg_class8   0.003  0.002 -0.008 -0.002  0.077  0.004  0.094  0.003
## convergence code: 0
## Model failed to converge with max|grad| = 0.00376095 (tol = 0.001, component 1)</code></pre>
<p>##Exercise 2</p>
<p>###Explore interactions between covariates</p>
<p>Interactions within the models are specified using the * symbol. Think about biological interactions that may occur between the variables that have been measured.</p>
<p>##Exercise 3</p>
<p>###Explore quadratic relationships</p>
<p>Try exploring quadratic relationships for covariates. Covariates may not always have a linear relationship with resource selection.</p>
<p>***Note: a quadratic relationship can be indicated by I(covariate^2)</p>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
