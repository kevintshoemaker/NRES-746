<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="NRES 746" />


<title>Working with Probabilities</title>

<script src="site_libs/header-attrs-2.10/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">NRES 746</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Schedule
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="schedule.html">Course Schedule</a>
    </li>
    <li>
      <a href="Syllabus.pdf">Syllabus</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="INTRO.html">Introduction to NRES 746</a>
    </li>
    <li>
      <a href="LECTURE1.html">Why focus on algorithms?</a>
    </li>
    <li>
      <a href="LECTURE2.html">Working with probabilities</a>
    </li>
    <li>
      <a href="LECTURE3.html">The Virtual Ecologist</a>
    </li>
    <li>
      <a href="LECTURE4.html">Likelihood</a>
    </li>
    <li>
      <a href="LECTURE5.html">Optimization</a>
    </li>
    <li>
      <a href="LECTURE6.html">Bayesian #1: concepts</a>
    </li>
    <li>
      <a href="LECTURE7.html">Bayesian #2: mcmc</a>
    </li>
    <li>
      <a href="LECTURE8.html">Model Selection</a>
    </li>
    <li>
      <a href="LECTURE9.html">Performance Evaluation</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Lab exercises
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="LAB_Instructions.html">Instructions for Labs</a>
    </li>
    <li>
      <a href="FINALPROJ.html">Final project overview</a>
    </li>
    <li>
      <a href="LAB5.html">Lab 5: Model selection (optional)</a>
    </li>
    <li>
      <a href="FigureDemo.html">Demo: Figures in R</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Student-led topics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="LECTURE10.html">Machine Learning</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Data sets
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="TreeData.csv">Tree Data</a>
    </li>
    <li>
      <a href="ReedfrogPred.csv">Reed Frog Predation Data</a>
    </li>
    <li>
      <a href="ReedfrogFuncresp.csv">Reed Frog Func Resp</a>
    </li>
  </ul>
</li>
<li>
  <a href="Links.html">Links</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Working with Probabilities</h1>
<h4 class="author">NRES 746</h4>
<h4 class="date">Fall 2021</h4>

</div>


<p><strong>NOTE:</strong> for those wishing to follow along with the R-based demo in class, <a href="LECTURE2.R">click here</a> for the companion R-script for this lecture.</p>
<p>Note: some materials borrowed from White and Morgan’s “STATISTICAL MODELS IN ECOLOGY USING R” course</p>
<p>In the last class, we reviewed basic programming in R, using basic structures like the iterative loop (e.g., “for()”, “while()”) and random sampling (e.g., using the ‘sample()’ function in R) to build our own analyses from first principles. We began the course this way because the ability to understand, use, and build algorithms is absolutely fundamental to modern data analysis.</p>
<p>Also fundamental to modern data analysis is an ability to work with probabilities. Again, many of you will find this a very basic review, but I really want to ensure that all of us are working with solid foundations before we venture into more advanced topics.</p>
<p>The central points:</p>
<ul>
<li>Most traditional statistics use mathematical assumptions (e.g., large sample size, Gaussian errors) to ensure that test statistics follow a particular distribution<br />
</li>
<li>With more computational power, we are much less limited and can feasibly model alternative data generating processes involving a wide set of probability distributions.</li>
</ul>
<div id="basic-probability-rules" class="section level2">
<h2>Basic probability rules</h2>
<div id="classic-urn-example" class="section level3">
<h3>Classic Urn Example</h3>
<p>Consider an Urn filled with blue, red, and green spheres. To make the example more concrete, assume the following:</p>
<ul>
<li>red: 104</li>
<li>blue: 55</li>
<li>green: 30</li>
</ul>
<p><img src="urn1.jpg" /></p>
<pre class="r"><code>#########
# Classic Urn Example

n_red &lt;- 104
n_blue &lt;- 55
n_green &lt;- 30

allSpheres &lt;- c(n_red,n_blue,n_green)           # create vector of urn contents
names(allSpheres) &lt;- c(&quot;red&quot;,&quot;blue&quot;,&quot;green&quot;)    # make it a named vector, for convenience!</code></pre>
<p>What is the probability of drawing a blue sphere?</p>
<pre class="r"><code>P_blue &lt;- allSpheres[&quot;blue&quot;]/sum(allSpheres)     # probability of drawing a blue sphere
P_blue</code></pre>
<pre><code>##      blue 
## 0.2910053</code></pre>
<p>Let’s generate a vector of probabilities for drawing each type of sphere…</p>
<pre class="r"><code>Prob &lt;- allSpheres/sum(allSpheres)    # probability of drawing each type of sphere
Prob</code></pre>
<pre><code>##       red      blue     green 
## 0.5502646 0.2910053 0.1587302</code></pre>
<p>What is the probability of drawing a blue <strong>OR</strong> a red sphere?</p>
<pre class="r"><code>as.numeric( Prob[&quot;blue&quot;] + Prob[&quot;red&quot;] )     # probability of drawing a blue or red sphere</code></pre>
<pre><code>## [1] 0.8412698</code></pre>
<p>What is the probability of drawing a blue <strong>OR</strong> a red sphere <strong>OR</strong> a green sphere?</p>
<pre class="r"><code>as.numeric( Prob[&quot;blue&quot;] + Prob[&quot;red&quot;] + Prob[&quot;green&quot;] )      # P(blue OR green)</code></pre>
<pre><code>## [1] 1</code></pre>
<p><strong>Q</strong>: What would it mean if this didn’t sum to 1?</p>
<p>What is the probability of drawing a blue <strong>AND THEN</strong> a red sphere?</p>
<p><strong>NOTE:</strong> in the next examples, assume that objects are replaced and that the urn is re-randomized before any subsequent draws! That is, we are “<em>sampling with replacement</em>”</p>
<pre class="r"><code>#### Question: What is the probability of drawing a blue **AND THEN** a red sphere? 

#[your command here]    # P(blue AND THEN red)</code></pre>
<pre><code>## [1] 0.1601299</code></pre>
<p>What is the probability of drawing a blue and a red sphere in two consecutive draws (but in no particular order)?</p>
<pre class="r"><code>as.numeric( (Prob[&quot;blue&quot;] * Prob[&quot;red&quot;]) + (Prob[&quot;red&quot;] * Prob[&quot;blue&quot;]) )    # P(blue then red OR red then blue)</code></pre>
<pre><code>## [1] 0.3202598</code></pre>
</div>
<div id="less-classic-urn-example" class="section level3">
<h3>Less-classic urn example</h3>
<p>Now consider an urn filled with blue &amp; red objects of two different types: spheres &amp; cubes. To make the example more concrete, assume the following:</p>
<ul>
<li>red sphere: 39<br />
</li>
<li>blue sphere: 76<br />
</li>
<li>red cube: 101<br />
</li>
<li>blue cube: 25</li>
</ul>
<pre class="r"><code>##########
# Urn example #2

n_red_sphere &lt;- 39       # contents of new urn
n_blue_sphere &lt;- 76
n_red_cube &lt;- 101
n_blue_cube &lt;- 25

allSpheres &lt;- c(n_red_sphere,n_blue_sphere)         # build up matrix from vectors
allCubes &lt;- c(n_red_cube,n_blue_cube)
allTypes &lt;- c(allSpheres,allCubes)     
allTypes &lt;- matrix(allTypes,nrow=2,ncol=2,byrow=T)     # matrix of urn contents
rownames(allTypes) &lt;- c(&quot;sphere&quot;,&quot;cube&quot;)               # name rows and columns
colnames(allTypes) &lt;- c(&quot;red&quot;,&quot;blue&quot;)
allTypes</code></pre>
<pre><code>##        red blue
## sphere  39   76
## cube   101   25</code></pre>
<pre class="r"><code>Prob_Shape &lt;- apply(allTypes,1,sum)/sum(allTypes)  # marginal probabilities of shape
Prob_Shape</code></pre>
<pre><code>##    sphere      cube 
## 0.4771784 0.5228216</code></pre>
<pre class="r"><code>Prob_Color &lt;- apply(allTypes,2,sum)/sum(allTypes)    # marginal probabilities of color
Prob_Color</code></pre>
<pre><code>##       red      blue 
## 0.5809129 0.4190871</code></pre>
<pre class="r"><code>allprobs &lt;- (allTypes/sum(allTypes))
allprobs</code></pre>
<pre><code>##              red      blue
## sphere 0.1618257 0.3153527
## cube   0.4190871 0.1037344</code></pre>
<p>What is the <em>marginal probability</em> of drawing a red object (and why do we call it a “marginal” probability?)</p>
<pre class="r"><code>Prob_Color[&quot;red&quot;]      # marginal probability of drawing a red object</code></pre>
<pre><code>##       red 
## 0.5809129</code></pre>
<p>What is the <em>joint probability</em> of drawing an object that is both blue AND a cube? <span class="math inline">\(Prob(blue\bigcap cube)\)</span></p>
<pre class="r"><code>as.numeric( Prob_Color[&quot;blue&quot;] * Prob_Shape[&quot;cube&quot;])      # joint probability of drawing a blue object that is a cube</code></pre>
<pre><code>## [1] 0.2191078</code></pre>
<pre class="r"><code>## NOTE: if the above answer is not correct, please correct it!  And would I be asking this if it were correct? Hmmm...</code></pre>
<p><strong>Q</strong>: Is this correct? If not, why?</p>
<p><strong>Q</strong>: Under what circumstances would this be correct?</p>
<p>What is the correct answer?</p>
<pre><code>## [1] 0.1037344</code></pre>
<p>What is the probability of drawing an object that is blue <strong>OR</strong> a cube? <span class="math inline">\(Prob(blue\bigcup cube)\)</span></p>
<pre class="r"><code>as.numeric( Prob_Color[&quot;blue&quot;] + Prob_Shape[&quot;cube&quot;])        # probability of drawing something blue or something cube-shaped...</code></pre>
<pre><code>## [1] 0.9419087</code></pre>
<pre class="r"><code>## NOTE: if the above answer is not correct, please correct it!  </code></pre>
<p><strong>Q</strong>: Is this correct? If not, why? How would you compute the correct answer??</p>
<p><strong>Q</strong>: What is the correct answer?</p>
<pre><code>## [1] 0.8381743</code></pre>
<p>What is the <strong>conditional probability</strong> of drawing a blue object, given that it is a cube? <span class="math inline">\(Prob(blue|cube)\)</span></p>
<p>This can be expressed as: <span class="math inline">\(Prob(blue|cube) = Prob(blue,cube) / Prob(cube)\)</span></p>
<pre class="r"><code>allprobs[&quot;cube&quot;,&quot;blue&quot;] / Prob_Shape[&quot;cube&quot;]   # probability of drawing a blue object, given it is a cube</code></pre>
<pre><code>##      cube 
## 0.1984127</code></pre>
<p>Now we can express the correct <em>joint probability</em> of drawing a blue cube in terms of conditional probabilities!</p>
<p>This is the proper way of computing joint probabilities when you can’t assume independence!</p>
<p><span class="math inline">\(Prob(blue\bigcap cube) = Prob(cube|blue) * Prob(blue)\)</span></p>
<p>Does this now give us the correct answer?</p>
<pre class="r"><code>as.numeric( (allprobs[&quot;cube&quot;,&quot;blue&quot;] / Prob_Color[&quot;blue&quot;]) * Prob_Color[&quot;blue&quot;])   # probability of drawing a blue cube... using conditional probabilities</code></pre>
<pre><code>## [1] 0.1037344</code></pre>
<pre class="r"><code>allprobs[&quot;cube&quot;,&quot;blue&quot;]   # check answer to make sure it&#39;s right</code></pre>
<pre><code>## [1] 0.1037344</code></pre>
<p>What is an unconditional probability?</p>
<p>What is the unconditional probability of drawing a blue item, regardless of shape?</p>
<p><span class="math inline">\(Prob(blue|cube)\cdot Prob(cube) + Prob(blue|not cube) \cdot Prob(not cube)\)</span></p>
<pre class="r"><code># unconditional probability of drawing a blue item..  Seems too complicated, but this method of computing unconditional probabilities will prove useful when getting into Bayesian statistics!
uncond_prob_blue &lt;- (allprobs[&quot;cube&quot;,&quot;blue&quot;] /  Prob_Shape[&quot;cube&quot;]) * Prob_Shape[&quot;cube&quot;] + 
              (allprobs[&quot;sphere&quot;,&quot;blue&quot;] / Prob_Shape[&quot;sphere&quot;]) * Prob_Shape[&quot;sphere&quot;]       

as.numeric(uncond_prob_blue)</code></pre>
<pre><code>## [1] 0.4190871</code></pre>
<pre class="r"><code>Prob_Color[&quot;blue&quot;]   # check to make sure we get the right answer!</code></pre>
<pre><code>##      blue 
## 0.4190871</code></pre>
<p><strong>Q</strong>: Can you interpret the above equation in words? Take a moment to try! How does this relate to the <em>marginal probability</em>?</p>
<div id="short-exercise-2" class="section level4">
<h4>Short exercise #2</h4>
<p>What does it mean if the conditional probability of drawing a blue object (e.g., given it is a cube) is equal to the unconditional probability of drawing a blue item?</p>
</div>
</div>
<div id="bolkers-medical-example" class="section level3">
<h3>Bolker’s medical example</h3>
<p>Suppose the infection rate (prevalence) for a rare disease is one in a million:</p>
<pre class="r"><code>##########
# Bolker medical example

Prob_Disease &lt;- c(1,999999)     # disease prevalence 
Prob_Disease &lt;- Prob_Disease/sum(Prob_Disease)      # probability of disease
names(Prob_Disease) &lt;- c(&quot;yes&quot;,&quot;no&quot;)                # make it a named vector!
Prob_Disease</code></pre>
<pre><code>##      yes       no 
## 0.000001 0.999999</code></pre>
<p>Suppose there is a test that never gives a false negative result (if you’ve got it you will test positive) but occasionally gives a false positive result (if you don’t have it, you still might test positive for the disease). Let’s imagine a low false positive rate of 1%.</p>
<p>Medical professionals (and patients!) often want to know the probability that a positive-testing patient actually has the disease. This quantity is known as the <em>Positive Predictive Value</em> or PPV. How can we compute this?</p>
<p>Stated another way, we want to know the <em>conditional probability</em> of having the disease, given a positive test result:</p>
<p><span class="math inline">\(Prob(Disease|+test)\)</span></p>
<p>What do we have already?</p>
<p>First of all, we know the <em>conditional probability</em> of having a <em>positive</em> test result given the patient <em>has the disease</em>:</p>
<p><span class="math inline">\(Prob(+test|Disease) = 1\)</span></p>
<p>Secondly, we know the <em>conditional probability</em> of having a <em>positive</em> test result given the patient <em>doesn’t have the disease</em></p>
<p><span class="math inline">\(Prob(+test|no Disease) = 0.01\)</span></p>
<p>Third, we know the <em>unconditional probability</em> of having the disease</p>
<p><span class="math inline">\(Prob(Disease) = 0.000001\)</span></p>
<p>What is the <em>unconditional probability</em> of having a <em>positive</em> test result?</p>
<p><span class="math inline">\(Prob(+test)\)</span></p>
<p>Well, we can either test positive and have the disease or we can test positive and not have the disease… If we add up both of those mutually exclusive possibilities, we get the unconditional probability of testing positive. We are <em>conditioning out</em>, or <em>marginalizing</em> disease status:</p>
<p><span class="math inline">\(Prob(+test\bigcap Disease) + Prob(+test\bigcap no Disease)\)</span></p>
<p>Stated another way,</p>
<p><span class="math inline">\(Prob(+test|Disease)*Prob(Disease) + Prob(+test|no Disease)*Prob(no Disease)\)</span></p>
<pre class="r"><code>### compute the unconditional probability of testing positive

as.numeric( 1*Prob_Disease[&quot;yes&quot;] + 0.01*Prob_Disease[&quot;no&quot;] )    # Prob(+test|Disease)*Prob(Disease) + Prob(+test|no Disease)*Prob(no Disease)</code></pre>
<pre><code>## [1] 0.01000099</code></pre>
<p>This quantity can be interpreted as the probability of testing positive, regardless of whether or not you have the disease.</p>
<p>Now, let’s use basic probability rules to compute the PPV!</p>
<p>Let’s summarize the scenario. So now we have:</p>
<p><span class="math inline">\(Prob(+test|Disease) = 1\)</span><br />
<span class="math inline">\(Prob(Disease) = 0.000001\)</span><br />
<span class="math inline">\(Prob(+test) = 0.01000099\)</span></p>
<p>How can we use these components to compute what we want: <span class="math inline">\(PPV = Prob(Disease|+test)\)</span>?</p>
<p><strong>Q</strong>: What’s the the <em>joint probability</em> of testing positive and being infected?</p>
<p><strong>Q</strong>: How do you go from there (JOINT prob of testing positive AND having the disease) to the CONDITIONAL probability of having the disease given a positive test result?</p>
<p><strong>Q</strong>: What’s the PPV??</p>
<p><strong>Q</strong>: So should you be worried if you get a positive test result in this case?</p>
<p>Re-structure your PPV equation so that you consider the positive test result to be the “Data” and the positive disease status to be the “Hypothesis”</p>
<p>Can you guess the name of this simple rule of probability, which is at the core of <strong>Bayesian statistics</strong>?</p>
</div>
<div id="frequentism-vs.-bayesianism-an-aside" class="section level3">
<h3>Frequentism vs. Bayesianism (an aside)</h3>
<div id="what-is-frequentism" class="section level4">
<h4>What is Frequentism?</h4>
<p>Under this paradigm, the true answers are hidden behind a veil of sampling variability. That is, if we had perfect knowledge (infinite sample size) we would know the answers we seek. Random sampling errors prevent this level of certainty. However, since the parameter is fixed (but unknown) we cannot consider unknown parameters as being random quantities (derived from a probability distribution). However, if we know the <em>frequency</em> with which random sampling yields anomalies of various magnitudes, then we can understand and control for the effects of sampling variability. For example, we can set an <span class="math inline">\(\alpha\)</span> level (false-positive rate that we can live with) and then make a “positive” conclusion about a test only if random sampling variability could account for the observed effect size with a frequency at or below the pre-determined <span class="math inline">\(\alpha\)</span> level.</p>
</div>
<div id="what-is-bayesianism" class="section level4">
<h4>What is Bayesianism</h4>
<p>Given a set of plausible models for describing a system, Bayesian statistics can tell us the degree to which we can believe each model generated the observed data versus the other models in the candidate set. If we fit a regression model, Bayesian statistics can tell us the degree to which we can trust that the true regression parameter <span class="math inline">\(\beta_{1}\)</span> is above zero. Since probability is interpreted as a <em>degree of belief</em>, we <em>can</em> legitimately consider unknown parameters as being random quantities (derived from a probability distribution). In many ways, Bayesian analyses allow us to interpret uncertainty and probability in the way many of us intuitively want to – as degrees of belief about alternative hypotheses (e.g., possible model structures or parameter values). That said, Bayesian analyses require specifying a <em>prior</em> probability on all fitted parameters and models. This can pose a philosophical problem: what if you don’t have any prior knowledge? Furthermore, the interpretation of <em>probability</em> itself can get us in philosophical hot water; because Bayesian probabilities are best interpreted as “degree of belief”, your conclusions from the same data could be very different from mine… But maybe this is okay – at least these differences can be formalized in terms of different prior distributions!</p>
</div>
</div>
<div id="which-paradigm-is-better" class="section level3">
<h3>Which paradigm is better?</h3>
<p>The pragmatic analyst admits that they are both useful, and uses both methods freely!!</p>
<div id="question-for-pondering" class="section level4">
<h4>Question for pondering:</h4>
<p><strong>Likelihood</strong>, which is probably the central concept of this course, is defined as: <span class="math inline">\(Prob(data|hypothesis)\)</span>. Is the notion of a <em>likelihood</em> inherently Bayesian or Frequentist?</p>
<p><img src="frequentists_vs_bayesians.png" /></p>
<p><strong>Q</strong>: Can you write out the sun-exploding problem in terms of Bayes Rule? Can you solve it… approximately?</p>
</div>
</div>
</div>
<div id="lets-make-a-deal" class="section level2">
<h2>Let’s make a deal!</h2>
<p>This is a classic example for introducing Bayes rule… But it’s fun so we’re gonna do it anyway!</p>
<p>The setup: you are in a game show, called <em>Let’s Make a Deal</em>! There are three doors in front of you. One hides a fancy prize and the other two hide goats.</p>
<div class="figure">
<img src="montyhall.jpg" alt="" />
<p class="caption">Monty Hall problem, setup</p>
</div>
<p>You pick door 1. Before you see what’s behind door 1, the host, Monty Hall, opens door 2 to reveal a goat. Now you have two choices:</p>
<p><strong>Choice “STAY”</strong>: stick with your original choice of door 1<br />
<strong>Choice “SWITCH”</strong>: switch to door 3 (you wouldn’t switch to door 2 of course. You don’t like goats, and you can’t keep it even if you did)</p>
<p>Should you switch?</p>
<p>NOTE: no matter which door you choose at first, Monty will always open one of the other doors, and will never open the door with the prize (he knows where the prize is, after all).</p>
<p>Here’s a photo of Monty, just so you know who you’re dealing with:</p>
<div class="figure">
<img src="montyhall2.jpg" alt="" />
<p class="caption">Monty Hall</p>
</div>
<p>Given the new info, we now know the prize isn’t behind door 2. We want to know <span class="math inline">\(Prob(door1|info)\)</span> and <span class="math inline">\(Prob(door3|info)\)</span>. Let’s first focus on the first one- the <strong>posterior</strong> probability of the prize being behind door 1, given the new information we now have (Monty opened door 2).</p>
<p>Let’s say our hypothesis is that the prize is behind door 1 – we can call this the “stay” hypothesis, because if we believed this were the case, we had better keep door 1 as our choice and not switch to door 3!</p>
<p>As for the <strong>priors</strong> (knowledge about which door the prize is behind at the beginning of the game), let’s assign a <em>discrete uniform distribtuion</em> (equal probability mass assigned to each of a discrete set of possibilities). So the <strong>prior</strong> probability of the prize being behind door 1 is <span class="math inline">\(\frac{1}{3}\)</span>.</p>
<p><span class="math inline">\(Prob(door1) = 1/3\)</span></p>
<p>The new data/intel we have (<span class="math inline">\(info\)</span>) is that Monty opened door 2 to reveal a goat. Let’s apply Bayes rule!!</p>
<p><span class="math inline">\(Bayes \: rule = \frac{Prob(Data|Hypothesis) \cdot Prob(Hypothesis)}{Prob(Data)}\)</span></p>
<p>The first component of the numerator above, <span class="math inline">\(Prob(Data|Hypothesis)\)</span> is known as the <strong>likelihood</strong>.</p>
<p>So… what is the likelihood of the data (Monty opened door 2) under the “stay” hypothesis (the hypothesis that the prize is behind door 1, which we originally chose), <span class="math inline">\(Prob(info|door1)\)</span>?</p>
<p>The second component of the numerator, <span class="math inline">\(Prob(Hypothesis)\)</span>, is known as the <strong>prior</strong>. We already know this is equal to 1/3.</p>
<p>The denominator in Bayes theorem – in this case, <span class="math inline">\(Prob(info)\)</span> – is known as the <strong>unconditional probability of the data</strong>, or the <strong>normalizing constant</strong> (meaning it ensures that the posterior distribution is a true probability distribution).</p>
<p>One way to get the unconditional probability of the data is to sum up the (mututally exclusive) joint data probabilities across all possible models:</p>
<p><span class="math inline">\(Prob(info) = Prob(info,door1) + Prob(info,door2) + Prob(info,door3)\)</span></p>
<p>–or–</p>
<p><span class="math inline">\(Prob(info) = Prob(info|door1)\cdot Prob(door1) + Prob(info|door2)\cdot Prob(door2) + Prob(info|door3)\cdot Prob(door3)\)</span></p>
<p>In plain English: either A (Monty opened door 2 and prize is behind door 1) is true <em>or</em> B (Monty opened door 2 and prize is behind door 2) is true <em>or</em> C (Monty opened door 2 and prize is behind door 3) is true – and these possibilities are mutually exclusive).</p>
<p>One of these possibilities is patently false <em>a priori</em>!</p>
<p>So what’s our degree of belief about the prize being behind door 1 (the “stay” hypothesis)?</p>
<p>What’s our degree of belief about door 3 (the “switch” hypothesis)?</p>
<p>What should we do if we want to maximize our probability of winning the game??</p>
<p>Does this probability calculus convince you? Another way to convince yourself would be to simply simulate this result to convince ourselves that switching is the right move. Here is an R function for doing this:</p>
<pre class="r"><code>##### Monty Hall simulation code (code by Corey Chivers 2012)
#####################################################
# Simulation of the Monty Hall Problem
# Demonstrates that switching is always better
# than staying with your initial guess
#
# Corey Chivers, 2012
#####################################################
 
monty&lt;-function(strat=&#39;stay&#39;,N=1000,print_games=TRUE){
  doors&lt;-1:3 #initialize the doors behind one of which is a good prize
  win&lt;-0 #to keep track of number of wins
  
  for(i in 1:N){
    prize&lt;-floor(runif(1,1,4)) #randomize which door has the good prize
    guess&lt;-floor(runif(1,1,4)) #guess a door at random
    
    ## Reveal one of the doors you didn&#39;t pick which has a bum prize
    if(prize!=guess)
      reveal&lt;-doors[-c(prize,guess)]
    else
      reveal&lt;-sample(doors[-c(prize,guess)],1)
    
    ## Stay with your initial guess or switch
    if(strat==&#39;switch&#39;)
      select&lt;-doors[-c(reveal,guess)]
    if(strat==&#39;stay&#39;)
      select&lt;-guess
    if(strat==&#39;random&#39;)
      select&lt;-sample(doors[-reveal],1)
    
    ## Count up your wins
    if(select==prize){
      win&lt;-win+1
      outcome&lt;-&#39;Winner!&#39;
    }else
      outcome&lt;-&#39;Loser!&#39;
    
    if(print_games)
      cat(paste(&#39;Guess: &#39;,guess,
          &#39;\nRevealed: &#39;,reveal,
          &#39;\nSelection: &#39;,select,
          &#39;\nPrize door: &#39;,prize,
          &#39;\n&#39;,outcome,&#39;\n\n&#39;,sep=&#39;&#39;))
  }
  cat(paste(&#39;Using the &#39;,strat,&#39; strategy, your win percentage was &#39;,win/N*100,&#39;%\n&#39;,sep=&#39;&#39;)) #Print the win percentage of your strategy
}</code></pre>
<p>Now we can test out the different strategies.</p>
<pre class="r"><code>###########
# run the monty hall code!

monty(strat=&quot;stay&quot;,print_games=FALSE)</code></pre>
<pre><code>## Using the stay strategy, your win percentage was 35.5%</code></pre>
<p>And try a different strategy…</p>
<pre class="r"><code>###########
# run the monty hall code!

monty(strat=&quot;switch&quot;,print_games=FALSE)</code></pre>
<pre><code>## Using the switch strategy, your win percentage was 64.6%</code></pre>
<p>What if we had more prior information – say, there was a strong smell of goat coming from door 1? The priors would be different ( <span class="math inline">\(Prob(1) &gt; Prob(3)\)</span> ). The likelihoods would remain exactly the same, but the posterior for door 1 would be greater than 1/3. How strong would the odor have to be to convince you to stay rather than switch?</p>
<p>That’s one benefit of the Bayesian approach – you can integrate all the available information! Think about the XKCD comic above… Does it make sense that the Bayesian approach might have less of a tendency to produce “ridiculous” answers?</p>
</div>
<div id="probability-distributions" class="section level2">
<h2>Probability distributions</h2>
<div id="discrete-vs.-continuous" class="section level3">
<h3>Discrete vs. continuous</h3>
<p>In <em>discrete distributions</em>, each outcome has a specific probability (like the probability of flipping a coin 10 times and getting 4 heads). For example, let’s consider the Poisson distribution</p>
<pre class="r"><code>#################
# Probability distributions

mean &lt;- 5
rpois(10,mean)    # the random numbers have no decimal component</code></pre>
<pre><code>##  [1] 7 4 6 8 3 3 3 6 6 9</code></pre>
<pre class="r"><code>             # plot a discrete distribution!
xvals &lt;- seq(0,15,1)
probs &lt;- dpois(xvals,lambda=mean)
names(probs) &lt;- xvals
               
barplot(probs,ylab=&quot;Probability&quot;,main=&quot;Poisson distribution (discrete)&quot;)</code></pre>
<p><img src="LECTURE2_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<pre class="r"><code>barplot(cumsum(probs),ylab=&quot;Cumulative Probability&quot;,main=&quot;Poisson distribution (discrete)&quot;)   # cumulative distribution</code></pre>
<p><img src="LECTURE2_files/figure-html/unnamed-chunk-24-2.png" width="672" /></p>
<pre class="r"><code>sum(probs)   # just to make sure it sums to 1!  Does it??? </code></pre>
<pre><code>## [1] 0.999931</code></pre>
<p>In <em>continuous distributions</em>, the height of the curve corresponds to <em>probability density</em>, <span class="math inline">\(f(x)\)</span>, not probability <span class="math inline">\(Prob(x)\)</span>. This is because the probability of getting exactly one value in a continuous distribution is effectively zero. This arises from the problem of precision. The sum of the probability distribution must be 1 (there is only 100% of probability to go around). In a continuous distribution, there are an infinite number of possible values of x. So any individual probability is always divided by infinity, which makes it zero. Therefore we have to talk about probability density, unless we want to specify a particular range of values – we can’t calculate <span class="math inline">\(Prob(x = 5)\)</span>, but we can calculate <span class="math inline">\(Prob(4 &lt; x &lt; 6)\)</span> or <span class="math inline">\(Prob(x &gt; 5)\)</span>. Let’s consider the beta distribution:</p>
<pre class="r"><code>#########
# continuous distributions

shape1 = 0.5
shape2 = 0.5

rbeta(10,shape1,shape2)</code></pre>
<pre><code>##  [1] 0.92657121 0.98438854 0.45930964 0.97688015 0.07656494 0.81475334
##  [7] 0.99667411 0.84507683 0.09710872 0.50202627</code></pre>
<pre class="r"><code>curve(dbeta(x,shape1,shape2))   # probability density</code></pre>
<p><img src="LECTURE2_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<pre class="r"><code>curve(pbeta(x,shape1,shape2))   # cumulative distribution</code></pre>
<p><img src="LECTURE2_files/figure-html/unnamed-chunk-25-2.png" width="672" /></p>
<pre class="r"><code>integrate(f=dbeta,lower=0,upper=1,shape1=shape1,shape2=shape2)    # just to make sure it integrates to 1!!</code></pre>
<pre><code>## 1 with absolute error &lt; 3e-06</code></pre>
<div id="some-other-probability-distribution-terms" class="section level4">
<h4>Some other probability distribution terms:</h4>
<p><strong>Moments</strong> – descriptions of the distribution. For a bounded probability distribution, the collection of all the moments (of all orders, from 0 to ∞) uniquely determines the shape of the distribution.</p>
<ul>
<li><p>The zeroth central moment (<span class="math inline">\(\int \left ( x-\mu \right )^{0}Prob(x)\partial x\)</span>) is the total probability (i.e. one),<br />
</p></li>
<li><p>The first central moment (<span class="math inline">\(\int \left ( x-\mu \right )^{1}Prob(x)\partial x\)</span>) is <span class="math inline">\(\mu - \mu = 0\)</span>.<br />
</p></li>
<li><p>The second central moment (<span class="math inline">\(\int \left ( x-\mu \right )^{2}Prob(x)\partial x\)</span>) is the variance.<br />
</p></li>
<li><p>The third central moment (<span class="math inline">\(\int \left ( \left (x-\mu \right )/\sigma \right )^{3}Prob(x)\partial x\)</span>) is the skewness.</p></li>
<li><p>The fourth central moment is the kurtosis.</p></li>
</ul>
<p><strong>Parameters</strong> – the values in the probability distribution function, describing the exact shape and location of the distribution. <em>Parametric statistics</em> require assuming certain things about distributions &amp; parameters, while <em>nonparametric stats</em> do not require these assumptions.</p>
</div>
</div>
<div id="some-probability-distributions" class="section level3">
<h3>Some probability distributions</h3>
<p>The Bolker book goes through the main distributions we will be using in this course. Pay particular attention to the type of <em>process</em> described by each distribution. The key to using these distributions to represent random variables is to figure out which statistical process best matches the ecological process you’re studying, then use that distribution. e.g., am I counting independent, random events occurring in a fixed window of time or space (like sampling barnacles in quadrats on an intertidal bench)? Then the distribution of their occurrence is likely to follow a Poisson or Negative Binomial distribution.</p>
<div id="binomial" class="section level4">
<h4>Binomial</h4>
<pre class="r"><code>##########
# Binomial

size &lt;- 10
prob &lt;- 0.3
rbinom(10,size,prob)</code></pre>
<pre><code>##  [1] 4 2 4 3 4 4 1 3 2 5</code></pre>
<pre class="r"><code>xvals &lt;- seq(0,size,1)
probs &lt;- dbinom(xvals,size,prob)
names(probs) &lt;- xvals
               
barplot(probs,ylab=&quot;Probability&quot;,main=&quot;Binomial distribution&quot;)</code></pre>
<p><img src="LECTURE2_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<pre class="r"><code>barplot(cumsum(probs),ylab=&quot;Cumulative Probability&quot;,main=&quot;Binomial distribution&quot;)   # cumulative distribution</code></pre>
<p><img src="LECTURE2_files/figure-html/unnamed-chunk-26-2.png" width="672" /></p>
<pre class="r"><code>sum(probs)   # just to make sure it sums to 1!  Does it???</code></pre>
<pre><code>## [1] 1</code></pre>
</div>
<div id="normal" class="section level4">
<h4>Normal</h4>
<pre class="r"><code>#########
# Gaussian

mean = 7.1
stdev = 1.9

rnorm(10,mean,stdev)</code></pre>
<pre><code>##  [1] 5.940470 7.104222 7.791892 9.509691 8.721818 7.469465 6.200863
##  [8] 3.886482 8.149301 4.784108</code></pre>
<pre class="r"><code>curve(dnorm(x,mean,stdev),0,15)   # probability density</code></pre>
<p><img src="LECTURE2_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<pre class="r"><code>curve(pnorm(x,mean,stdev),0,15)   # cumulative distribution</code></pre>
<p><img src="LECTURE2_files/figure-html/unnamed-chunk-27-2.png" width="672" /></p>
<pre class="r"><code>integrate(f=dnorm,lower=-Inf,upper=Inf,mean=mean,sd=stdev)    # just to make sure it integrates to 1!!</code></pre>
<pre><code>## 1 with absolute error &lt; 1.1e-05</code></pre>
</div>
<div id="exercise" class="section level4">
<h4>Exercise:</h4>
<p>Visualize the following distributions as above: Gamma, Exponential, Lognormal, Negative Binomial.</p>
<p><a href="LECTURE3.html">–go to next lecture–</a></p>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
