<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Jackie Dougherty &amp; Corina Mathews-Sanchez" />

<meta name="date" content="2023-12-11" />

<title>Integrated Population Models (lab)</title>

<script src="site_libs/header-attrs-2.24/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">NRES 746</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Schedule
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="schedule.html">Course Schedule</a>
    </li>
    <li>
      <a href="Syllabus.pdf">Syllabus</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="INTRO.html">Introduction to NRES 746</a>
    </li>
    <li>
      <a href="LECTURE1.html">Why focus on algorithms?</a>
    </li>
    <li>
      <a href="LECTURE2.html">Working with probabilities</a>
    </li>
    <li>
      <a href="LECTURE3.html">The Virtual Ecologist</a>
    </li>
    <li>
      <a href="LECTURE4.html">Likelihood</a>
    </li>
    <li>
      <a href="LECTURE5.html">Optimization</a>
    </li>
    <li>
      <a href="LECTURE6.html">Bayesian #1: concepts</a>
    </li>
    <li>
      <a href="LECTURE7.html">Bayesian #2: mcmc</a>
    </li>
    <li>
      <a href="LECTURE8.html">Model Selection</a>
    </li>
    <li>
      <a href="LECTURE9.html">Performance Evaluation</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Lab exercises
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="LAB_Instructions.html">Instructions for Labs</a>
    </li>
    <li>
      <a href="LAB3demo.html">Lab 3: Likelihood (intro)</a>
    </li>
    <li>
      <a href="LAB5.html">Lab 5: Model selection (optional)</a>
    </li>
    <li>
      <a href="FigureDemo.html">Demo: Figures in R</a>
    </li>
    <li>
      <a href="GIT_tutorial.html">Demo: version control in Git</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Student led topics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="GLMM.html">GLMMs</a>
    </li>
    <li>
      <a href="GLMM_Lab.html">GLMMs (lab)</a>
    </li>
    <li>
      <a href="GAMs_Lab.html">GAMs (lab)</a>
    </li>
    <li>
      <a href="Rastering.html">RSFs (raster demo)</a>
    </li>
    <li>
      <a href="RSF_Lab.html">RSFs (lab)</a>
    </li>
    <li>
      <a href="rf2023.html">Random Forest (demo)</a>
    </li>
    <li>
      <a href="rfregression.html">Random Forest (lab)</a>
    </li>
    <li>
      <a href="SpatialRegression.html">Spatial Regression (demo and lab)</a>
    </li>
    <li>
      <a href="Ordination2023.html">Ordination</a>
    </li>
    <li>
      <a href="OrdinationLab2023.html">Ordination (lab)</a>
    </li>
    <li>
      <a href="ts_ar_lecture.html">Time series models</a>
    </li>
    <li>
      <a href="AutoregressiveTimeSeries_Lab.html">Time series models (lab)</a>
    </li>
    <li>
      <a href="IPM_lecture.html">Integrated population models (IPM)</a>
    </li>
    <li>
      <a href="IPM_lab.html">IPMs (lab)</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Data sets
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="TreeData.csv">Tree Data</a>
    </li>
    <li>
      <a href="ReedfrogPred.csv">Reed Frog Predation Data</a>
    </li>
    <li>
      <a href="ReedfrogFuncresp.csv">Reed Frog Func Resp</a>
    </li>
  </ul>
</li>
<li>
  <a href="Links.html">Links</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Integrated Population Models (lab)</h1>
<h4 class="author">Jackie Dougherty &amp; Corina Mathews-Sanchez</h4>
<h4 class="date">2023-12-11</h4>

</div>


<p><strong><em>NOTE: The following examples are borrowed from Schaub and
Kery (2022)</em></strong></p>
<p>Click here to follow along in R: <a
href="IPM_labcode.R">IPM_labcode.R</a></p>
<p><img src="woodchat.png" style="width:50.0%" /></p>
<p><strong>A male woodchat shrike (<em>Lanius senator</em>)</strong></p>
<div id="the-three-step-approach-to-ipms" class="section level1">
<h1>The Three-Step Approach to IPMs</h1>
<p>Step 1. Develop a model that links demographic rates to population
sizes Step 2. Formulate the likelihood for each available data set
(submodel) separately Step 3. Formulate the joint likelihood and analyze
it for inference</p>
<div
id="step-1-development-of-a-model-that-links-demographic-data-with-population-size"
class="section level3">
<h3>Step 1: Development of a Model that Links Demographic Data with
Population Size</h3>
<p><img src="life_cycle.png" /> <strong>Woodchat shrike life-cycle
graph</strong></p>
<p>For this example, we will use a woodchat shrike data set. The species
is monogamous, and demographic rates are similar among the sexes, so we
construct a female-based model. We assume a prebreeding “census” and
include two age classes, 1-year-old (“1y”) and older (“ad”) individuals.
Here, we write down the population equations:</p>
<p><img src="pop_eqns.png" /></p>
<p>We want our IPM to include both demographic stochasticity and
environmental stochasticity/variability. Because environmental
stochasticity is just a possibly confusing name for “temporal
variability,” we can include it by letting the demographic parameters
vary over time. We denote this by adding an index <em>t</em> for time
for all parameters.</p>
<p><img src="pop_stochastic.png" /></p>
</div>
<div
id="step-2-formulation-of-the-likelihood-for-each-available-data-set-seperately"
class="section level3">
<h3>Step 2: Formulation of the Likelihood for Each Available Data Set
Seperately</h3>
<p>The choice of likelihood for each component data set requires a good
knowledge of the range of sensible statistical models. To see some
examples, <a
href="https://kevintshoemaker.github.io/NRES-746/IPM_lecture.html">view</a>
the lecture portion of this topic.</p>
<p>IPMs necessarily include data that contain information about
population size and its change over time. We will always have a model
that links these measures of population size to the demographic rates in
our population model.</p>
<p><strong>State-space models</strong> are well suited for this purpose
because they describe an imperfectly observed state that evolves over
time. Generally, the state process equations are exactly equivalent to
the population model defined in the first step of this approach toward
building the IPM.</p>
<p>A model that describes the initial conditions of the population in
the first year is needed. In a Bayesian analysis, we estimate these
quantities and therefore place priors on them. Here we use a prior that
gives equal support to a wide range of possible values. For the woodchat
shrikes, the observed population count in year 1 was 91, and thus we
choose discrete uniform priors (<em>DU</em>) between 1 and 300 for each
age class.</p>
<p><img src="inits_n1.png" /></p>
<p>The state-space model also contains the observation equations that
link the observed population counts with the true, latent population
abundance. This submodel should ideally reflect the sampling design that
produced these counts. In our IPM, we assume that a single survey in
each year produced our shrike counts (<em>C<sub>t</sub></em>) and that
they are subject to both imperfect detection and possible
double-counting, and hence we model them using a normal
distribution:</p>
<p><img src="obs_error.png" /></p>
<p>In our example, we assume that birds cannot be aged. The sum of the
numbers of the two age classes is treated as the observed random
variable.</p>
<p>The likelihood of the state-space model (<em>L<sub>SS</sub></em>) is
the product of the three likelihoods for the initial state, the state
process, and the observation process:</p>
<p><img src="lss.png" /></p>
<p>where <em>L<sub>I</sub></em> is the likelihood of the population size
at occasion 1, <em>L<sub>s</sub></em> is the likelihood of the state
process, and <em>L<sub>o</sub></em> is the likelihood of the observation
process, and bold letters denote matrices and vectors. Specifically,
<em>N<sub>1</sub></em> is age-specific population size in the first
year, <em>N<sub>2…T</sub></em> contains the age-specific population
sizes from years 2 to <em>T</em>, and <em>N</em> is the age-specific
population size for the complete time series, i.e., from 1 to
<em>T</em>.</p>
<p>Our second data set is the capture-recapture data, for which we adopt
a <em>Cormack-Jolly-Seber model</em>. We model the age-specific survival
probabilities with uncorrelated temporal random effects and define</p>
<p><img src="cjs.png" /></p>
<p>where <span class="math inline">\(\mu\)</span><sub>sj</sub> and <span
class="math inline">\(\mu\)</span><sub>sa</sub> are the means, and <span
class="math inline">\(\sigma^2\)</span><sub>sj</sub> and <span
class="math inline">\(\sigma^2\)</span><sub>sa</sub> are the temporal
variances, of juvenile and adult survival probabilities, respectively,
on the logit scale. We assume recapture probability to be constant over
time (p<sub>t</sub> = <span class="math inline">\(\bar{p}\)</span>), and
for faster computation, we will work with the multinomial likelihood for
the data summarized in the m-array (<em>m</em>). Written symbolically,
the likelihood for the capture-recapture data set is</p>
<p><img src="cjs_like.png" /></p>
<p>Our third data set is the <em>productivity data</em>, for which we
here adopt a <em>Poisson regression</em>, again with uncorrelated random
time effects for the parameters of both age classes:</p>
<p><img src="prod_ll.png" /></p>
<p>where <span class="math inline">\(\mu\)</span><sub>f1</sub> and <span
class="math inline">\(\mu\)</span><sub>fa</sub> are the means, and <span
class="math inline">\(\sigma^2\)</span><sub>f1</sub> and <span
class="math inline">\(\sigma^2\)</span><sub>fa</sub> are the temporal
variances, of productivity of first-year and older females,
respectively, on the log scale. The likelihood of this Poisson
regression model is written symbolically as</p>
<p><img src="prod_ll2.png" /></p>
<p>Here, <strong><em>J</em></strong> are the productivity data that also
include the categorical variable indicating the age class of the
mother.</p>
</div>
<div id="step-3-formulation-of-the-joint-likelihood"
class="section level3">
<h3>Step 3: Formulation of the Joint Likelihood</h3>
<p>The third and final step is the formulation of a joint likelihood -
this forms the likelihood for the full IPM. The joint likelihood for the
IPM is simply the product of the likelihoods for each individual data
set just discussed:</p>
<p><img src="joint_ll.png" /></p>
<p><em>s<sub>j</sub></em> - juvenile survival</p>
<p><em>s<sub>a</sub></em> - adult survival</p>
<p><em>f<sub>1</sub></em> - productivity of 1-year old females</p>
<p><em>f<sub>a</sub></em> - productivity of adult females ( &gt; 1 year
old)</p>
<p>Inference for the IPM is based on this joint likelihood. we clearly
see that information among different data sets is shared: the likelihood
component of the state-space model contains some parameters that also
appear in the likelihoods for the capture-recapture and productivity
data (i.e., <strong><em>s<sub>j</sub></em></strong>,
<strong><em>s<sub>a</sub></em></strong>,
<strong><em>f<sub>1</sub></em></strong> and
<strong><em>f<sub>a</sub></em></strong>).</p>
<p><img src="ipm_graph.png" /></p>
<p>In the above <em>directed acyclic graph (DAG)</em> ,all known
quantities (typically data) are represented as squares, while all
unknown quantities (estimated parameters, missing data, predictions,
etc.) are shown as circles. Arrows link nodes and indicate dependencies
among different quantities in the model. Quantities that appear in
multiple boxes are informed by more than one data set. For instance,you
can see that information about juvenile survival originates from the
capture-recapture data and the population count data.</p>
<p>In JAGS, we will not need to write the joint likelihood explicitly as
a single “ugly” expression. Rather, the program allows us to define the
joint likelihood in a hierarchical manner by specifying “local”
relationships between all the nodes in the DAG of an IPM. The
integration occurs by giving the same name to quantities that appear in
different parts of the separate likelihood statements for the individual
data sets combined in the IPM.</p>
</div>
</div>
<div id="lets-code-this-ipm" class="section level1">
<h1>Let’s Code this IPM!!</h1>
<pre class="r"><code>library(IPMbook)
library(jagsUI)


# Load Data 
data(woodchat5)
str(woodchat5)</code></pre>
<pre class="r"><code>marr &lt;- marrayAge(woodchat5$ch, woodchat5$age)</code></pre>
<pre class="r"><code># Bundle data and produce data overview
jags.data &lt;- list(marr.j=marr[,,1], marr.a=marr[,,2], n.occasions=dim(marr)[2],
rel.j=rowSums(marr[,,1]), rel.a=rowSums(marr[,,2]), J=woodchat5$repro[,1],
year=woodchat5$repro[,2], age=woodchat5$repro[,3], C=woodchat5$count, pNinit=dUnif(1, 300))
str(jags.data)</code></pre>
<pre class="r"><code># Write JAGS model file
cat(file=&quot;model4.txt&quot;, &quot;
model {
# Priors and linear models
for (t in 1:(n.occasions-1)){
logit.sj[t] ~ dnorm(mu.sj, tau.sj)
sj[t] &lt;- ilogit(logit.sj[t]) # Back-transformation from logit scale
logit.sa[t] ~ dnorm(mu.sa, tau.sa)
sa[t] &lt;- ilogit(logit.sa[t]) # Back-transformation from logit scale
p[t] &lt;- mean.p
}

for (t in 1:n.occasions){
log.f[1,t] ~ dnorm(mu.f[1], tau.f[1])
f[1,t] &lt;- exp(log.f[1,t]) # Back-transformation from log scale
log.f[2,t] ~ dnorm(mu.f[2], tau.f[2])
f[2,t] &lt;- exp(log.f[2,t]) # Back-transformation from log scale
}
mean.sj ~ dunif(0, 1)
mu.sj &lt;- logit(mean.sj) # Logit transformation
mean.sa ~ dunif(0, 1)
mu.sa &lt;- logit(mean.sa) # Logit transformation
sigma.sj ~ dunif(0, 3)
tau.sj &lt;- pow(sigma.sj, -2)
sigma.sa ~ dunif(0, 3)
tau.sa &lt;- pow(sigma.sa, -2)
for (j in 1:2){
mean.f[j] ~ dunif(0, 10)
mu.f[j] &lt;- log(mean.f[j]) # Log transformation
sigma.f[j] ~ dunif(0, 3)
tau.f[j] &lt;- pow(sigma.f[j], -2)
}
mean.p ~ dunif(0, 1)
sigma ~ dunif(0.5, 100)
tau &lt;- pow(sigma, -2)
# Population count data (state-space model)
# Model for initial stage-spec. population sizes: discrete uniform priors
N[1,1] ~ dcat(pNinit)
N[2,1] ~ dcat(pNinit)
# Process model over time: our model of population dynamics
for (t in 1:(n.occasions-1)){
N[1,t+1] ~ dpois(N[1,t] * f[1,t] / 2 * sj[t] + N[2,t] * f[2,t] / 2 * sj[t])
N[2,t+1] ~ dbin(sa[t], N[1,t] + N[2,t])
}
# Observation model
for (t in 1:n.occasions){
C[t] ~ dnorm(N[1,t] + N[2,t], tau)
}
# Productivity data (Poisson regression model)
for (i in 1:length(J)){
J[i] ~ dpois(f[age[i],year[i]])
}
# Capture-recapture data (CJS model with multinomial likelihood)
# Define the multinomial likelihood
for (t in 1:(n.occasions-1)){
marr.j[t,1:n.occasions] ~ dmulti(pr.j[t,], rel.j[t])
marr.a[t,1:n.occasions] ~ dmulti(pr.a[t,], rel.a[t])
}
# Define the cell probabilities of the m-arrays
for (t in 1:(n.occasions-1)){
# Main diagonal
q[t] &lt;- 1 - p[t] # Probability of non-recapture
pr.j[t,t] &lt;- sj[t] * p[t]
pr.a[t,t] &lt;- sa[t] * p[t]
# Above main diagonal
for (j in (t+1):(n.occasions-1)){
pr.j[t,j] &lt;- sj[t] * prod(sa[(t+1):j]) * prod(q[t:(j-1)]) * p[j]
pr.a[t,j] &lt;- prod(sa[t:j]) * prod(q[t:(j-1)]) * p[j]
} #j
# Below main diagonal
for (j in 1:(t-1)){
pr.j[t,j] &lt;- 0
pr.a[t,j] &lt;- 0
} #j
} #t

# Last column: probability of non-recapture
for (t in 1:(n.occasions-1)){
pr.j[t,n.occasions] &lt;- 1-sum(pr.j[t,1:(n.occasions-1)])
pr.a[t,n.occasions] &lt;- 1-sum(pr.a[t,1:(n.occasions-1)])
}
# Derived parameters
# Annual population growth rate (added 0.001 to avoid possible division by 0)
for (t in 1:(n.occasions-1)){
ann.growth.rate[t] &lt;- (N[1,t+1] + N[2,t+1]) / (N[1,t] + N[2,t] + 0.001)
}
# Total population size
for (t in 1:n.occasions){
Ntot[t] &lt;- N[1,t] + N[2,t]
}
}
&quot;)

# Initial values
inits &lt;- function(){list(mean.sj=runif(1, 0, 0.5))}
# Parameters monitored
parameters &lt;- c(&quot;mean.sj&quot;, &quot;mean.sa&quot;, &quot;mean.f&quot;, &quot;mean.p&quot;, &quot;sigma.sj&quot;, &quot;sigma.sa&quot;, &quot;sigma.f&quot;,
&quot;sigma&quot;, &quot;sj&quot;, &quot;sa&quot;, &quot;f&quot;, &quot;N&quot;, &quot;ann.growth.rate&quot;, &quot;Ntot&quot;)
# MCMC settings
ni &lt;- 12000; nb &lt;- 2000; nc &lt;- 3; nt &lt;- 2; na &lt;- 1000
# Call JAGS (ART 1 min), check convergence and summarize posteriors
out4 &lt;- jags(jags.data, inits, parameters, &quot;model4.txt&quot;, n.iter=ni, n.burnin=nb, n.chains=nc,
n.thin=nt, n.adapt=na, parallel=TRUE)
#traceplot(out4) # Warning: there are a lot of estimated parameters
print(out4, 3)</code></pre>
<p><img src="results_fig.png" /></p>
<p>Note: The model produced parameter estimates that look good, however,
this is not yet a confirmation that they will also be accurate. To
determine whether a model produces “good” (e.g., unbiased, or precise)
estimates, we need simulations with many replicates (see Schaub and
Kery, 2022).</p>
<div id="questions-for-lab" class="section level2">
<h2>Questions for lab</h2>
<p><img src="tortmodel.png" /></p>
<ol style="list-style-type: decimal">
<li><p>Understanding the population model for your species is central
for developing a successful IPM. Here, in this lab we walked through an
example life cycle graph and Leslie age-structured matrix for the
woodchat shrike. In lecture, we saw the life cycle graph and Lefkovitch
stage-structured matrix for the desert tortoise. On the paper provided,
please draw a rough example of what a life cycle graph and population
matrix would look like for your study species. (If you do not work with
plants or animals, feel free to pick an organism that you would like to
study!) Identify the flow of survival, recruitment, and
fecundity.</p></li>
<li><p>Using your life cycle graph, draw a potential matrix population
model. Remember: a populaiton matrix must have the same number of rows
as it does columns. Feel free to estimate rates or simply use symbology
to represent probabilities.</p></li>
<li><p>Identify the population model in the woodchat shrike code
provided. Notice that it is represented by a series of formulas using
time steps, population size, and survival. How would you provide the
population of your study species in JAGS code?</p></li>
<li><p>For you species chosen above, identify a survey that you have
participated in (or are aware of). Give an example of what parameter
this would provide to an IPM. What vital rate does this parameter act
upon?</p></li>
<li><p>After running the lab code, explain the relationship between the
lines of observed population counts versus estimated population
size.</p></li>
<li><p>Attempt to plot the estimated population size further in
time.</p></li>
</ol>
</div>
<div id="resources-for-learning-about-ipms" class="section level2">
<h2>Resources for learning about IPMs</h2>
<p>Textbook: <em>Integrated Population Models</em> by Michael Schaub and
Marc Kery (2022)</p>
<p>Paper: <em>Integrated population models: a novel analysis framework
for deeper insights into population dynamics</em> by Michael Schaub
&amp; Fitsum Abadi (2011) <a
href="https://link.springer.com/article/10.1007/s10336-010-0632-7">view</a></p>
<p>Paper: <em>Integrated population models: Model assumptions and
inference</em> by Riecke et al. (2019) <a
href="https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/2041-210X.13195">view</a></p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
