<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="NRES 746" />


<title>Lab Exercise 2</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">NRES 746</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Schedule
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="schedule.html">Course Schedule</a>
    </li>
    <li>
      <a href="labschedule.html">Lab Schedule</a>
    </li>
    <li>
      <a href="Syllabus2.pdf">Syllabus</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="INTRO.html">Introduction to NRES 746</a>
    </li>
    <li>
      <a href="LECTURE1.html">Why focus on algorithms?</a>
    </li>
    <li>
      <a href="LECTURE2.html">Working with probabilities</a>
    </li>
    <li>
      <a href="LECTURE3.html">The Virtual Ecologist</a>
    </li>
    <li>
      <a href="LECTURE4.html">Likelihood</a>
    </li>
    <li>
      <a href="LECTURE5.html">Optimization</a>
    </li>
    <li>
      <a href="LECTURE6.html">Bayesian #1: concepts</a>
    </li>
    <li>
      <a href="LECTURE7.html">Bayesian #2: mcmc</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Lab exercises
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="LAB1.html">Lab 1: Algorithms in R</a>
    </li>
    <li>
      <a href="FINALPROJ.html">Final project overview</a>
    </li>
    <li>
      <a href="LAB2.html">Lab 2: Virtual ecologist</a>
    </li>
    <li>
      <a href="LAB3.html">Lab 3: Likelihood</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Data sets
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="TreeData.csv">Tree Data</a>
    </li>
    <li>
      <a href="ReedfrogPred.csv">Reed Frog Predation Data</a>
    </li>
    <li>
      <a href="ReedfrogFuncresp.csv">Reed Frog Func Resp</a>
    </li>
  </ul>
</li>
<li>
  <a href="Links.html">Links</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Lab Exercise 2</h1>
<h4 class="author"><em>NRES 746</em></h4>
<h4 class="date"><em>Fall 2018</em></h4>

</div>


<div id="the-virtual-ecologist" class="section level2">
<h2>The Virtual Ecologist</h2>
<p>As with all lab reports, your answers will either take the form of R functions or short written responses (submitted together in a Word document). The R functions should be stored in an R script file (‘.R’ extension). To allow me to evaluate your work more efficiently, please name your R script using the following convention: “[your first name]_[your last name]_lab2.R“. So my submission would be”kevin_shoemaker_lab2.R“. The name of your Word docuement doesn’t matter, as long as you submit via WebCampus.</p>
<p>Please submit the R script and the Word document via WebCampus by midnight on the due date (one week after the final lab session allocated for this topic – here, <em>Oct. 2, 2018</em>). You can work in groups but please submit the materials individually.</p>
<p>When writing functions, it’s often easiest to start off by writing a script, and then when you have everything working properly, wrap the script into a function. But still remember to test your function!</p>
<p>Please comment each line of your code. Don’t be afraid of <em>for</em> loops and inefficient coding practices… And of course be dangerous!</p>
<div id="final-projects" class="section level3">
<h3>Final Projects</h3>
<p>If you haven’t already, please list your final project information (project title, group members etc.) on our <a href="https://docs.google.com/spreadsheets/d/1xdDvmcT35Ih5gReknhb7lqjMRJO7CyJb4vsRWIb24cw/edit?usp=sharing">shared Google sheets document</a></p>
</div>
<div id="simulating-data-in-r" class="section level3">
<h3>Simulating Data in R</h3>
<p>First, review the basic approach to simulating data in the <a href="https://kevintshoemaker.github.io/NRES-746/LECTURE3.html">“Virtual Ecologist” lecture</a>. Recall that a data simulation model can be constructed as a <em>deterministic component</em> (defining underlying relationships between the process of interest and a set of covariates), with a <em>stochastic component</em> wrapped around it (defining the “noise”, or “error” associated with each observation from the process of interest).</p>
</div>
<div id="challenge-1-model-verification-part-1" class="section level3">
<h3>CHALLENGE 1: model verification, part 1</h3>
<p>Simulate data that meet the standard assumptions of univariate linear regression (homoskedasticity, independence, normal/Gaussian errors). Then run the “lm()” function on your simulated data and examine how closely the parameter estimates match the “true” parameter value.</p>
<ul>
<li><p><strong>Exercise 1a</strong>. Write a function called “LMDataSim()” for drawing a set of random observations from a defined linear relationship (that meets all the assumptions of ordinary linear regression). This function should be specified as follows:</p>
<ul>
<li><strong>input</strong>:
<ul>
<li>sample.size = a scalar (integer) specifying the number of observations to simulate</li>
<li>xlimits = a vector of length 2 specifying the minimum and maximum values of the covariate “x”<br />
</li>
<li>coefs = a vector of length 2 specifying (in order) the intercept and slope of the relationship between “x” and the expected response<br />
</li>
<li>stdev = a scalar specifying the standard deviation of the residual errors.</li>
</ul></li>
<li><strong>suggested algorithm</strong>:
<ul>
<li>sample random values (size=“sample.size”) from a uniform distribution (min and max defined by “xlimits”) to represent the covariate (use the “runif()” function)<br />
</li>
<li>Use the defined linear model (defined by “coefs”) to determine the expected value of the response.</li>
<li>Add “noise” to the expected values according to the “stdev” parameter (use the “rnorm()” function)</li>
</ul></li>
<li><strong>return</strong>:
<ul>
<li>out = a data frame with number of rows equal to “sample.size”, and two columns. The first column should represent the values of the “x” variable and the second column should represent stochastic observations from the <em>known</em> model defined by “coefs” and “stdev”</li>
</ul></li>
</ul></li>
</ul>
<p>Test your function- for example, using the following code:</p>
<pre class="r"><code>LMDataSim(sample.size=10,xlimits=c(40,120),coefs=c(55,-0.09),stdev=6.8)</code></pre>
<pre><code>##            x        y
## 1  108.18806 53.95422
## 2  114.88387 63.76866
## 3  116.09147 43.77021
## 4   67.72842 45.58058
## 5   64.06991 60.89321
## 6   64.81088 46.27697
## 7  106.69963 33.54274
## 8   82.36297 48.69944
## 9  116.77323 31.11868
## 10  55.22169 48.04038</code></pre>
<ul>
<li><p><strong>Exercise 1b</strong>. Write a function called “LMVerify_pt1()” for computing how well the coefficients and variance from R’s “lm()” function match the known coefficients of the model used to generate the data. This function should be specified as follows:</p>
<ul>
<li><strong>input</strong>:
<ul>
<li>sim.dataset = a data frame representing data simulated from a linear model with known coefficients (and known residual variance). The first column should represent the values of the “x” variable and the second column should represent stochastic observations from the <em>known</em> model defined by “trueparams”</li>
<li>trueparams = a vector of length 3 specifying the intercept, slope, and standard deviation of the residual errors of the known relationship between “x” and the response</li>
</ul></li>
<li><strong>suggested algorithm</strong>:
<ul>
<li>Use the “lm()” function to estimate the coefficients and residual standard deviation of the relationships between column 1 and column 2 of “sim.dataset” (regress column 2 on column 1)<br />
</li>
<li>Extract and store the regression coefficients (intercept and slope parameter)<br />
</li>
<li>Extract an estimate of the residual standard deviation of the regression relationship.</li>
<li>Subtract the known parameter values (intercept, slope, error sd) from the regression parameters.</li>
<li>Plot the estimated regression line with a 95% confidence interval around the estimated regression line (e.g., computed using the “predict()” function). Overlay the “true” linear relationship (from the known data generating model). Add a legend to differentiate the true linear relationship from the estimated regression line.</li>
<li>Use an “ifelse()” statement to record whether or not the 95% confidence interval around the slope parameter estimate (estimated from the data) contains the “true” parameter value (if the 95% confidence interval contains the true value, then TRUE, otherwise FALSE)</li>
</ul></li>
<li><strong>return</strong>:
<ul>
<li>out = a list of length 2 with the following elements:
<ul>
<li>a vector of length 3 representing (in order) the differences between the known parameters (intercept, slope, error sd) and the estimates from a linear regression model</li>
<li>a logical (TRUE/FALSE) representing whether or not the 95% confidence interval around the slope parameter estimate (estimated from the data) contains the “true” parameter value.</li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<p>Test your function- for example, using the following code:</p>
<pre class="r"><code>simdat &lt;- LMDataSim(sample.size=10,xlimits=c(40,120),coefs=c(55,-0.09),stdev=6.8)

LMVerify_pt1(sim.dataset = simdat, trueparams = c(55,-0.09,6.8))</code></pre>
<p><img src="LAB2_files/figure-html/test1b-1.png" width="672" /></p>
<pre><code>## $difs
##          x          y      stdev 
## -9.5642181  0.1372222  0.7283977 
## 
## $inside
## [1] TRUE</code></pre>
<p>Recall that you can use the ‘predict’ function to compute confidence intervals and prediction intervals:</p>
<pre class="r"><code>predict.lm(yourmodel, interval = c(&quot;confidence&quot;), level = 0.95)   # for confidence interval
predict.lm(yourmodel, interval = c(&quot;prediction&quot;), level = 0.95)   # for prediction interval</code></pre>
<p>The predict function allows you to predict a response (and estimate confidence intervals) for any arbitrary covariate values. To do this you need to add a “newdata” argument to the predict function. For example:</p>
<pre class="r"><code>nd &lt;- data.frame(x=seq(lb,ub,1))  # note that the predictor names need to match the predictor names in the model object! 
predict.lm(yourmodel, newdata=nd, interval = c(&quot;confidence&quot;), level = 0.95)   # for confidence interval</code></pre>
<p>Note that the prediction interval code may occasionally return some warnings- which you may ignore!</p>
<ul>
<li><strong>Exercise 1c</strong>. Does the 95% confidence interval around the slope estimate (estimated from simulated data with a sample size of 10) contain the “true” slope parameter value 95% of the time (a frequentist question!). In your Word document, explain how you addressed this question. Did you need more than 100 simulated data sets to answer this question?</li>
</ul>
<div id="aside-review-of-conditional-statements-in-r" class="section level4">
<h4>ASIDE: review of conditional statements in R</h4>
<p>NOTE: The previous challenge problem requires the use of “conditional” statements. That is, if a condition is true, do something. If the condition is false, do something else. The syntax for doing this in R is:</p>
<pre><code>if(TRUE){
  do something
} else{
  do something else
}
</code></pre>
<p>Let’s say I want to determine the number of vector elements that are cleanly divisible by 3. I could write the following code:</p>
<pre class="r"><code>inputvector &lt;- c(1:100) # vector of interest
div_by_three &lt;- 0

for(i in 1:length(inputvector)){
  if(i%%3==0){  # if there is zero remainder after dividing by three
    div_by_three &lt;- div_by_three+1   # then increment the storage variable
  }
}

div_by_three</code></pre>
<pre><code>## [1] 33</code></pre>
<p>An alternative way to do this would be to do use the “which()” function. This tells you which indices in a vector correspond to “TRUE” conditions.</p>
<p>For example,</p>
<pre class="r"><code>which(c(FALSE,TRUE,TRUE,FALSE))</code></pre>
<pre><code>## [1] 2 3</code></pre>
<p>Using “which”, we could re-write the above code to take up just one line!</p>
<pre class="r"><code>div_by_three &lt;- length(which(inputvector%%3==0))</code></pre>
</div>
</div>
<div id="challenge-2-model-verification-part-2" class="section level3">
<h3>CHALLENGE 2: model verification, part 2</h3>
<p>How might your results from part 1 change if your data simulations DID NOT meet the assumptions of ordinary linear regression- e.g., if the variances were not homogeneous?</p>
<p>To test this, you are asked to write an R function to generate data that violates a basic assumption regarding the error distribution of standard linear regression. Specifically, your function should generate “heteroskedastic” data, such that the variance of the residuals depends on the magnitude of the covariate “x”. For this exercise, you’ll still need to specify a linear relationship (y=ax+b) between your response and predictor - the only difference is that the residual variance is no longer homogeneous.</p>
<p>Some other potential violations of standard assumtions we could also introduce into our data simulations if we wanted:</p>
<ul>
<li>use a non-normal error distribution<br />
</li>
<li>introduce temporal autocorrelation<br />
</li>
<li>introduce other types of correlation structure among the observations<br />
</li>
<li><p>use a mixture of two error distributions</p></li>
<li><p><strong>Exercise 2a</strong>. Pick one of the violations in the above list. In your Word document, please explain how biological or sampling processes could yield data that violate standard regression assumptions in this specified way. Be as brief as possible in your response!</p></li>
<li><p><strong>Exercise 2b</strong>. Write a function called “LMDataSim2()” for drawing a set of random observations from a defined linear relationship (that meets all the assumptions of ordinary linear regression <em>except for homoskedasticity</em>). This function should be specified as follows:</p>
<ul>
<li><strong>input</strong>:
<ul>
<li>sample.size = a scalar (integer) specifying the number of observations to simulate</li>
<li>xlimits = a vector of length 2 specifying the minimum and maximum values of the covariate “x”<br />
</li>
<li>coefs = a vector of length 2 specifying (in order) the intercept and slope of the relationship between “x” and the expected response -</li>
<li>sd_coefs = a vector of length 2 specifying (in order) coefficients for a “heteroskedasticity” model specifies standard deviation as a linear function of the covariate “x”</li>
</ul></li>
<li><strong>suggested algorithm</strong>:
<ul>
<li>sample random values (size=“sample.size”) from a uniform distribution (min and max defined by “xlimits”) to represent the covariate (use the “runif()” function)<br />
</li>
<li>Use the defined linear model (defined by “coefs”) to determine the expected value of the response.</li>
<li>Use the defined linear model (defined by “sd_coefs”) to determine the expected value of the standard deviation of the response.</li>
<li>Add “noise” to the expected values according to the “stdev” parameter (use the “rnorm()” function). Note that this should now depend on the covariate “x”.</li>
</ul></li>
<li><strong>return</strong>:
<ul>
<li>out = a data frame with number of rows equal to “sample.size”, and two columns. The first column should represent the values of the “x” variable and the second column should represent stochastic observations from the <em>known</em> model defined by “coefs” and “stdev”</li>
</ul></li>
</ul></li>
</ul>
<p>NOTE: make sure that your linear model for stdev does not go negative - this will return “NaN” values (not a number!).</p>
<p>Test your function- for example, using the following code:</p>
<pre class="r"><code>test &lt;- LMDataSim2(sample.size=35,xlimits=c(40,120),coefs=c(55,-0.09),sd_coefs=c(-0.2,0.04))
plot(test$x,test$y)</code></pre>
<p><img src="LAB2_files/figure-html/test2b-1.png" width="672" /></p>
<ul>
<li><p><strong>Exercise 2c</strong>. Write a function called “LMVerify_pt2()” for computing how well the coefficients from R’s “lm()” function match the known coefficients of the model used to generate the data. This function should be specified as follows:</p>
<ul>
<li><strong>input</strong>:
<ul>
<li>sim.dataset = a data frame representing data simulated from a linear model with known coefficients (and known residual variance, with variance dependent on the covariate “x”). The first column should represent the values of the “x” variable and the second column should represent stochastic observations from the <em>known</em> model defined by “trueparams”</li>
<li>trueparams = a vector of length 2 specifying the intercept and slope of the known relationship between “x” and the response</li>
</ul></li>
<li><strong>suggested algorithm</strong>:
<ul>
<li>Use the “lm()” function to estimate the coefficients of the relationships between column 1 and column 2 of “sim.dataset” (regress column 2 on column 1)<br />
</li>
<li>Extract and store the regression coefficients (intercept and slope parameter)<br />
</li>
<li>Subtract the known parameter values (intercept, slope) from the regression parameters.</li>
<li>Plot the estimated regression line with a <em>95% prediction interval</em> around the estimated regression line (e.g., computed using the “predict()” function). Overlay the “observations” from the known data generating model.</li>
<li>Use an “ifelse()” statement to record whether or not the 95% confidence interval around the slope parameter estimate (estimated from the data) contains the “true” parameter value (if the 95% confidence interval contains the true value, then TRUE, otherwise FALSE)</li>
</ul></li>
<li><strong>return</strong>:
<ul>
<li>out = a list of length 2 with the following elements:
<ul>
<li>a vector of length 2 representing (in order) the differences between the known parameters (intercept, slope) and the estimates from a linear regression model</li>
<li>a logical (TRUE/FALSE) representing whether or not the 95% confidence interval around the slope parameter estimate (estimated from the data) contains the “true” parameter value.</li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<p>Test your function- for example, using the following code:</p>
<pre class="r"><code>simdat &lt;- LMDataSim2(sample.size=35,xlimits=c(40,120),coefs=c(55,-0.09),sd_coefs=c(-0.3,0.05))
LMVerify_pt2(sim.dataset = simdat, trueparams = c(55,-0.09))</code></pre>
<p><img src="LAB2_files/figure-html/test2c-1.png" width="672" /></p>
<pre><code>## $difs
##   intercept           x 
## -0.78738341  0.01261232 
## 
## $inside
## [1] TRUE</code></pre>
<ul>
<li><strong>Exercise 2d</strong>. In your Word document, please answer the following questions:</li>
</ul>
<ol style="list-style-type: decimal">
<li>Is the estimate of the slope parameter (obtained using the ‘lm()’ function) <em>biased</em>? [note: statistical bias of an estimator is the difference between the estimator’s expected value and the true value of the parameter being estimated]. Ideally, an estimator should be <em>unbiased</em> (bias=0). Briefly explain how you got your answer.</li>
</ol>
<p><img src="LAB2_files/figure-html/answer2d1-1.png" width="672" /></p>
<pre><code>## [1] 0.0001674544</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Evaluate <em>goodness-of-fit</em> by visualizing the “cloud” of (fake) data produced by the true model against the prediction interval from the estimated model (generated using the ‘lm()’ function). In your Word document, please include this figure and describe very briefly how this figure helps you to evaluate goodness-of-fit (the degree to which your data could plausibly have been generated by the fitted model)</li>
</ol>
<p><img src="LAB2_files/figure-html/answer2d2-1.png" width="672" /></p>
</div>
<div id="challenge-3-power-analysis" class="section level3">
<h3>CHALLENGE 3: Power analysis!</h3>
<p>Review the “power analysis” section of the <a href="LECTURE3.html">Virtual Ecologist lecture</a>, and complete the following challenge problems. Recall that we are designing a monitoring program for a population of an at-risk species, and we want to have <em>at least a 75% chance of detecting a decline of 25% or more over a 10 year period</em>. Let’s assume that we are using visual counts, and that the probability of encountering each organism visually is 2% per person-day. The most recent population estimate was 1000.</p>
<ul>
<li><strong>Exercise 3a</strong>. Develop a function called “GetPower()” that evaluates the statistical power to detect a decline under user-specified types of monitoring designs (e.g., varying numbers of observers, intervals between successive surveys). This function should be specified as follows:
<ul>
<li><strong>input</strong>:
<ul>
<li>initabund: true initial population abundance (default=1000)</li>
<li>nreps: number of replicated long-term monitoring data sets to generate in order to evaluate power<br />
</li>
<li>trend: proportional change in population size each year<br />
</li>
<li>years: duration of simulation (in years)</li>
<li>days: survey duration, in days</li>
<li>observers: number of survey participants each day of each survey year<br />
</li>
<li>survint: survey interval, in years (e.g., 2 means surveys are conducted every other year, 3 means surveys are conducted every 3 years)</li>
<li>alpha: acceptable type-I error rate below which we are confident to make the call that a population is declining.</li>
</ul></li>
<li><strong>suggested algorithm</strong>:
<ul>
<li>Up to you!!! You can make use of the functions in the “Virtual Ecologist” lecture.</li>
</ul></li>
<li><strong>return</strong>:
<ul>
<li>A single floating point (real number) value representing the statistical power to detect a decline under the specified default parameters and alpha level. This represents the percent of replicate data sets for which you correctly reject the null hypothesis of “no decline”.</li>
</ul></li>
</ul></li>
</ul>
<p>And we can test our new function using a command like this:</p>
<pre class="r"><code>GetPower(survint=3)         # test the new function</code></pre>
<pre><code>## The statistical power to detect a decline for the default parameters is: 0.902</code></pre>
<pre><code>## [1] 0.902</code></pre>
<ul>
<li><strong>Exercise 3b</strong>. For each variable element of the survey design (survey interval, number of observers, days per survey bout), evaluate how statistical power changes across a range of plausible values. Plot out these relationships. In your Word document, provide ONE of these plots, describe (briefly!) how you produced the plot, and how you might use this plot to make a specific recommendation about survey protocols for this species.</li>
</ul>
<p><img src="LAB2_files/figure-html/answer3b-1.png" width="672" /><img src="LAB2_files/figure-html/answer3b-2.png" width="672" /><img src="LAB2_files/figure-html/answer3b-3.png" width="672" /></p>
<ul>
<li><strong>Exercise 3c</strong>. Let’s factor in dollar amounts. Let’s assume each observer is paid $200 per day. In addition, let’s assume that the site is fairly remote and it costs $2000 to mount a field expedition (regardless of the number of field technicians). Can you identify a survey strategy to minimize cost while meeting the objective??? What is the optimal survey design in your opinion? Briefly describe how you arrived at this conclusion. [NOTE: don’t overthink this one- you don’t need to find the true optimal solution, just find a solution that meets the objective at relatively low cost and justify your answer!]</li>
</ul>
<pre><code>##   observers days survint
## 4         4    1       4</code></pre>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
