<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="NRES 746" />


<title>Lab Exercise 2</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<link rel="stylesheet"
      href="site_libs/highlight/default.css"
      type="text/css" />
<script src="site_libs/highlight/highlight.js"></script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.9em;
  padding-left: 5px;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">NRES 746</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Schedule
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="schedule.html">Course Schedule</a>
    </li>
    <li>
      <a href="labschedule.html">Lab Schedule</a>
    </li>
    <li>
      <a href="Syllabus.pdf">Syllabus</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="INTRO.html">Introduction to NRES 746</a>
    </li>
    <li>
      <a href="LECTURE1.html">Why focus on algorithms?</a>
    </li>
    <li>
      <a href="LECTURE2.html">Working with probabilities</a>
    </li>
    <li>
      <a href="LECTURE3.html">The Virtual Ecologist</a>
    </li>
    <li>
      <a href="LECTURE4.html">Likelihood</a>
    </li>
    <li>
      <a href="LECTURE5.html">Optimization</a>
    </li>
    <li>
      <a href="LECTURE6.html">Bayesian #1: concepts</a>
    </li>
    <li>
      <a href="LECTURE7.html">Bayesian #2: mcmc</a>
    </li>
    <li>
      <a href="LECTURE8.html">Model Selection</a>
    </li>
    <li>
      <a href="LECTURE9.html">Model Performance Evaluation</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Lab exercises
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="LAB1.html">Lab 1: Algorithms in R</a>
    </li>
    <li>
      <a href="LAB2.html">Lab 2: Virtual ecologist</a>
    </li>
    <li>
      <a href="LAB3.html">Lab 3: Likelihood and optimization</a>
    </li>
    <li>
      <a href="LAB4.html">Lab 4: Bayesian inference</a>
    </li>
    <li>
      <a href="LAB5.html">Lab 5: Model selection</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Data sets
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="TreeData.csv">Tree Data</a>
    </li>
    <li>
      <a href="ReedfrogPred.csv">Reed Frog Predation Data</a>
    </li>
    <li>
      <a href="ReedfrogFuncresp.csv">Reed Frog Func Resp</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Student-led topics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="forWebsite_SEM.html">SEMs</a>
    </li>
    <li>
      <a href="SEM_Minilab_v2.html">SEM mini-lab</a>
    </li>
    <li>
      <a href="GAMs.html">GAMs</a>
    </li>
    <li>
      <a href="RMarkdown_FigureDemo.html">Publication-quality figures in R</a>
    </li>
    <li>
      <a href="Bayesian Networks.pptx">Bayesian Networks</a>
    </li>
    <li>
      <a href="Bayes_Network_Markdown_Final.html">Bayesian Networks mini-lab</a>
    </li>
    <li>
      <a href="GraphTheory.html">Graph Theory</a>
    </li>
    <li>
      <a href="NRES746_IPMs.pptx">Integrated Population Models</a>
    </li>
    <li>
      <a href="TimeSeries_heckler.html">Time Series Analysis</a>
    </li>
    <li>
      <a href="Time_Series_Lab.html">Time-series mini-lab</a>
    </li>
    <li>
      <a href="Spatial_Autocorrelation.html">Spatial Autocorrelation</a>
    </li>
    <li>
      <a href="SA_miniLab.html">Spatial Autocorrelation mini-lab</a>
    </li>
    <li>
      <a href="SDM_pres.html">Species Distribution Modeling</a>
    </li>
    <li>
      <a href="IPM_miniLab.html">IPM mini-lab</a>
    </li>
    <li>
      <a href="Final_MiniLabScript.html">RSF mini-lab</a>
    </li>
    <li>
      <a href="MixedModelMinilab.html">Mixed-effects model mini-lab</a>
    </li>
    <li>
      <a href="Minilab_Ordination.html">Ordination mini-lab</a>
    </li>
  </ul>
</li>
<li>
  <a href="Links.html">Links</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Lab Exercise 2</h1>
<h4 class="author"><em>NRES 746</em></h4>
<h4 class="date"><em>September 9, 2016</em></h4>

</div>


<div id="final-projects" class="section level2">
<h2>Final Projects</h2>
<p>Take some time to start forming groups (2-3 people) for final projects.</p>
<div id="general-expectations" class="section level3">
<h3>General expectations</h3>
<p>I will provide a more formal list of expectations for final projects soon, but in a nutshell (and in no particular order), you are expected to perform and write up the results for a sophisticated data analysis using <em>state-of-the-art analytical methods</em>. The write-up will loosely take the format of a scientific paper to be submitted to a professional journal. However, because of the nature of this course, the most important pieces of the write-up are the methods and results sections. Nonetheless, I expect at least a few paragraphs introducing the topic and why it’s important, and a few paragraphs discussing the implications of the results. The methods and results section can (and in many cases should) be much longer than you typically see in a scientific paper- don’t feel constrained by space for these sections! Not that you need to be wordy, I just want to make sure you have the space to clearly explain the analyses you performed and why you made the choices you did.</p>
</div>
<div id="picking-a-topic" class="section level3">
<h3>Picking a topic</h3>
<p>Your final project should not be part of your thesis. That said, there is no requirement that your final project is not <em>relevant</em> to your graduate thesis project. You will end up spending quite a bit of time on your final projects, so think about what types of analyses you want/need to get to know better- ideally something that may strengthen your thesis project.</p>
</div>
<div id="picking-a-dataset" class="section level3">
<h3>Picking a dataset</h3>
<p>You are not required to use a public dataset, but there are lots of great datasets out there… see <a href="https://kevintshoemaker.github.io/NRES-746/Links.html#Data_links">links page</a></p>
<div id="question-1" class="section level4">
<h4>QUESTION 1</h4>
<p>Develop a 1-page “proposal” that briefly describes your research question, your study system, the data set you will use, and what methods you plan to use to test your research question. Proposals are due to me by <strong>Monday 26 September</strong>. All groups should meet with me briefly to go over project ideas in lab on September 29!</p>
</div>
</div>
</div>
<div id="the-virtual-ecologist" class="section level2">
<h2>The Virtual Ecologist</h2>
<p>Here is the “real” lab exercise for this week! For the assignment, please keep your work as short and sweet as possible! <strong>LAB 2 is due by midnight on Friday 9/30.</strong> Comment each line of your code. Use functions wherever possible. Don’t be afraid of for loops. And of course be dangerous!</p>
<div id="simulating-data-in-r" class="section level3">
<h3>Simulating Data in R</h3>
<p>First, review the basic approach to simulating data in the <a href="https://kevintshoemaker.github.io/NRES-746/LECTURE3.html">“Virtual Ecologist” lecture</a>.</p>
<div id="question-2-part-a-model-verification-and-goodness-of-fit" class="section level4">
<h4>QUESTION 2 part a (model verification and goodness of fit)</h4>
<p>Simulate data that meets all the standard assumptions of univariate linear regression. Then run the “lm” function on these data and examine how closely the parameter estimates match the “true” parameter value. Other choices (sample size, parameter values etc) are up to you!</p>
<ul>
<li><p>Plot the estimated regression line with a 95% confidence interval around the estimated regression line (e.g., computed using the “predict.lm” function). Overlay the “true” regression line (from the known data generating model). Does the “true” regression line fall within the estimated confidence interval?</p></li>
<li><p>Plot the estimated regression line with a 95% prediction interval (e.g., computed using the “predict.lm” function). Overlay the “true” 95% prediction interval (e.g., the interval encompassing 95% of the data generated under the true model). Does the estimated 95% prediction interval encompass all or most of the true prediction interval?</p></li>
</ul>
<p>Note that you can use the ‘predict’ function to compute confidence intervals and prediction intervals:</p>
<pre class="r"><code>predict.lm(yourmodel, interval = c(&quot;confidence&quot;), level = 0.95)   # for confidence interval
predict.lm(yourmodel, interval = c(&quot;prediction&quot;), level = 0.95)   # for prediction interval</code></pre>
<p>Note that the prediction interval code above might give warnings- which you may ignore!</p>
<ul>
<li>Extra credit: Does the 95% confidence interval around the parameter estimate (estimated from the data) contain the “true”&quot; parameter value 95% of the time (a frequentist question!). Show this with simulations!</li>
</ul>
</div>
<div id="aside-conditional-statements-in-r" class="section level4">
<h4>aside: conditional statements in R</h4>
<p>NOTE: the extra credit question requires the use of “conditional” statements. That is, if a condition is true, do something. If the condition is false, do something else. The syntax for doing this in R is:</p>
<pre class="r"><code>if(TRUE){
  do something
} else{
  do something else
}</code></pre>
<p>Let’s say I want to determine the number of vector elements that are cleanly divisible by 3. I could write the following code:</p>
<pre class="r"><code>inputvector &lt;- c(1:100) # vector of interest
div_by_three &lt;- 0

for(i in 1:length(inputvector)){
  if(i%%3==0){  # if there is zero remainder after dividing by three
    div_by_three &lt;- div_by_three+1   # then increment the storage variable
  }
}

div_by_three</code></pre>
<pre><code>## [1] 33</code></pre>
<p>An alternative way to do this would be to do use the “which()” function. This tells you which indices in a vector correspond to “TRUE” conditions.</p>
<p>For example,</p>
<pre class="r"><code>which(c(FALSE,TRUE,TRUE,FALSE))</code></pre>
<pre><code>## [1] 2 3</code></pre>
<p>Using “which”, we could re-write the above code to take up just one line!</p>
<pre class="r"><code>div_by_three &lt;- length(which(inputvector%%3==0))</code></pre>
</div>
<div id="question-2-part-b-model-verification-2" class="section level4">
<h4>QUESTION 2 part b (model verification #2)</h4>
<p>Write an R function to generate data that violates <em>one or more</em> of the basic assumptions regarding the error distribution of standard linear regression. Make sure your dataset is realistic! Justify in writing how biological or sampling processes could have produced the data, including (especially) the assumptions violation(s). NOTE: for this exercise, you still need to specify a linear relationship (y=mx+b) between your response and predictor (otherwise some of the questions below wouldn’t make sense!).</p>
<p>Some options:</p>
<ul>
<li>use a non-normal error distribution (simplest option!)</li>
<li>introduce temporal autocorrelation</li>
<li>introduce other types of correlation structure among the observations</li>
<li>use a mixture of two error distributions</li>
<li>others?? (feel free to be creative!)</li>
</ul>
<p>Use classical linear regression to analyze these data.</p>
<p>Answer the following questions (keep verbiage to a minimum, and provide all code- with comments!)</p>
<ol style="list-style-type: decimal">
<li>Is the estimate of the regression parameter (obtained using the ‘lm’ function) <em>biased</em>? [note: statistical bias of an estimator is the difference between the estimator’s expected value and the true value of the parameter being estimated]. Use simulated data to obtain the estimator’s expected value.</li>
<li>Is the estimate of the error variance biased?</li>
<li>Evaluate <em>goodness-of-fit</em> by visualizing (fake) the “cloud” of data produced by the true model against the prediction interval from the estimated model.</li>
<li>Extra credit!: How well does the estimated confidence interval for the regression parameter (estimated with ‘lm’) match the true confidence interval for the regression parameter? (hint: you can use a brute-force method, i.e., a parametric bootstrap, to estimate the true confidence interval!)</li>
</ol>
</div>
<div id="question-3-power-analysis" class="section level4">
<h4>QUESTION 3 (power analysis)</h4>
<p>Review the “power analysis” section of the Virtual Ecologist lecture, and complete the following:</p>
<ol style="list-style-type: decimal">
<li>Develop a function that evaluates the statistical power to detect a decline under user-specified types of monitoring designs (e.g., varying numbers of observers, intervals between successive surveys).</li>
<li>For each variable element of the survey design (survey interval, number of observers, days per survey bout), evaluate how statistical power changes across a range of plausible values. Plot out these relationships.</li>
<li>Imagine the current survey protocol is 1 surveyor for 1 day, with a 5-year interval. Identify whether this survey methodology is sufficient, and if not, which of these variables would you recommend changing to increase the power of the analysis.</li>
<li>Let’s factor in dollar amounts. Let’s assume each observer is paid $200 per day. In addition, let’s assume that the site is fairly remote and it costs $2000 to mount a field expedition (regardless of the number of field technicians). Can you identify a survey design to minimize cost while meeting the objective???</li>
</ol>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
