---
title: "Lab Instructions"
author: "NRES 746"
date: "Fall 2021"
output: 
  html_document: 
    theme: cerulean
    toc: yes
    toc_float: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


This semester we're trying something a little new (and dangerous!)- the labs are built as interactive documents using R-shiny. This is intended to give you instant feedback, because with no TA it can take me a while to give you feedback on your labs! Hopefully this helps your learning experience- please let me know what you think or how you think this can be improved!

## Interactive labs

The interactive labs are available via an *R package* called "NRES746labs". To access the interactive labs, use the following steps:

### Step 1: open R/Rstudio

### Step 1.1: install package 'remotes' (first time only)

To do this, use the "Install" button on the "Packages" tab in Rstudio, or use the following command:

```{r eval=FALSE}

install.packages("remotes")

```

NOTE: you only have to do this once! Once you've installed a package on your machine it will always be there!  

### Step 2: install the "NRES746labs" package from GitHub

Ultimately I may load this package to the CRAN repository, but for now it lives on GitHub (since I'll be updating it a lot!). You can use the following code to install the package from GitHub:

```{r eval=FALSE}

remotes::install_github("kevintshoemaker/NRES746labs")

```

NOTE: this can take a while the first time, and lots of messages will pop up. If you're asked to choose packages to update, I don't think it matters what option you choose.

NOTE: you should re-install the package for every lab (using the 'install_github' function above), since I'll be updating frequently. For example, the package currently only includes lab 1 (and old versions of labs 2-4).

### Step 3: run the lab!

Now you have everything you need to run the lab. Use the following code:

```{r eval=FALSE}

learnr::run_tutorial("lab1","NRES746labs")

```

NOTE: the system doesn't seem to work for Microsoft Edge (at least back in 2019), so make sure your default browser is Chrome or Safari. 

NOTE: the shiny app will "use up" your R session, so if you want to work on your own script at the same time as you're running the app, you'll have to open up a second R session. 


Hope this works! Good luck!


### DEBUGGING

Here are some tips if things don't work right away:

1. Make sure you have the most recent version of R (R v4.1.0) and the most recent version of Rstudio (1.4.1717)  

2. If R throws errors like "can not remove package [...]" then close all R sessions and go into your local package directory and delete the package manually. Then go back to R and reinstall the package. To find your local package directory, enter the following in your R session:

    ```{r eval=F}
      Sys.getenv('R_LIBS_USER')
    ```

This seems to be easier said than done on a Mac!

    
3. If you try to run the tutorial through the base R GUI and not RStudio you may have to do the following:
    * Go into Rstudio and find your 'pandoc' directory:
    ```{r eval=FALSE}
       Sys.getenv('RSTUDIO_PANDOC')
    ```
    * Go back to your base R session and enter the following:
    ```{r eval=FALSE}
       Sys.setenv(RSTUDIO_PANDOC=[...your directory here...])
    ```

4. If you get an error stating that GitHub's API rate limit has been exceeded (GitHub has a rate limit of 60 requests per hour for unauthenticated requests), the easiest solution is to create a GitHub access token (PAT). You can get a PAT by entering 'usethis::browse_github_pat()' in your R console and following the instructions. Then, add your PAT to your .Renviron file by entering 'usethis::edit_r_environ()' in your R console. Finally, in the '.Renviron' file (the one that just opened up in Rstudio), type the following:

```
GITHUB_PAT=[your PAT here]
```

5. If nothing else seems to work, try using one of the lab computers!





