<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Laura Cirillo" />

<meta name="date" content="2018-11-18" />

<title>Bayesian_Networks</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">NRES 746</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Schedule
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="schedule.html">Course Schedule</a>
    </li>
    <li>
      <a href="labschedule.html">Lab Schedule</a>
    </li>
    <li>
      <a href="Syllabus2.pdf">Syllabus</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="INTRO.html">Introduction to NRES 746</a>
    </li>
    <li>
      <a href="LECTURE1.html">Why focus on algorithms?</a>
    </li>
    <li>
      <a href="LECTURE2.html">Working with probabilities</a>
    </li>
    <li>
      <a href="LECTURE3.html">The Virtual Ecologist</a>
    </li>
    <li>
      <a href="LECTURE4.html">Likelihood</a>
    </li>
    <li>
      <a href="LECTURE5.html">Optimization</a>
    </li>
    <li>
      <a href="LECTURE6.html">Bayesian #1: concepts</a>
    </li>
    <li>
      <a href="LECTURE7.html">Bayesian #2: mcmc</a>
    </li>
    <li>
      <a href="LECTURE8.html">Model Selection</a>
    </li>
    <li>
      <a href="LECTURE9.html">Performance Evaluation</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Lab exercises
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="LAB1.html">Lab 1: Algorithms in R</a>
    </li>
    <li>
      <a href="FINALPROJ.html">Final project overview</a>
    </li>
    <li>
      <a href="LAB2.html">Lab 2: Virtual ecologist</a>
    </li>
    <li>
      <a href="LAB3.html">Lab 3: Likelihood</a>
    </li>
    <li>
      <a href="LAB4.html">Lab 4: Bayesian Inference</a>
    </li>
    <li>
      <a href="FigureDemo.html">Demo: Figures in R</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Student-led topics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="TimeSeries.html">Time-series analysis</a>
    </li>
    <li>
      <a href="SEM.html">Structural Equation Models</a>
    </li>
    <li>
      <a href="Spatal_Autocorrelation.html">Spatial Autocorrelation</a>
    </li>
    <li>
      <a href="SpatialAutocorrelation.html">Spatial Autocorrelation2</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Data sets
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="TreeData.csv">Tree Data</a>
    </li>
    <li>
      <a href="ReedfrogPred.csv">Reed Frog Predation Data</a>
    </li>
    <li>
      <a href="ReedfrogFuncresp.csv">Reed Frog Func Resp</a>
    </li>
  </ul>
</li>
<li>
  <a href="Links.html">Links</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Bayesian_Networks</h1>
<h4 class="author"><em>Laura Cirillo</em></h4>
<h4 class="date"><em>11/18/2018</em></h4>

</div>


<pre class="r"><code>#install.packages(&quot;bnlearn&quot;)
library(bnlearn)</code></pre>
<pre><code>## 
## Attaching package: &#39;bnlearn&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     sigma</code></pre>
<div id="r-packages" class="section level2">
<h2>R packages</h2>
<div id="bnlearn" class="section level3">
<h3>bnlearn</h3>
<ul>
<li>A variety of classical approaches (HC and MMHC)</li>
</ul>
</div>
<div id="pcalg" class="section level3">
<h3>pcalg</h3>
<ul>
<li>Causal interpretation (PC and FCI)</li>
</ul>
</div>
<div id="deal" class="section level3">
<h3>deal</h3>
<ul>
<li>Mixed data</li>
</ul>
</div>
<div id="grain" class="section level3">
<h3>gRain</h3>
<ul>
<li>Exact and approximate computations</li>
</ul>
</div>
<div id="lavaan" class="section level3">
<h3>lavaan</h3>
<ul>
<li>Structural equation models</li>
</ul>
</div>
<div id="sparsebn" class="section level3">
<h3>sparsebn</h3>
<ul>
<li>High dimensional data, mixed observational and experimental data</li>
<li>Computational biology and genomics</li>
</ul>
</div>
</div>
<div id="bnlearn-1" class="section level2">
<h2>bnlearn</h2>
<p>This package contains a number of algorithms for Bayesian Network (BN) structure learning, parameter learning and inference. it also contains existing datasets that we can use to build and train a BN and ultimately make an inference</p>
<pre class="r"><code>data(coronary)
head(coronary)</code></pre>
<pre><code>##   Smoking M. Work P. Work Pressure Proteins Family
## 1      no      no      no     &lt;140       &lt;3    neg
## 2      no      no      no     &lt;140       &lt;3    neg
## 3      no      no      no     &lt;140       &lt;3    neg
## 4      no      no      no     &lt;140       &lt;3    neg
## 5      no      no      no     &lt;140       &lt;3    neg
## 6      no      no      no     &lt;140       &lt;3    neg</code></pre>
<p>within the bnlearn package we can use one of the algorithms, “max-min hill climbing”, to create a dependency between all of the variables in our dataframe, and use the plot function to create a simple visualization of the relationships.</p>
<pre class="r"><code>bn_df &lt;- data.frame(coronary)
res &lt;- hc(bn_df)
plot(res)</code></pre>
<p><img src="Bayesian_Networks_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>The causality may not be correct based on the algorithm alone, so in this example we will edit some of the structure manually. Family is not a condition of stenuous mental work so we remove that link</p>
<pre class="r"><code>res$arcs &lt;- res$arcs[-which((res$arcs[,&#39;from&#39;] == &quot;M..Work&quot; &amp; res$arcs[,&#39;to&#39;] == &quot;Family&quot;)),]</code></pre>
<p>now that we have established the structure we can move to training. The bn.fit function runs the expectation maximization algorithm on our data to find out the contitional probalility at each node.</p>
<pre class="r"><code>fittedbn &lt;- bn.fit(res, data = bn_df)
print(fittedbn$Proteins)</code></pre>
<pre><code>## 
##   Parameters of node Proteins (multinomial distribution)
## 
## Conditional probability table:
##  
## , , M..Work = no
## 
##         Smoking
## Proteins        no       yes
##       &lt;3 0.6685824 0.6167763
##       &gt;3 0.3314176 0.3832237
## 
## , , M..Work = yes
## 
##         Smoking
## Proteins        no       yes
##       &lt;3 0.5671982 0.3235294
##       &gt;3 0.4328018 0.6764706</code></pre>
<p>Now we can move to the inference from our trained BN. Each query of any event based on selected evidence provides a probability.</p>
<pre class="r"><code>cpquery(fittedbn, event = (Proteins==&quot;&lt;3&quot;), evidence = ( Smoking==&quot;no&quot;) )</code></pre>
<pre><code>## [1] 0.6219136</code></pre>
<pre class="r"><code>cpquery(fittedbn, event = (Proteins==&quot;&lt;3&quot;), evidence = ( Smoking==&quot;no&quot; &amp; Pressure==&quot;&gt;140&quot; ) )</code></pre>
<pre><code>## [1] 0.6327684</code></pre>
<pre class="r"><code>cpquery(fittedbn, event = (Pressure==&quot;&gt;140&quot;), evidence = ( Proteins==&quot;&lt;3&quot; ) )</code></pre>
<pre><code>## [1] 0.4287676</code></pre>
<p>More advanced visualizations can also be done in bnlearn but we are going to follow a couple of examples of some more complex data in the sparsebn package to keep it interesting</p>
<pre class="r"><code>#install.packages(&quot;sparsebn&quot;)
library(sparsebn)</code></pre>
<pre><code>## Loading required package: sparsebnUtils</code></pre>
<pre><code>## 
## Attaching package: &#39;sparsebnUtils&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:bnlearn&#39;:
## 
##     random.graph</code></pre>
<pre><code>## Loading required package: ccdrAlgorithm</code></pre>
<pre><code>## Loading required package: discretecdAlgorithm</code></pre>
<pre><code>## 
## sparsebn v0.0.5, Copyright (c) 2016-2017
##  Bryon Aragam, University of California, Los Angeles
##  Jiaying Gu, University of California, Los Angeles
##  Dacheng Zhang, University of California, Los Angeles
##  Qing Zhou, University of California, Los Angeles
##  Fei Fu
## 
## Please cite our work! Type citation(&quot;sparsebn&quot;) for details.
## ---&gt; Bugs? Please report any bugs at https://github.com/itsrainingdata/sparsebn/issues.</code></pre>
<pre class="r"><code># source(&quot;http://bioconductor.org/biocLite.R&quot;)
# biocLite(&quot;Rgraphviz&quot;)   
library(&quot;Rgraphviz&quot;)</code></pre>
<pre><code>## Loading required package: graph</code></pre>
<pre><code>## Warning: package &#39;graph&#39; was built under R version 3.5.1</code></pre>
<pre><code>## Loading required package: BiocGenerics</code></pre>
<pre><code>## Loading required package: parallel</code></pre>
<pre><code>## 
## Attaching package: &#39;BiocGenerics&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:parallel&#39;:
## 
##     clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,
##     clusterExport, clusterMap, parApply, parCapply, parLapply,
##     parLapplyLB, parRapply, parSapply, parSapplyLB</code></pre>
<pre><code>## The following objects are masked from &#39;package:bnlearn&#39;:
## 
##     path, score</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     IQR, mad, sd, var, xtabs</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     anyDuplicated, append, as.data.frame, basename, cbind,
##     colMeans, colnames, colSums, dirname, do.call, duplicated,
##     eval, evalq, Filter, Find, get, grep, grepl, intersect,
##     is.unsorted, lapply, lengths, Map, mapply, match, mget, order,
##     paste, pmax, pmax.int, pmin, pmin.int, Position, rank, rbind,
##     Reduce, rowMeans, rownames, rowSums, sapply, setdiff, sort,
##     table, tapply, union, unique, unsplit, which, which.max,
##     which.min</code></pre>
<pre><code>## 
## Attaching package: &#39;graph&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:bnlearn&#39;:
## 
##     degree, nodes, nodes&lt;-</code></pre>
<pre><code>## Loading required package: grid</code></pre>
<p>The Rgraphviz package is a more flexible visualitaion tool that the simple versions like graphviz.plot()</p>
<pre class="r"><code>setPlotPackage(&quot;graph&quot;)   
plot(cytometryContinuous$dag)</code></pre>
<p><img src="Bayesian_Networks_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>You have complete control over your visualization in the igraph package. Here we plot a cleaner version of the same data as the previous visual of the continuous data.</p>
<pre class="r"><code>setPlotPackage(&quot;igraph&quot;)
plot(cytometryContinuous$dag,
layout = igraph::layout_(to_igraph(cytometryContinuous$dag),
                         igraph::in_circle()),
vertex.label = names(cytometryContinuous$dag),
vertex.size = 30,
vertex.label.color = gray(0),
vertex.color = colors(),
edge.color = &quot;red&quot;,
edge.arrow.size = 0.3)</code></pre>
<p><img src="Bayesian_Networks_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="outside-of-r" class="section level2">
<h2>outside of R</h2>
<div id="beandisco-bayesian-exact-and-approximate-network-discovery" class="section level3">
<h3>BEANdisco (Bayesian Exact and Approximate Network Discovery)</h3>
<ul>
<li>Multiple scoring options (i.e. parameter priors): BDeu, K2, LL, MDL, AIC</li>
<li>Sampling methods: MCMC, MC3, AIS</li>
</ul>
</div>
<div id="amidst" class="section level3">
<h3>AMIDST</h3>
<ul>
<li>“A Java Toolbox for Analytics of Massive Data Streams using Probabilistic Graphical Models”</li>
</ul>
</div>
<div id="gobnilp-globally-optimal-bayesian-network-learning-using-integer-linear-programming" class="section level3">
<h3>GOBNILP (Globally Optimal Bayesian Network learning using Integer Linear Programming)</h3>
<ul>
<li>C program using SCIP framework for Constant Integer Programming</li>
</ul>
</div>
</div>
<div id="references" class="section level2">
<h2>references</h2>
<p>Scutari, Marco. 2013. “Learning Bayesian Networks in R:an Example in Systems Biology”.</p>
<p>Tsamardinos, Ioannis, Laura E. Brown, and Constantin F. Aliferis. “The max-min hill-climbing Bayesian network structure learning algorithm.” Machine learning 65.1 (2006): 31-78.</p>
<p>Aragam, Bryon, Jiaying Gu, and Qing Zhou. 2018. “Learning Large-Scale Bayesian Networks with the sparsebn Package”.</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
